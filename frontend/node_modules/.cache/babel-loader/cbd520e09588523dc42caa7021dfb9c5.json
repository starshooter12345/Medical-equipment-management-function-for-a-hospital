{"ast":null,"code":"import React, { useContext, useRef, useState, useEffect, useLayoutEffect, useMemo, Component } from 'react';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = o[Symbol.iterator]();\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar debug = createCommonjsModule(function (module) {\n  /**\n   * \n   * I stole most of this code from the debug lib\n   * https://github.com/visionmedia/debug\n   * \n   * Just wanted it to be easy to debug without relying on the dependency!\n   */\n\n  /**\n  \t* Selects a color for a debug namespace\n    * @param {String} namespace The namespace string for the for the debug instance to be colored\n    * @param {String} colors color pallette to choose from\n  \t* @return {Number|String} An ANSI color code for the given namespace\n  \t* @api private\n  \t*/\n  function selectColor(namespace, colors) {\n    var hash = 0;\n\n    for (var i = 0; i < namespace.length; i++) {\n      hash = (hash << 5) - hash + namespace.charCodeAt(i);\n      hash |= 0; // Convert to 32bit integer\n    }\n\n    return colors[Math.abs(hash) % colors.length];\n  }\n  /**\n   * Adds ANSI color escape codes if enabled.\n   *\n   * @api public\n   */\n\n\n  function formatNodeArgs(args, config) {\n    var name = config.namespace;\n\n    if (config.useColors) {\n      var c = config.color;\n      var colorCode = \"\\x1B[3\" + (c < 8 ? c : '8;5;' + c);\n      var prefix = \"  \".concat(colorCode, \";1m\").concat(name, \" \\x1B[0m\");\n      args[0] = prefix + args[0].split('\\n').join('\\n' + prefix);\n    } else {\n      args[0] = name + ' ' + args[0];\n    }\n  }\n  /**\n   * Colorize log arguments if enabled.\n   *\n   */\n\n\n  function formatBrowserArgs(args, config) {\n    args[0] = (config.useColors ? '%c' : '') + config.namespace;\n\n    if (!config.useColors) {\n      return;\n    }\n\n    var c = 'color: ' + config.color; // The final \"%c\" is somewhat tricky, because there could be other\n    // arguments passed either before or after the %c, so we need to\n    // figure out the correct index to insert the CSS into\n\n    var index = 0;\n    var lastC = 0;\n    args[0].replace(/%[a-zA-Z%]/g, function (match) {\n      if (match === '%%') {\n        return;\n      }\n\n      index++;\n\n      if (match === '%c') {\n        // We only are interested in the *last* %c\n        // (the user may have provided their own)\n        lastC = index;\n      }\n    });\n    args.splice(lastC, 0, c);\n  }\n\n  var browserColors = ['#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC', '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF', '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC', '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF', '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC', '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033', '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366', '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933', '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC', '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF', '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'];\n  /**\n   * Load `namespaces`.\n   *\n   * @return {String} returns the debug modes\n   * @api private\n   */\n\n  function loadBrowser() {\n    var namespaces;\n\n    try {\n      namespaces = localStorage.getItem('debug');\n    } catch (error) {// Swallow\n      // XXX (@Qix-) should we be logging these?\n    } // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\n\n    if (!namespaces && typeof process !== 'undefined' && 'env' in process) {\n      namespaces = process.env.DEBUG;\n    }\n\n    return {\n      namespaces: namespaces || '',\n      colors: browserColors,\n      useColors: true,\n      formatArgs: formatBrowserArgs\n    };\n  }\n  /**\n   * Load `namespaces`.\n   *\n   * @return {String} returns the debug modes\n   * @api private\n   */\n\n\n  function loadNode() {\n    return {\n      namespaces: process.env.DEBUG || '',\n      colors: [6, 2, 3, 4, 5, 1],\n      useColors: true,\n      formatArgs: formatNodeArgs\n    };\n  }\n\n  function createLogger() {\n    var prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var config = arguments.length > 1 ? arguments[1] : undefined;\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      if (prefix) {\n        args.unshift(prefix);\n      } // Create a namespace regex for each namespace\n\n\n      var matches = config.namespaces.split(',').map(function (namespace) {\n        // Remove wildcard and add to regex if wildcard\n        if (namespace[namespace.length - 1] === '*') {\n          return new RegExp('^' + namespace.slice(0, namespace.length - 1) + '.*' + '$');\n        }\n\n        return new RegExp('^' + namespace + '$');\n      }); // Does the prefix match a namespace\n\n      var match = matches.some(function (regex) {\n        return regex.test(prefix);\n      });\n      var conf = {\n        color: selectColor(prefix, config.colors),\n        namespace: prefix,\n        useColors: config.useColors\n      };\n\n      if (process.env.NODE_ENV !== 'production' && match) {\n        var _console;\n\n        config.formatArgs(args, conf);\n\n        (_console = console).log.apply(_console, args);\n      }\n    };\n  }\n\n  function nodeLogger(prefix) {\n    return createLogger(prefix, loadNode());\n  }\n\n  function browserLogger(prefix) {\n    return createLogger(prefix, loadBrowser());\n  }\n  /**\n   * Detect Electron renderer / nwjs process, which is node, but we should\n   * treat as a browser.\n   */\n\n\n  if (typeof process === 'undefined' || process.type === 'renderer' || process.browser === true || process.__nwjs) {\n    module.exports = browserLogger;\n  } else {\n    module.exports = nodeLogger;\n  }\n});\nvar debug$1 = debug('informed:ObjMap' + '\\t');\n/* -------------------- toPath -------------------- */\n\nvar ldtoPath = function ldtoPath() {\n  var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean);\n};\n/* --------------------- get --------------------- */\n\n\nvar ldget = function ldget(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var defaultValue = arguments.length > 2 ? arguments[2] : undefined;\n  var result = String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key) {\n    return res !== null && res !== undefined ? res[key] : res;\n  }, obj);\n  return result === undefined || result === obj ? defaultValue : result;\n};\n/* --------------------- has --------------------- */\n// foo -->\n// foo.bar --> foo\n// foo.bar[3] --> foo.bar\n// foo.bar.baz[2].raz.taz[5].laz --> foo.bar.baz[2].raz.taz[5]\n\n\nvar parentPath = function parentPath(path) {\n  return \".\".concat(path).replace(/(.*)[.[].*/, '$1').replace(/\\./, '');\n}; // foo --> foo\n// foo.bar --> bar\n// foo.bar[3] --> [3]\n// foo.bar.baz[2].raz.taz[5].laz --> laz\n\n\nvar pathKey = function pathKey(path) {\n  return path.replace(parentPath(path), '').replace(/\\./, '');\n};\n\nvar ldhas = function ldhas(obj, path) {\n  var pPath = parentPath(path);\n  var key = pathKey(path); // If we have parent path then get the object at that location\n  // .. otherwise its the root object\n\n  var parentObj = pPath ? ldget(obj, pPath) : obj; // If its [3] turn key into 3\n\n  return !!(parentObj && Object.hasOwnProperty.call(parentObj, key.replace(/\\[(.*)\\]/, '$1')));\n};\n/* --------------------- set --------------------- */\n\n\nvar ldset = function ldset(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var val = arguments.length > 2 ? arguments[2] : undefined;\n  String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key, i, arr) {\n    //console.log('RES', res, 'Key', key, 'I', i, 'Arr', arr, 'OBJ', obj);\n    // At the leaf set the value\n    if (i === arr.length - 1) {\n      res[key] = val;\n      return res[key];\n    } // Initialize to new array or object if needed\n\n\n    if (res[key] === undefined) {\n      if (Number.isInteger(+arr[i + 1])) {\n        res[key] = [];\n      } else {\n        res[key] = {};\n      }\n\n      return res[key];\n    } // Exception for if the value is changeing to an array\n\n\n    if (Number.isInteger(+arr[i + 1]) && !Array.isArray(res[key])) {\n      res[key] = [];\n    } //TODO exception for if object ??\n    // Otherwise keep whats there\n\n\n    return res[key];\n  }, obj);\n};\n/* --------------------- unset --------------------- */\n\n\nvar ldunset = function ldunset(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var found = false;\n  String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key, i, arr) {\n    // Base case res is undefined\n    if (res === undefined) {\n      return res;\n    } // At the leaf delete the value\n\n\n    if (i === arr.length - 1) {\n      delete res[key];\n      found = true;\n      return res[key];\n    } // Otherwise keep going\n\n\n    return res[key];\n  }, obj);\n  return found;\n};\n/* --------------------- pullAt --------------------- */\n\n\nvar ldpullAt = function ldpullAt(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var pulled;\n  String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key, i, arr) {\n    // Base case res is undefined\n    if (res === undefined) {\n      return res;\n    } // At the leaf delete the value\n\n\n    if (i === arr.length - 1 && Array.isArray(res)) {\n      // Pull out one value at index ( key )\n      pulled = res.splice(key, 1);\n      return res[key];\n    } // Otherwise keep going\n\n\n    return res[key];\n  }, obj);\n  return pulled;\n};\n/* --------------------- values --------------------- */\n\n\nvar ldvalues = function ldvalues() {\n  var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = Object.keys(obj);\n  return props.map(function (key) {\n    return obj[key];\n  });\n};\n\nvar pathToArrayElem = function pathToArrayElem(path) {\n  var pathArray = ldtoPath(path);\n  return Number.isInteger(+pathArray[pathArray.length - 1]);\n};\n\nvar ObjectMap = /*#__PURE__*/function () {\n  function ObjectMap() {\n    _classCallCheck(this, ObjectMap);\n  }\n\n  _createClass(ObjectMap, null, [{\n    key: \"empty\",\n    value: function empty(object) {\n      return ldvalues(object).length === 0;\n    }\n  }, {\n    key: \"get\",\n    value: function get(object, path) {\n      var val = ldget(object, path); //debug('GOT', path, val);\n\n      return val;\n    }\n  }, {\n    key: \"has\",\n    value: function has(object, path) {\n      return ldhas(object, path);\n    }\n  }, {\n    key: \"set\",\n    value: function set(object, path, value) {\n      if (value !== undefined) {\n        debug$1('SETTING', path, value);\n        ldset(object, path, value);\n      } else {\n        // Setting things to undefined in informed is special!\n        // so in this else statement we deal with that\n        // If the path is to an array leaf then we want to set to undefined\n        // Example:\n        // path = 'foo.bar[2]'\n        // foo.bar = [ 'baz', 'raz', 'taz' ]\n        // setting taz to undefined   ^^^\n        if (pathToArrayElem(path) && ObjectMap.get(object, path) !== undefined) {\n          debug$1('Special case SETTING', path, 'to undefined');\n          ldset(object, path, undefined);\n          var pathArray = ldtoPath(path);\n          pathArray = pathArray.slice(0, pathArray.length - 1);\n          cleanup(object, pathArray);\n        } // Only delete the field if it needs to be deleted and its not a path to an array ( array leaf )\n        // Example:\n        // path = 'foo.bar'\n        // foo.bar = 'baz'\n        // removing foo.bar from the object completley\n        else if (!pathToArrayElem(path) && ObjectMap.get(object, path) !== undefined) {\n            debug$1('Special case REMOVING', path, 'from object completley');\n            ObjectMap[\"delete\"](object, path);\n          }\n      }\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(object, path) {\n      debug$1('DELETE', path); // Special case for arrays\n\n      if (pathToArrayElem(path)) {\n        debug$1('ARRAY', path); //ldunset(object, path);\n\n        this.pullOut(object, path);\n      } else {\n        ldunset(object, path);\n      }\n\n      var pathArray = ldtoPath(path);\n      pathArray = pathArray.slice(0, pathArray.length - 1);\n      cleanup(object, pathArray);\n    } // Very important ;)\n\n  }, {\n    key: \"pullOut\",\n    value: function pullOut(object, path) {\n      // Get the path to the array\n      var pathArray = ldtoPath(path); // debug('PathArray1', pathArray);\n\n      var index = pathArray[pathArray.length - 1];\n      pathArray = pathArray.slice(0, pathArray.length - 1);\n      debug$1('Pulling out:', pathArray, 'index', index); // Get the array\n\n      var arr = ldget(object, pathArray);\n      debug$1('Array', arr); // Pull out of array\n\n      if (Array.isArray(arr)) {\n        ldpullAt(arr, index);\n      }\n\n      cleanup(object, pathArray);\n    }\n  }]);\n\n  return ObjectMap;\n}();\n\nfunction cleanup(obj, path) {\n  // Base case no path left\n  if (path.length === 0) {\n    return;\n  }\n\n  var object = ldget(obj, path); // Clean up undefined from array\n  // if (Array.isArray(object) && pull) {\n  //   ldpull(object, undefined);\n  // }\n  // Delete object if its empty\n\n  if (Array.isArray(object) ? object.every(function (e) {\n    return e == null;\n  }) : JSON.stringify(object) === '{}') {\n    ldunset(obj, path);\n  } // Recur\n\n\n  cleanup(obj, path.slice(0, path.length - 1));\n}\n\nvar FormRegisterContext = /*#__PURE__*/React.createContext({\n  register: function register() {},\n  deregister: function deregister() {},\n  setValue: function setValue() {},\n  setTouched: function setTouched() {},\n  setError: function setError() {},\n  update: function update() {},\n  getField: function getField() {},\n  expectRemoval: function expectRemoval() {},\n  getInitialValue: function getInitialValue() {},\n  getSavedValue: function getSavedValue() {}\n});\nvar FormStateContext = /*#__PURE__*/React.createContext({});\nvar FormApiContext = /*#__PURE__*/React.createContext({\n  getFullField: function getFullField() {},\n  getValues: function getValues() {},\n  getOptions: function getOptions() {\n    return {};\n  },\n  setInitialValue: function setInitialValue() {},\n  getInitialValue: function getInitialValue() {},\n  getDerrivedValue: function getDerrivedValue() {},\n  getSavedValue: function getSavedValue() {},\n  removeSavedState: function removeSavedState() {}\n});\nvar GroupContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldStateContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldApiContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldItemApiContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldItemStateContext = /*#__PURE__*/React.createContext();\nvar MultistepStateContext = /*#__PURE__*/React.createContext();\nvar MultistepApiContext = /*#__PURE__*/React.createContext();\nvar MultistepStepContext = /*#__PURE__*/React.createContext();\n\nfunction useFormApi() {\n  var formApi = useContext(FormApiContext);\n  return formApi;\n} // https://github.com/facebook/react/issues/14543\n\n\nfunction useStateWithGetter(initial) {\n  var ref = useRef();\n  var mounted = useRef(true);\n\n  var _useState = useState(initial),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  ref.current = state;\n\n  var set = function set(value) {\n    ref.current = value;\n    if (mounted.current) setState(value);\n  };\n\n  var get = function get() {\n    return ref.current;\n  };\n\n  useEffect(function () {\n    return function () {\n      mounted.current = false;\n    };\n  }, []);\n  return [state, set, get];\n}\n\nvar getChildDisplayName = function getChildDisplayName(WrappedComponent) {\n  // fix for \"memo\" components\n  if (WrappedComponent.type && WrappedComponent.type.name) {\n    return WrappedComponent.type.name;\n  }\n\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n};\n\nvar yupToFormErrors = function yupToFormErrors(yupError) {\n  var errors = {};\n\n  if (yupError.inner) {\n    if (yupError.inner.length === 0) {\n      // console.log(yupError.path);\n      ObjectMap.set(errors, yupError.path, yupError.message);\n      return;\n    }\n\n    var _iterator = _createForOfIteratorHelper(yupError.inner),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var err = _step.value;\n\n        if (!ObjectMap.get(errors, err.path)) {\n          // console.log(errors, err.path, err.message);\n          ObjectMap.set(errors, err.path, err.message);\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }\n\n  return errors;\n};\n\nvar validateYupSchema = function validateYupSchema(schema, values) {\n  try {\n    schema.validateSync(values, {\n      abortEarly: false\n    });\n  } catch (e) {\n    var formErrors = yupToFormErrors(e);\n    return formErrors;\n  }\n};\n\nvar yupToFormError = function yupToFormError(yupError) {\n  if (yupError.inner) {\n    if (yupError.inner.length === 0) {\n      return;\n    }\n\n    var err = yupError.inner[0];\n    return err.message;\n  }\n};\n\nvar validateYupField = function validateYupField(schema, value) {\n  try {\n    schema.validateSync(value, {\n      abortEarly: false\n    });\n  } catch (e) {\n    return yupToFormError(e);\n  }\n};\n\nvar validateAjvSchema = function validateAjvSchema(validate, data) {\n  validate(data);\n  var errors = {};\n\n  if (validate.errors) {\n    validate.errors.forEach(function (_ref) {\n      var message = _ref.message,\n          dataPath = _ref.dataPath,\n          keyword = _ref.keyword,\n          params = _ref.params;\n      var path = dataPath; // Special case for required\n\n      if (keyword === 'required') {\n        path = \"\".concat(path, \".\").concat(params.missingProperty);\n      } // Get rid of leading dot\n\n\n      path = path.replace('.', ''); // console.log('PATH', path, message);\n      // TODO get message from informed if present\n\n      ObjectMap.set(errors, path, message);\n    });\n  }\n\n  return errors;\n}; // https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n\n\nvar uuidv4 = function uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c == 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n};\n\nvar debounce = function debounce(func, wait) {\n  var timeout;\n  return function executedFunction() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var later = function later() {\n      clearTimeout(timeout);\n      func.apply(void 0, args);\n    };\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\nvar computeFieldFromProperty = function computeFieldFromProperty(propertyName, property, prefix) {\n  var uiControl = property['ui:control'],\n      informedProps = property['informed:props'],\n      inputProps = property['input:props'],\n      uiBefore = property['ui:before'],\n      uiAfter = property['ui:after'],\n      oneOf = property.oneOf,\n      items = property.items,\n      schemaEnum = property[\"enum\"],\n      label = property.title,\n      min = property.minimum,\n      max = property.maximum,\n      minLength = property.minLength,\n      maxLength = property.maxLength,\n      pattern = property.pattern,\n      type = property.type,\n      subProperties = property.properties; // Set Id if not passed\n\n  var id = uuidv4();\n\n  if (inputProps && inputProps.id) {\n    id = inputProps.id;\n  }\n\n  var field = {\n    componentType: uiControl,\n    field: prefix ? \"\".concat(prefix, \".\").concat(propertyName) : propertyName,\n    type: type,\n    uiBefore: uiBefore,\n    uiAfter: uiAfter,\n    properties: type === 'object' ? subProperties : undefined,\n    items: type === 'array' ? items : undefined,\n    props: _objectSpread2(_objectSpread2({\n      label: label,\n      id: id,\n      min: min,\n      max: max,\n      minLength: minLength,\n      maxLength: maxLength,\n      pattern: pattern\n    }, informedProps), inputProps)\n  };\n\n  if (oneOf) {\n    var options = property.oneOf.map(function (option) {\n      var _option$inputProps = option['input:props'],\n          inputProps = _option$inputProps === void 0 ? {} : _option$inputProps;\n      return _objectSpread2({\n        value: option[\"const\"],\n        label: option.title\n      }, inputProps);\n    });\n    field.props.options = options;\n  }\n\n  if (schemaEnum) {\n    var _options = property[\"enum\"].map(function (val) {\n      return {\n        value: val,\n        label: val\n      };\n    });\n\n    field.props.options = _options;\n  }\n\n  if (items && items.oneOf) {\n    var _options2 = items.oneOf.map(function (option) {\n      var _option$inputProps2 = option['input:props'],\n          inputProps = _option$inputProps2 === void 0 ? {} : _option$inputProps2;\n      return _objectSpread2({\n        value: option[\"const\"],\n        label: option.title\n      }, inputProps);\n    });\n\n    field.props.options = _options2;\n  }\n\n  return field;\n};\n\nvar computeFieldsFromSchema = function computeFieldsFromSchema(schema, onlyValidateSchema, prefix) {\n  if (!schema || onlyValidateSchema) {\n    return [];\n  } // Grab properties and items off of schema\n\n\n  var _schema$properties = schema.properties,\n      properties = _schema$properties === void 0 ? {} : _schema$properties,\n      allOf = schema.allOf,\n      _schema$propertyOrder = schema.propertyOrder,\n      propertyOrder = _schema$propertyOrder === void 0 ? [] : _schema$propertyOrder;\n\n  if (Object.keys(properties).length > 0) {\n    // Attempt to generate fields from properties\n    var fields = Object.keys(properties).sort(function (a, b) {\n      var aIndex = propertyOrder.indexOf(a);\n      var bIndex = propertyOrder.indexOf(b);\n      return (aIndex > -1 ? aIndex : propertyOrder.length + 1) - (bIndex > -1 ? bIndex : propertyOrder.length + 1);\n    }).map(function (propertyName) {\n      var property = properties[propertyName];\n      var field = computeFieldFromProperty(propertyName, property, prefix);\n      return field;\n    }); // Check for all of ( we have conditionals )\n\n    if (allOf) {\n      fields.push({\n        componentType: 'conditionals',\n        // Each element of the \"allOf\" array is a conditional\n        allOf: allOf\n      });\n    }\n\n    return fields;\n  }\n\n  return [];\n}; // Examples\n// field = \"name\" ---> properties.name\n// field = \"brother.name\" ---> properties.brother.properties.name\n// field = \"brother.siblings[1].friend.name\" ---> properties.brother.properties.siblings.items[1].properties.friend.properties.name\n\n\nvar getSchemaPathFromJsonPath = function getSchemaPathFromJsonPath(jsonPath) {\n  // Convert\n  var schemaPath = jsonPath.replace(/\\./g, '.properties.').replace(/\\[/g, '.itmes['); // Add first properties\n\n  schemaPath = \"properties.\".concat(schemaPath);\n  return schemaPath;\n};\n/* -------------------------- Formatter ----------------------------- */\n\n\nvar getFormatter = function getFormatter(formatter, value) {\n  // If mask is a string turn it into an array;\n  if (typeof formatter === 'string') {\n    return formatter.split('').map(function (_char) {\n      if (_char === '#') {\n        return /\\d/;\n      }\n\n      if (_char === '*') {\n        return /[\\w]/;\n      }\n\n      return _char;\n    });\n  } // If mask is a function use it to genreate current mask\n\n\n  if (typeof formatter === 'function') {\n    return formatter(value);\n  }\n\n  if (Array.isArray(formatter)) {\n    return formatter;\n  } // Should never make it here throw\n\n\n  throw new Error('Formatter must be string, array, or function');\n};\n\nvar matchingIndex = function matchingIndex(a, b) {\n  var i = 0;\n  var mi = -1;\n  var matching = true; // a = \"+1 \"\n  // b = \"+12\"\n\n  while (matching && i < a.length) {\n    if (a[i] == b[i]) {\n      mi = i;\n    } else {\n      matching = false;\n    }\n\n    i = i + 1;\n  }\n\n  return mi;\n};\n\nvar informedFormat = function informedFormat(val, frmtr) {\n  // console.log('Formatting', val);\n  // Null check\n  if (!val) {\n    return {\n      val: val,\n      offset: 0\n    };\n  }\n\n  var value = \"\".concat(val); // Generate formatter array\n\n  var formatter = getFormatter(frmtr, value); // Start to fill in the array\n  // Example: phone formatter\n  // formatter =['+', '1', ' ', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, /\\d/, /\\d/]\n  // value examples:\n  // \"1231231234 ----> +1 123-123-1234\n  // \"+\" \t\t\t\t ----> +\n  // \"+1\" \t\t\t ----> +1\n  // \"+2\"\t\t\t\t ----> +1 2\n  // \"1\"\t\t\t\t ----> +1 1\n  // \"1234\"\t\t\t ----> +1 123-4\n  // \"123a\"      ----> +1 123\n  // Determine prefix length and suffix start\n\n  var prefixLength = formatter.findIndex(function (v) {\n    return typeof v != 'string';\n  });\n\n  var suffixStart = formatter.length - _toConsumableArray(formatter).reverse().findIndex(function (v) {\n    return typeof v != 'string';\n  }); // Formatted value\n\n\n  var formatted = []; // The characters from the current value\n\n  var chars = value.split(''); // To track the value index during itteration\n\n  var vIndex = 0;\n  var start = 0; // If the value matches part of the prefix take it out\n  // Example prefix = \"+1 \" value = [\"+1 123-123-1234\", \"+12\", \"+2\"]\n\n  var matchIndex = matchingIndex(formatter.slice(0, prefixLength), chars.slice(0, prefixLength)); // console.log('Matching index', matchIndex);\n\n  if (matchIndex > -1) {\n    //vIndex = prefixLength;\n    vIndex = matchIndex + 1;\n    formatted = formatted.concat(formatter.slice(0, matchIndex + 1));\n    start = matchIndex + 1;\n  } // Example prefix = \"+1 \" value=[\"1\", \"1234\"]\n\n\n  if (matchIndex < 0) {\n    // Start past the prefix\n    formatted = formatted.concat(formatter.slice(0, prefixLength));\n    start = prefixLength;\n  } // console.log('start', start, formatted);\n\n\n  for (var i = start; i < formatter.length; i++) {\n    // Get current formatter location matcher\n    var matcher = formatter[i]; // We get past the prefix if matcher is not a string\n\n    if (vIndex != chars.length) {\n      // Get the current value character\n      var curChar = chars[vIndex]; // Special case for function\n\n      if (typeof matcher === 'function') {\n        formatted.push(matcher(curChar));\n        vIndex = vIndex + 1;\n      } else {\n        // If type is string normal compare otherwise regex compare\n        var match = typeof matcher === 'string' ? matcher === curChar : matcher.test(curChar); // If the current character of the value matches and matcher is a string\n        // \"1\" === \"1\"\n\n        if (match && typeof matcher === 'string') {\n          formatted.push(matcher); //if( pastPrefix ){\n\n          vIndex = vIndex + 1; //}\n        } // If the current character does not match and matcher is a stirng\n        // \"1\" != \"+\"\n        else if (!match && typeof matcher === 'string') {\n            // Special check for 123a ---> dont want \"+1 123-\"\n            // Special check for 1234 ---> DO want \"+1 123-4\"\n            if (vIndex != chars.length) formatted.push(matcher);\n          } // If the current character matches and the matcher is not a string\n          // /\\d/.test(\"2\")\n          else if (match && typeof matcher != 'string') {\n              formatted.push(curChar);\n              vIndex = vIndex + 1;\n            } // If the current character does NOT match and the matecer is regex\n            // /\\d/.test(\"a\")\n            else if (!match && typeof matcher != 'string') {\n                // Throw out this value\n                vIndex = vIndex + 1;\n                i = i - 1;\n              }\n      }\n    } else {\n      // If mattcher is a string and we are at suffix keep going\n      if (typeof matcher === 'string' && i >= suffixStart) {\n        formatted.push(matcher);\n      } else {\n        // Otherwise we want to break out\n        break;\n      }\n    }\n  }\n\n  return {\n    value: formatted.join(''),\n    offset: value ? formatted.length - value.length : 0\n  };\n};\n/* --------------------------------------- createIntlNumberFormatter --------------------------------------- */\n\n\nvar createIntlNumberFormatter = function createIntlNumberFormatter(locale, opts) {\n  var _numberFormatterWitho, _numberFormatterWitho2;\n\n  var numberFormatter = new Intl.NumberFormat(locale, opts);\n  var numberFormatterWithoutOpts = new Intl.NumberFormat(locale);\n  var decimalChar = (_numberFormatterWitho = (_numberFormatterWitho2 = numberFormatterWithoutOpts.formatToParts(0.1).find(function (_ref2) {\n    var type = _ref2.type;\n    return type === 'decimal';\n  })) === null || _numberFormatterWitho2 === void 0 ? void 0 : _numberFormatterWitho2.value) !== null && _numberFormatterWitho !== void 0 ? _numberFormatterWitho : '.';\n\n  function isRegexEqual(x, y) {\n    return x instanceof RegExp && y instanceof RegExp && x.source === y.source && x.global === y.global && x.ignoreCase === y.ignoreCase && x.multiline === y.multiline;\n  }\n\n  function findLastIndex(arr, predicate) {\n    var l = arr.length; // eslint-disable-next-line no-plusplus\n\n    while (l--) {\n      if (predicate(arr[l])) return l;\n    }\n\n    return -1;\n  }\n\n  function insert(arr, index, value) {\n    var nextArr = _toConsumableArray(arr);\n\n    if (Array.isArray(value)) {\n      nextArr.splice.apply(nextArr, [index, 0].concat(_toConsumableArray(value)));\n    } else {\n      nextArr.splice(index, 0, value);\n    }\n\n    return nextArr;\n  }\n\n  function stripNonNumeric(str) {\n    return \"\".concat(str).replace(/\\D/g, '');\n  }\n\n  function toNumberString(str) {\n    return \"\".concat(str).split(decimalChar).map(function (splitStr) {\n      return stripNonNumeric(splitStr);\n    }).join('.');\n  }\n\n  function toFloat(str) {\n    if (typeof str === 'number') {\n      return str;\n    }\n\n    var _float = parseFloat(toNumberString(str));\n\n    return !Number.isNaN(_float) ? _float : undefined;\n  }\n\n  function mask(value) {\n    var _float2 = toNumberString(value); // if (!float) {\n    //   return [];\n    // }\n\n\n    var fraction = \"\".concat(_float2).split('.')[1];\n    var numberParts = numberFormatter.formatToParts(Number(_float2));\n\n    if (fraction === '0') {\n      numberParts.push({\n        type: 'decimal',\n        value: decimalChar\n      }, {\n        type: 'fraction',\n        value: fraction\n      });\n    }\n\n    var maskArray = numberParts.reduce(function (pv, _ref3) {\n      var type = _ref3.type,\n          partValue = _ref3.value;\n\n      if (['decimal', 'fraction'].includes(type) && fraction == null) {\n        return pv;\n      }\n\n      if (['integer', 'fraction'].includes(type)) {\n        return [].concat(_toConsumableArray(pv), _toConsumableArray(partValue.split('').filter(function (_, index) {\n          return type === 'fraction' ? index < fraction.length : true;\n        }).map(function () {\n          return /\\d/;\n        })));\n      }\n\n      if (type === 'currency') {\n        return [].concat(_toConsumableArray(pv), _toConsumableArray(partValue.split('')));\n      }\n\n      return [].concat(_toConsumableArray(pv), [partValue]);\n    }, []);\n    var lastDigitIndex = findLastIndex(maskArray, function (maskChar) {\n      return isRegexEqual(maskChar, /\\d/);\n    });\n\n    if (maskArray.indexOf(decimalChar) === -1 && \"\".concat(value).indexOf(decimalChar) !== -1) {\n      maskArray = insert(maskArray, lastDigitIndex + 1, [decimalChar, '[]']);\n      lastDigitIndex += 2; // we want to insert a new number after the decimal\n    }\n\n    var endOfMask = maskArray.slice(lastDigitIndex + 1).join('');\n    maskArray = [].concat(_toConsumableArray(maskArray.slice(0, lastDigitIndex + 1)), [endOfMask]);\n    return maskArray;\n  }\n\n  var parser = function parser(value) {\n    if (value == null) {\n      return undefined;\n    }\n\n    return toFloat(value);\n  };\n\n  return {\n    formatter: mask,\n    parser: parser\n  };\n};\n\nvar utils = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  getChildDisplayName: getChildDisplayName,\n  yupToFormErrors: yupToFormErrors,\n  validateYupSchema: validateYupSchema,\n  yupToFormError: yupToFormError,\n  validateYupField: validateYupField,\n  validateAjvSchema: validateAjvSchema,\n  uuidv4: uuidv4,\n  debounce: debounce,\n  computeFieldFromProperty: computeFieldFromProperty,\n  computeFieldsFromSchema: computeFieldsFromSchema,\n  getSchemaPathFromJsonPath: getSchemaPathFromJsonPath,\n  informedFormat: informedFormat,\n  createIntlNumberFormatter: createIntlNumberFormatter\n}); // To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\n// @see https://gist.github.com/gaearon/e7d97cdf38a2907924ea12e4ebdf3c85\n\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined' ? useLayoutEffect : useEffect;\n\nvar useCursorPosition = function useCursorPosition(_ref) {\n  var value = _ref.value,\n      inputRef = _ref.inputRef,\n      _ref$maintainCursor = _ref.maintainCursor,\n      maintainCursor = _ref$maintainCursor === void 0 ? true : _ref$maintainCursor;\n\n  var _useStateWithGetter = useStateWithGetter(0),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      cursor = _useStateWithGetter2[0],\n      setCursor = _useStateWithGetter2[1],\n      getCursor = _useStateWithGetter2[2];\n\n  var _useStateWithGetter3 = useStateWithGetter(0),\n      _useStateWithGetter4 = _slicedToArray(_useStateWithGetter3, 3),\n      cursorOffset = _useStateWithGetter4[0],\n      setCursorOffset = _useStateWithGetter4[1],\n      getCursorOffset = _useStateWithGetter4[2];\n\n  useIsomorphicLayoutEffect(function () {\n    if (inputRef.current != null && getCursor()) {\n      // inputRef.current.selectionEnd = getCursor() + getCursorOffset();\n      var cursorLoc = getCursor() + getCursorOffset(); // Only offset if we need to\n\n      if (getCursorOffset() != 0 && maintainCursor) {\n        inputRef.current.setSelectionRange(cursorLoc + 1, cursorLoc + 1);\n      } else if (maintainCursor) {\n        inputRef.current.setSelectionRange(cursorLoc, cursorLoc);\n      }\n    }\n  }, [value]);\n  return {\n    setCursorOffset: setCursorOffset,\n    setCursor: setCursor,\n    cursor: cursor,\n    getCursor: getCursor,\n    cursorOffset: cursorOffset\n  };\n};\n/**\n *\n * Acts as a react useEffect that does not run on first render.\n *\n * @example\n * useUpdateEffect(()=>{...}, [foo])\n * 1st Render: NO CALL\n * foo changes: GETS CALLED\n *\n */\n\n\nvar useUpdateEffect = function useUpdateEffect(effect, deps) {\n  var firstRef = useRef(true);\n  var isFirstMount = firstRef.current;\n  useEffect(function () {\n    if (!isFirstMount) {\n      return effect();\n    } else {\n      firstRef.current = false;\n    }\n  }, deps);\n};\n\nvar logger = debug('informed:useField' + '\\t'); // localStorage.debug = 'informed:.*' << HOW to enable debuging\n\nvar initializeValue = function initializeValue(value, mask, formatter, parser, initialize) {\n  if (value != null) {\n    // Call users initialize if it was passed\n    if (initialize) {\n      return initialize(value);\n    } // Call mask if it was passed\n\n\n    if (mask) {\n      return mask(value);\n    }\n\n    if (formatter && !parser) {\n      var res = informedFormat(value, formatter);\n      return res.value;\n    }\n\n    return value;\n  } // Not needed but called out specifically\n\n\n  return undefined;\n};\n\nvar initializeMask = function initializeMask(value, format, parse, formatter) {\n  // Call format and parse if they were passed\n  if (format && parse) {\n    return format(value);\n  } // Call formatter\n\n\n  if (formatter) {\n    var res = informedFormat(value, formatter);\n    return res.value;\n  }\n\n  return value;\n};\n\nvar generateValidationFunction = function generateValidationFunction(validationFunc, validationSchema, _ref) {\n  var required = _ref.required; // We dont want a validation function if there was nothing passed\n\n  if (validationFunc || validationSchema) {\n    return function (val, values) {\n      if (validationSchema) {\n        return validateYupField(validationSchema, val);\n      }\n\n      if (validationFunc) {\n        return validationFunc(val, values);\n      }\n    };\n  }\n\n  if (required) {\n    return function (val) {\n      return validateRequired(val, required);\n    };\n  }\n};\n\nvar generateOnChange = function generateOnChange(_ref2) {\n  var fieldType = _ref2.fieldType,\n      setValue = _ref2.setValue,\n      onChange = _ref2.onChange,\n      multiple = _ref2.multiple,\n      ref = _ref2.ref;\n\n  var setter = function setter(e) {\n    return setValue(e);\n  };\n\n  if (fieldType === 'text' || fieldType === 'textArea' || fieldType === 'number') {\n    setter = function setter(e) {\n      return setValue(e.target.value, e);\n    };\n  }\n\n  if (fieldType === 'select') {\n    setter = function setter() {\n      var selected = Array.from(ref.current).filter(function (option) {\n        return option.selected;\n      }).map(function (option) {\n        return option.value;\n      });\n      setValue(multiple ? selected : selected[0] || '');\n    };\n  }\n\n  if (fieldType === 'checkbox') {\n    setter = function setter(e) {\n      setValue(e.target.checked);\n\n      if (onChange) {\n        onChange(e);\n      }\n    };\n  }\n\n  return function (e) {\n    setter(e);\n  };\n};\n\nvar generateOnBlur = function generateOnBlur(_ref3) {\n  var setTouched = _ref3.setTouched,\n      onBlur = _ref3.onBlur;\n  return function (e) {\n    setTouched(true);\n\n    if (onBlur) {\n      onBlur(e);\n    }\n  };\n};\n\nvar generateValue = function generateValue(_ref4) {\n  var fieldType = _ref4.fieldType,\n      maskedValue = _ref4.maskedValue,\n      multiple = _ref4.multiple,\n      value = _ref4.value;\n\n  switch (fieldType) {\n    case 'text':\n    case 'number':\n      return !maskedValue && maskedValue !== 0 ? '' : maskedValue;\n\n    case 'textArea':\n      return !maskedValue ? '' : maskedValue;\n\n    case 'select':\n      return value || (multiple ? [] : '');\n\n    case 'checkbox':\n      return !!value;\n\n    default:\n      return value;\n  }\n};\n\nvar generateFieldType = function generateFieldType(fieldType) {\n  switch (fieldType) {\n    case 'text':\n      return fieldType;\n\n    case 'number':\n      return fieldType;\n\n    case 'checkbox':\n      return fieldType;\n\n    default:\n      return;\n  }\n};\n\nvar validateRequired = function validateRequired(value, required) {\n  if (required && (value == null || value === '')) {\n    return typeof required === 'string' ? required : 'This field is required';\n  }\n};\n\nfunction useField() {\n  var fieldProps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var userRef = arguments.length > 1 ? arguments[1] : undefined; // Pull props off of field props\n\n  var field = fieldProps.field,\n      validationFunc = fieldProps.validate,\n      asyncValidate = fieldProps.asyncValidate,\n      validationSchema = fieldProps.validationSchema,\n      mask = fieldProps.mask,\n      maskWithCursorOffset = fieldProps.maskWithCursorOffset,\n      format = fieldProps.format,\n      parse = fieldProps.parse,\n      formatter = fieldProps.formatter,\n      parser = fieldProps.parser,\n      initialValue = fieldProps.initialValue,\n      validateOnChange = fieldProps.validateOnChange,\n      validateOnBlur = fieldProps.validateOnBlur,\n      validateOnMount = fieldProps.validateOnMount,\n      asyncValidateOnBlur = fieldProps.asyncValidateOnBlur,\n      asyncValidateOnMount = fieldProps.asyncValidateOnMount,\n      maskOnBlur = fieldProps.maskOnBlur,\n      allowEmptyString = fieldProps.allowEmptyString,\n      onValueChange = fieldProps.onValueChange,\n      notify = fieldProps.notify,\n      keepState = fieldProps.keepState,\n      maintainCursor = fieldProps.maintainCursor,\n      debug = fieldProps.debug,\n      shadow = fieldProps.shadow,\n      step = fieldProps.step,\n      fieldType = fieldProps.fieldType,\n      multiple = fieldProps.multiple,\n      onChange = fieldProps.onChange,\n      onBlur = fieldProps.onBlur,\n      formController = fieldProps.formController,\n      userRelevant = fieldProps.relevant,\n      required = fieldProps.required,\n      keepStateIfRelevant = fieldProps.keepStateIfRelevant,\n      initialize = fieldProps.initialize,\n      _fieldProps$formatter = fieldProps.formatterDependencies,\n      formatterDependencies = _fieldProps$formatter === void 0 ? [] : _fieldProps$formatter,\n      userProps = _objectWithoutProperties(fieldProps, [\"field\", \"validate\", \"asyncValidate\", \"validationSchema\", \"mask\", \"maskWithCursorOffset\", \"format\", \"parse\", \"formatter\", \"parser\", \"initialValue\", \"validateOnChange\", \"validateOnBlur\", \"validateOnMount\", \"asyncValidateOnBlur\", \"asyncValidateOnMount\", \"maskOnBlur\", \"allowEmptyString\", \"onValueChange\", \"notify\", \"keepState\", \"maintainCursor\", \"debug\", \"shadow\", \"step\", \"fieldType\", \"multiple\", \"onChange\", \"onBlur\", \"formController\", \"relevant\", \"required\", \"keepStateIfRelevant\", \"initialize\", \"formatterDependencies\"]); // Create ref to a field id\n\n\n  var _useState = useState(uuidv4()),\n      _useState2 = _slicedToArray(_useState, 1),\n      fieldId = _useState2[0]; // Grab the form register context\n\n\n  var updater = useContext(FormRegisterContext); // Grab multistepContext\n\n  var multistepContext = useContext(MultistepStepContext);\n  var inMultistep = multistepContext || keepStateIfRelevant; // Grab the form api\n\n  var formApi = useFormApi(); // Create ref to fieldApi\n\n  var fieldApiRef = useRef(); // Create initial render ref\n\n  var initialRenerRef = useRef(true); // Create ref to fieldObject\n\n  var fieldObjectRef = useRef(); // Create ref for pristine and dirty\n\n  var valueTouched = useRef(false); // Getters for value ref\n\n  var getPristine = function getPristine() {\n    return !valueTouched.current;\n  };\n\n  var getDirty = function getDirty() {\n    return valueTouched.current;\n  }; // If the form Controller was passed in then use that instead\n\n\n  if (formController) {\n    updater = formController.updater;\n    formApi = formController.getFormApi();\n  } // Generate validation function\n\n\n  var validate = generateValidationFunction(validationFunc, validationSchema, {\n    required: required\n  }); // Grab possible initial value from form\n\n  var _useState3 = useState(function () {\n    return updater.getInitialValue(field);\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      formInitialValue = _useState4[0]; // We might have keep state so check for it!\n\n\n  var savedState = updater.getSavedValue(field); // Create Initial Values\n\n  var initVal;\n  var initTouched; // We do these checks because initial value could be false or zero!!\n\n  if ((keepState || inMultistep) && savedState) {\n    logger(\"Setting field \".concat(name, \"'s kept state\"), savedState);\n    initVal = savedState.value;\n    initTouched = savedState.touched; // Remove the saved state\n\n    formApi.removeSavedState(name);\n  } else if (initialValue != undefined) {\n    initVal = initialValue;\n  } else {\n    initVal = formInitialValue;\n  } // Initialize state\n\n\n  var _useStateWithGetter = useStateWithGetter(initializeValue(initVal, mask, formatter, parser, initialize)),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      value = _useStateWithGetter2[0],\n      setVal = _useStateWithGetter2[1],\n      getTheVal = _useStateWithGetter2[2];\n\n  var _useStateWithGetter3 = useStateWithGetter(validateOnMount ? validate(value) : undefined),\n      _useStateWithGetter4 = _slicedToArray(_useStateWithGetter3, 3),\n      error = _useStateWithGetter4[0],\n      setErr = _useStateWithGetter4[1],\n      getErr = _useStateWithGetter4[2];\n\n  var _useStateWithGetter5 = useStateWithGetter(initTouched),\n      _useStateWithGetter6 = _slicedToArray(_useStateWithGetter5, 3),\n      touched = _useStateWithGetter6[0],\n      setTouch = _useStateWithGetter6[1],\n      getTouch = _useStateWithGetter6[2];\n\n  var _useState5 = useState(function () {\n    return initializeMask(value, format, parse, formatter);\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      maskedValue = _useState6[0],\n      setMaskedValue = _useState6[1];\n\n  var maskedValueRef = useRef();\n  maskedValueRef.current = maskedValue; // Create then update refs to props\n\n  var initialValueRef = useRef(initialValue);\n  var fieldRef = useRef(field);\n  var prevFieldRef = useRef();\n  initialValueRef.current = initialValue;\n  fieldRef.current = field; // Create ref to input\n\n  var internalRef = useRef(null);\n  var ref = React.useMemo(function () {\n    return userRef || internalRef;\n  }, []); // Setup cursor position tracking\n\n  var _useCursorPosition = useCursorPosition({\n    value: value,\n    inputRef: ref,\n    maintainCursor: !!maintainCursor\n  }),\n      getCursor = _useCursorPosition.getCursor,\n      setCursor = _useCursorPosition.setCursor,\n      setCursorOffset = _useCursorPosition.setCursorOffset; // Default relevant function\n\n\n  var relevantFunc = function relevantFunc() {\n    return true;\n  };\n\n  var relevant = function relevant(params) {\n    var rel = userRelevant || relevantFunc;\n    var ff = formApi.getFullField(fieldRef.current) || fieldRef.current;\n    var args = {\n      path: ff,\n      parentPath: ff.replace(/(.*)[.[].*/, '$1'),\n      get: function get(values, path) {\n        return ObjectMap.get(values, path);\n      }\n    };\n\n    if (multistepContext && multistepContext.relevant) {\n      return rel(params, args) && multistepContext.relevant(params, args);\n    }\n\n    return rel(params, args);\n  };\n\n  var _useStateWithGetter7 = useStateWithGetter(relevant(formApi.getValues())),\n      _useStateWithGetter8 = _slicedToArray(_useStateWithGetter7, 3),\n      isRelevant = _useStateWithGetter8[0],\n      setIsRelevant = _useStateWithGetter8[1],\n      getIsRelevant = _useStateWithGetter8[2];\n\n  var multistepRelevant = function multistepRelevant(params) {\n    if (multistepContext && multistepContext.relevant) {\n      return multistepContext.relevant(params);\n    }\n\n    return true;\n  };\n\n  var checkRelevant = function checkRelevant() {\n    var newRel = relevant(formApi.getValues());\n    var curRel = getIsRelevant();\n\n    if (newRel != curRel) {\n      setIsRelevant(newRel);\n    }\n\n    return newRel;\n  };\n\n  useEffect(function () {\n    // Reset if we dont have keep state and relevance changed.\n    if (!isRelevant && !keepState) {\n      fieldApiRef.current.reset();\n    }\n  }, [isRelevant]);\n  useEffect(function () {\n    if (asyncValidate && asyncValidateOnMount) {\n      asyncValidate(getVal(), formApi.getValues());\n    }\n  }, [asyncValidateOnMount, asyncValidate]); // Special getter to support shadow fields\n\n  var getVal = function getVal() {\n    return shadow ? formApi.getDerrivedValue(field) : getTheVal();\n  };\n  /* ---------------------- Setters ---------------------- */\n  // ---- Define set error ----\n\n\n  var setError = function setError(val) {\n    var _ref5 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        preventUpdate = _ref5.preventUpdate; // For multistep forms always set error to undefined when not at that step\n\n\n    if (step && formApi.getStep() < step) {\n      logger(\"Setting \".concat(field, \"'s error to undefined as we are not at that step\"));\n      setErr(undefined);\n      updater.setError(fieldId, undefined, !preventUpdate);\n    } else {\n      logger(\"Setting \".concat(field, \"'s error to \").concat(val));\n      setErr(val);\n      updater.setError(fieldId, val, !preventUpdate);\n    }\n  }; // ---- Define set value ----\n\n\n  var setValue = function setValue(v, e) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var val = v; // This value has now been modified\n\n    valueTouched.current = true;\n    logger(\"Setting \".concat(field, \" to \").concat(val)); // Set value may have been called externally\n    // NOT from an inputs change event ( onChange )\n    // Therefore, as a precausion, we call the initialize function to format it just in case\n\n    if (initialize) {\n      val = initialize(val);\n    } // Get the most up to date options\n\n\n    var formOptions = formApi.getOptions(); // Initialize maked value\n\n    var maskedVal = val;\n\n    if (val === '' && !allowEmptyString && !options.allowEmptyString && !formOptions.allowEmptyStrings) {\n      val = undefined;\n    } // Turn string into number for number fields\n\n\n    if ((fieldProps.type === 'number' || fieldType === 'number') && val !== undefined) {\n      val = +val;\n    } // Remember Cursor position!\n\n\n    if (e && e.target && e.target.selectionStart) {\n      setCursor(e.target.selectionStart);\n    } // Call mask if it was passed\n\n\n    if (mask && !maskOnBlur) {\n      maskedVal = mask(val, getCursor());\n      val = mask(val, getCursor());\n    } // Call maskWithCursorOffset if it was passed\n\n\n    if (maskWithCursorOffset && !maskOnBlur) {\n      var res = maskWithCursorOffset(val, getCursor());\n      maskedVal = res.value;\n      val = res.value;\n      setCursorOffset(res.offset);\n    } // Call format and parse if they were passed\n\n\n    if (format && parse) {\n      // Masked value only differs from value when format and parse are used\n      val = parse(val);\n      maskedVal = format(val);\n    } // Call formatter and parser if passed\n\n\n    if (formatter) {\n      var _res = informedFormat(val, formatter);\n\n      setCursorOffset(_res.offset);\n      maskedVal = _res.value;\n      val = maskedVal;\n    } // // Only parse if parser was passed\n\n\n    if (parser) {\n      val = val != null ? parser(val) : val;\n    } // We only need to call validate if the user gave us one\n    // and they want us to validate on change && its not the initial validation\n\n\n    if (validate && validateOnChange && !options.initial) {\n      logger(\"Validating after change \".concat(field, \" \").concat(val));\n      setError(validate(val, formApi.getValues()));\n    } // Now we update the value\n\n\n    setVal(val);\n    setMaskedValue(maskedVal); // If the user passed in onValueChange then call it!\n\n    if (onValueChange) {\n      onValueChange(val);\n    } // Call the updater\n\n\n    updater.setValue(fieldId, val, !options.preventUpdate);\n  };\n\n  useUpdateEffect(function () {\n    fieldApiRef.current.setValue(maskedValueRef.current);\n  }, _toConsumableArray(formatterDependencies)); // ---- Define set touched ----\n\n  var setTouched = function setTouched(val, reset) {\n    var _ref6 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n        preventUpdate = _ref6.preventUpdate;\n\n    logger(\"Field \".concat(field, \" has been touched\")); // We only need to call validate if the user gave us one\n    // and they want us to validate on blur\n\n    if (validate && validateOnBlur && !reset && val) {\n      logger(\"Validating after blur \".concat(field, \" \").concat(getVal()));\n      setError(validate(getVal(), formApi.getValues()));\n    } // Same for async\n\n\n    if (asyncValidate && asyncValidateOnBlur && !reset && val) {\n      logger(\"Validating async after blur \".concat(field, \" \").concat(getVal()));\n      asyncValidate(getVal(), formApi.getValues());\n    } // Call mask if it was passed\n\n\n    if (mask && maskOnBlur) {\n      // Generate the masked value from the current value\n      var maskedVal = mask(getVal()); // Now we update the value\n\n      setVal(maskedVal);\n      setMaskedValue(maskedVal); // If the user passed in onValueChange then call it!\n\n      if (onValueChange) {\n        onValueChange(maskedVal);\n      } // Call the updater\n\n\n      updater.setValue(fieldId, maskedVal, !preventUpdate);\n    } // Call maskWithCursorOffset if it was passed\n\n\n    if (maskWithCursorOffset && maskOnBlur) {\n      // Generate the mask and offset\n      var res = maskWithCursorOffset(getVal()); // Set the offset\n\n      setCursorOffset(res.offset); // Now we update the value\n\n      setVal(res.value);\n      setMaskedValue(res.value); // If the user passed in onValueChange then call it!\n\n      if (onValueChange) {\n        onValueChange(res.value);\n      } // Call the updater\n\n\n      updater.setValue(fieldId, res.value, !preventUpdate);\n    } // Finally we set touched and call the updater\n\n\n    setTouch(val);\n    updater.setTouched(fieldId, val, !preventUpdate);\n  }; // ---- Define reset ----\n\n\n  var reset = function reset() {\n    var _ref7 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        preventUpdate = _ref7.preventUpdate;\n\n    var initVal = initializeValue(initialValueRef.current || updater.getInitialValue(fieldRef.current), mask, formatter, parser, initialize); // TODO support numbers\n\n    setValue(initVal, null, {\n      initial: true,\n      preventUpdate: preventUpdate\n    }); // Setting somthing to undefined will remove it\n\n    setError(validateOnMount ? validate(initVal) : undefined, {\n      preventUpdate: preventUpdate\n    });\n    setTouched(undefined, true, {\n      preventUpdate: preventUpdate\n    });\n\n    if (asyncValidateOnMount && asyncValidate) {\n      asyncValidate(getVal(), formApi.getValues());\n    } // We are now at our initial state\n\n\n    valueTouched.current = false;\n  }; // ---- Define validate ----\n  // Note: it takes values as an optimization for when\n  // the form controller calls it ( dont need to generate all values )\n  // over and over :)\n\n\n  var fieldValidate = function fieldValidate(values) {\n    if (validate) {\n      logger(\"Field validating \".concat(field, \" \").concat(getVal()));\n      setError(validate(getVal(), values || formApi.getValues()));\n    }\n  };\n\n  var fieldAsyncValidate = function fieldAsyncValidate(values) {\n    if (asyncValidate) {\n      logger(\"Field async validating \".concat(field, \" \").concat(getVal()));\n      asyncValidate(getVal(), values || formApi.getValues());\n    }\n  };\n  /* ----------------- Field Api && State ----------------- */\n  // Build the field api\n\n\n  var fieldApi = {\n    setValue: setValue,\n    setTouched: setTouched,\n    setError: setError,\n    reset: reset,\n    validate: fieldValidate,\n    asyncValidate: fieldAsyncValidate,\n    getValue: getVal,\n    getTouched: getTouch,\n    getError: getErr,\n    getIsRelevant: getIsRelevant,\n    getDirty: getDirty,\n    getPristine: getPristine,\n    getFieldState: function getFieldState() {\n      return {\n        value: getVal(),\n        touched: getTouch(),\n        dirty: getDirty(),\n        pristine: getPristine()\n      };\n    },\n    relevant: relevant,\n    multistepRelevant: multistepRelevant,\n    checkRelevant: checkRelevant\n  };\n  fieldApiRef.current = fieldApi; // Build the field state\n\n  var fieldState = {\n    value: value,\n    error: error,\n    touched: touched,\n    maskedValue: maskedValue,\n    isRelevant: isRelevant,\n    dirty: valueTouched.current,\n    pristine: !valueTouched.current\n  }; // Create shadow state if this is a shadow field\n\n  if (shadow) {\n    fieldState = {\n      error: error,\n      touched: touched\n    };\n  }\n\n  logger('Render', formApi.getFullField(field), fieldState); // We want to register and deregister this field\n\n  useIsomorphicLayoutEffect(function () {\n    var fullField = formApi.getFullField(fieldRef.current);\n    logger('Register', fieldId, fieldRef.current);\n    fieldObjectRef.current = {\n      field: fullField,\n      fieldId: fieldId,\n      fieldApi: fieldApi,\n      fieldState: fieldState,\n      notify: notify,\n      keepState: keepState,\n      inMultistep: inMultistep,\n      shadow: shadow\n    };\n    updater.register(fieldId, fieldObjectRef.current);\n    return function () {\n      var fullField = formApi.getFullField(fieldRef.current);\n      logger('Deregister', fieldId, fullField);\n      updater.deregister(fieldId);\n    };\n  }, []); // We want to let the controller know of changes on this field when specific props change\n\n  useEffect(function () {\n    var fullField = formApi.getFullField(field);\n\n    if (initialRenerRef.current) {\n      initialRenerRef.current = false;\n    } else {\n      logger('Update', field, inMultistep);\n      fieldObjectRef.current.field = fullField;\n      updater.update(fieldId, fieldObjectRef.current, prevFieldRef.current);\n    }\n\n    return function () {\n      prevFieldRef.current = fullField;\n    };\n  }, [field]); // Maintain cursor position\n  // useLayoutEffect(\n  //   () => {\n  //     if (maintainCursor && ref.current != null && getCursor())\n  //       ref.current.selectionEnd = getCursor() + getCursorOffset();\n  //   },\n  //   [value]\n  // );\n  // for debugging\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && ref) {\n      ref.current.style.border = '5px solid orange';\n      setTimeout(function () {\n        ref.current.style.borderWidth = '2px';\n        ref.current.style.borderStyle = 'inset';\n        ref.current.style.borderColor = 'initial';\n        ref.current.style.borderImage = 'initial';\n      }, 500);\n    }\n  }); // This is an awesome optimization!!\n\n  var shouldUpdate = [].concat(_toConsumableArray(Object.values(fieldState)), _toConsumableArray(Object.values(fieldProps)), _toConsumableArray(Object.values(userProps)));\n\n  var render = function render(children) {\n    return useMemo(function () {\n      return isRelevant ? children : null;\n    }, _toConsumableArray(shouldUpdate));\n  }; // const render = children => {\n  //   // console.log('RENDER', field);\n  //   return isRelevant ? children : null;\n  // };\n  // Build some setub fields so users can easily intagrate without any hookup code\n\n\n  var name = field;\n  var changeHandler = generateOnChange({\n    fieldType: fieldType,\n    setValue: setValue,\n    onChange: onChange,\n    multiple: multiple,\n    ref: ref\n  });\n  var blurHandler = generateOnBlur({\n    setTouched: setTouched,\n    onBlur: onBlur\n  });\n  var hookedValue = generateValue({\n    fieldType: fieldType,\n    maskedValue: maskedValue,\n    multiple: multiple,\n    value: value\n  });\n  var type = generateFieldType(fieldType);\n  return {\n    fieldState: fieldState,\n    fieldApi: fieldApi,\n    render: render,\n    ref: ref,\n    userProps: _objectSpread2(_objectSpread2({}, userProps), {}, {\n      multiple: multiple,\n      // WE NEED TO PUT THESE BACK!!\n      onChange: onChange,\n      // WE NEED TO PUT THESE BACK!!\n      onBlur: onBlur,\n      // WE NEED TO PUT THESE BACK!!\n      // required // WE NEED TO PUT THESE BACK!!\n      id: userProps.id || fieldId // If user did not pass id we pass fields id\n\n    }),\n    informed: _objectSpread2({\n      name: name,\n      multiple: multiple,\n      onChange: changeHandler,\n      onBlur: blurHandler,\n      value: hookedValue,\n      ref: ref,\n      type: type,\n      id: userProps.id || fieldId\n    }, userProps)\n  };\n}\n\nvar asField = function asField(Component) {\n  var forwardRef = /*#__PURE__*/React.forwardRef(function (props, userRef) {\n    var _useField = useField(props, userRef),\n        fieldState = _useField.fieldState,\n        fieldApi = _useField.fieldApi,\n        render = _useField.render,\n        ref = _useField.ref,\n        userProps = _useField.userProps;\n\n    return render( /*#__PURE__*/React.createElement(Component, _extends({\n      fieldApi: fieldApi,\n      fieldState: fieldState,\n      field: props.field,\n      forwardedRef: ref,\n      debug: props.debug,\n      type: props.type\n    }, userProps)));\n  });\n  forwardRef.displayName = \"asField(\".concat(getChildDisplayName(Component), \")\");\n  return forwardRef;\n};\n\nvar logger$1 = debug('informed:Text' + '\\t');\n\nvar Text = function Text(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var maskedValue = fieldState.maskedValue;\n  var setValue = fieldApi.setValue,\n      setTouched = fieldApi.setTouched;\n\n  var _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      forwardedRef = props.forwardedRef,\n      debug = props.debug,\n      label = props.label,\n      title = props.title,\n      id = props.id,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"forwardedRef\", \"debug\", \"label\", \"title\", \"id\"]);\n\n  logger$1('Render', field); // for debugging\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && forwardedRef) {\n      forwardedRef.current.style.background = 'red';\n      setTimeout(function () {\n        forwardedRef.current.style.background = 'white';\n      }, 500);\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"input\", _extends({}, rest, {\n    id: id,\n    name: field,\n    ref: forwardedRef,\n    value: !maskedValue && maskedValue !== 0 ? '' : maskedValue,\n    onChange: function onChange(e) {\n      setValue(e.target.value, e);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    }\n  })));\n};\n\nvar Text$1 = asField(Text);\n\nvar TextArea = function TextArea(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var maskedValue = fieldState.maskedValue;\n  var setValue = fieldApi.setValue,\n      setTouched = fieldApi.setTouched;\n\n  var _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      forwardedRef = props.forwardedRef,\n      debug = props.debug,\n      label = props.label,\n      id = props.id,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"forwardedRef\", \"debug\", \"label\", \"id\"]); // for debugging\n\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && forwardedRef) {\n      forwardedRef.current.style.background = 'red';\n      setTimeout(function () {\n        forwardedRef.current.style.background = 'white';\n      }, 500);\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"textarea\", _extends({}, rest, {\n    id: id,\n    name: field,\n    ref: forwardedRef,\n    value: !maskedValue ? '' : maskedValue,\n    onChange: function onChange(e) {\n      setValue(e.target.value, e);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    }\n  })));\n};\n\nvar TextArea$1 = asField(TextArea);\nvar logger$2 = debug('informed:Select' + '\\t');\n\nvar Select = function Select(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var value = fieldState.value;\n  var setTouched = fieldApi.setTouched;\n\n  var onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      options = props.options,\n      children = props.children,\n      forwardedRef = props.forwardedRef,\n      debug = props.debug,\n      multiple = props.multiple,\n      label = props.label,\n      id = props.id,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"options\", \"children\", \"forwardedRef\", \"debug\", \"multiple\", \"label\", \"id\"]);\n\n  var selectRef = useRef();\n\n  var handleChange = function handleChange(e) {\n    var selected = Array.from((forwardedRef || selectRef).current).filter(function (option) {\n      return option.selected;\n    }).map(function (option) {\n      return option.value;\n    });\n    fieldApi.setValue(multiple ? selected : selected[0] || '');\n\n    if (onChange && e) {\n      onChange(e);\n    }\n  }; // for debugging\n\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && forwardedRef) {\n      forwardedRef.current.style.background = 'red';\n      setTimeout(function () {\n        forwardedRef.current.style.background = 'white';\n      }, 500);\n    }\n  });\n  logger$2('Render', field, value);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"select\", _extends({}, rest, {\n    id: id,\n    multiple: multiple,\n    name: field,\n    ref: forwardedRef || selectRef,\n    value: value || (multiple ? [] : ''),\n    onChange: handleChange,\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    }\n  }), options ? options.map(function (option) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: option.value,\n      value: option.value,\n      disabled: option.disabled\n    }, option.label);\n  }) : children));\n};\n\nvar Select$1 = asField(Select);\n\nvar Checkbox = function Checkbox(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var value = fieldState.value;\n  var setValue = fieldApi.setValue,\n      setTouched = fieldApi.setTouched;\n\n  var _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      debug = props.debug,\n      forwardedRef = props.forwardedRef,\n      id = props.id,\n      label = props.label,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"debug\", \"forwardedRef\", \"id\", \"label\"]);\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"input\", _extends({}, rest, {\n    id: id,\n    name: field,\n    ref: forwardedRef,\n    checked: !!value,\n    onChange: function onChange(e) {\n      setValue(e.target.checked);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    },\n    type: \"checkbox\"\n  })));\n};\n\nvar Checkbox$1 = asField(Checkbox);\n\nvar withRadioGroup = function withRadioGroup(Component) {\n  return /*#__PURE__*/React.forwardRef(function (props, ref) {\n    return /*#__PURE__*/React.createElement(GroupContext.Consumer, null, function (_ref) {\n      var radioGroupApi = _ref.radioGroupApi,\n          radioGroupState = _ref.radioGroupState;\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        radioGroupApi: radioGroupApi,\n        radioGroupState: radioGroupState,\n        ref: ref\n      }, props));\n    });\n  });\n};\n\nvar Radio = function Radio(_ref) {\n  var radioGroupApi = _ref.radioGroupApi,\n      radioGroupState = _ref.radioGroupState,\n      props = _objectWithoutProperties(_ref, [\"radioGroupApi\", \"radioGroupState\"]);\n\n  var groupValue = radioGroupState.value;\n  var setValue = radioGroupApi.setValue,\n      setTouched = radioGroupApi.setTouched,\n      groupOnChange = radioGroupApi.onChange,\n      groupOnBlur = radioGroupApi.onBlur;\n\n  var value = props.value,\n      _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      forwardedRef = props.forwardedRef,\n      rest = _objectWithoutProperties(props, [\"value\", \"onChange\", \"onBlur\", \"field\", \"initialValue\", \"forwardedRef\"]);\n\n  return /*#__PURE__*/React.createElement(\"input\", _extends({}, rest, {\n    name: field,\n    ref: forwardedRef,\n    value: value,\n    checked: groupValue === value,\n    onChange: function onChange(e) {\n      if (!e.target.checked) {\n        return;\n      }\n\n      setValue(value);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n\n      if (groupOnChange) {\n        groupOnChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n\n      if (groupOnBlur) {\n        groupOnBlur(e);\n      }\n    },\n    type: \"radio\"\n  }));\n};\n\nvar Radio$1 = withRadioGroup(Radio);\n\nvar RadioGroup = /*#__PURE__*/function (_Component) {\n  _inherits(RadioGroup, _Component);\n\n  var _super = _createSuper(RadioGroup);\n\n  function RadioGroup() {\n    _classCallCheck(this, RadioGroup);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(RadioGroup, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          options = _this$props.options,\n          children = _this$props.children;\n      return /*#__PURE__*/React.createElement(GroupContext.Provider, {\n        value: this.groupContext\n      }, options ? options.map(function (option) {\n        return /*#__PURE__*/React.createElement(\"label\", {\n          key: option.value\n        }, option.label, \" \", /*#__PURE__*/React.createElement(Radio$1, {\n          value: option.value\n        }));\n      }) : children);\n    }\n  }, {\n    key: \"groupContext\",\n    get: function get() {\n      return {\n        radioGroupApi: _objectSpread2(_objectSpread2({}, this.props.fieldApi), {}, {\n          onChange: this.props.onChange,\n          onBlur: this.props.onBlur\n        }),\n        radioGroupState: this.props.fieldState\n      };\n    }\n  }]);\n\n  return RadioGroup;\n}(Component);\n\nvar RadioGroup$1 = asField(RadioGroup);\n\nfunction useArrayFieldApi() {\n  return useContext(ArrayFieldApiContext);\n}\n\nvar AddButton = function AddButton() {\n  var _useArrayFieldApi = useArrayFieldApi(),\n      add = _useArrayFieldApi.add;\n\n  return /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      add();\n    },\n    type: \"button\"\n  }, \"Add\");\n};\n\nfunction useArrayFieldItemApi() {\n  return useContext(ArrayFieldItemApiContext);\n}\n\nvar AddButton$1 = function AddButton() {\n  var _useArrayFieldItemApi = useArrayFieldItemApi(),\n      remove = _useArrayFieldItemApi.remove;\n\n  return /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      remove();\n    },\n    type: \"button\"\n  }, \"Remove\");\n};\n\nvar logger$3 = debug('informed:useArrayField' + '\\t');\n\nvar useArrayField = function useArrayField(_ref) {\n  var field = _ref.field,\n      initialValue = _ref.initialValue,\n      validate = _ref.validate,\n      arrayFieldApiRef = _ref.arrayFieldApiRef,\n      props = _objectWithoutProperties(_ref, [\"field\", \"initialValue\", \"validate\", \"arrayFieldApiRef\"]); // Reference to the form Api\n\n\n  var formApi = useFormApi(); // Keep track of fields that belong to this array field\n\n  var _useState = useState(new Map()),\n      _useState2 = _slicedToArray(_useState, 1),\n      fieldsById = _useState2[0]; // Grab the form register context\n\n\n  var updater = useContext(FormRegisterContext); // May be scoped so get full field name!!\n\n  var fullField = formApi.getFullField(field);\n  var initialVals = updater.getInitialValue(field) || initialValue || []; // TODO throw error if initial value and its not array\n  // If keep state was passed into the child inputs we need to maintain the length of\n  // keys, in order to do so we grab the value from informeds api\n\n  var keptValues = formApi.getSavedValue(fullField) && formApi.getSavedValue(fullField).value;\n\n  var _useStateWithGetter = useStateWithGetter(keptValues || initialVals),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      initialValues = _useStateWithGetter2[0],\n      setInitialValues = _useStateWithGetter2[1],\n      getInitialValues = _useStateWithGetter2[2];\n\n  var initialKeys = initialValues ? initialValues.map(function () {\n    return uuidv4();\n  }) : [];\n\n  var _useStateWithGetter3 = useStateWithGetter(initialKeys),\n      _useStateWithGetter4 = _slicedToArray(_useStateWithGetter3, 3),\n      keys = _useStateWithGetter4[0],\n      setKeys = _useStateWithGetter4[1],\n      getKeys = _useStateWithGetter4[2];\n\n  var validateWithLength = useMemo(function () {\n    return function (value, values) {\n      var length = getKeys() == null ? 0 : getKeys().length;\n      return validate ? validate(value, length, values) : undefined;\n    };\n  }); // Register shadow field\n\n  var _useField = useField(_objectSpread2({\n    field: field,\n    validate: validate ? validateWithLength : undefined,\n    shadow: true\n  }, props)),\n      fieldApi = _useField.fieldApi; // Register for events\n\n\n  useIsomorphicLayoutEffect(function () {\n    // Define event handler\n    var onChangeHandler = function onChangeHandler(fieldName) {\n      // Dont do anythign if we updated\n      if (fieldName === fullField) {\n        return;\n      }\n\n      logger$3(\"\".concat(fullField, \" changed\")); // determine if one of our array children triggered this change\n\n      if (RegExp(\"\".concat(fullField, \"\\\\[[0-9]+\\\\]\")).test(fieldName)) {\n        // If it was we need to call validate\n        fieldApi.validate();\n      }\n    }; // Register for events\n\n\n    formApi.emitter.on('value', onChangeHandler); // Unregister events\n\n    return function () {\n      formApi.emitter.removeListener('value', onChangeHandler);\n    };\n  }, [field]);\n\n  var _remove = function remove(i) {\n    // Notify form to expect removal on this field\n    logger$3('EXPECTING REMOVAL OF', \"\".concat(field, \"[\").concat(i, \"] and \").concat(field, \"[\").concat(keys.length - 1, \"]\"));\n    updater.expectRemoval(\"\".concat(field, \"[\").concat(i, \"]\"));\n    updater.expectRemoval(\"\".concat(field, \"[\").concat(keys.length - 1, \"]\")); // Remove the key\n\n    var newKeys = keys.slice(0, i).concat(keys.slice(i + 1, keys.length));\n    setKeys(newKeys); // Remove the initial value ( user wanted to get rid of that input )\n\n    var initVals = getInitialValues();\n    var newInitialValues = initVals.slice(0, i).concat(initVals.slice(i + 1, initVals.length));\n    setInitialValues(newInitialValues); //formApi.setInitialValue(field, newInitialValues);\n  };\n\n  var swap = function swap(a, b) {\n    logger$3('Swapping', \"\".concat(field, \"[\").concat(a, \"] and \").concat(field, \"[\").concat(b, \"]\")); // Swap the keys\n\n    var newKeys = _toConsumableArray(keys);\n\n    if (keys[a] && keys[b]) {\n      newKeys[a] = keys[b];\n      newKeys[b] = keys[a];\n    } else {\n      // eslint-disable-next-line no-console\n      console.warn(\"Attempted to swap \".concat(a, \" with \").concat(b, \" but one of them does not exist :(\"));\n    }\n\n    setKeys(newKeys);\n  };\n\n  var add = function add() {\n    keys.push(uuidv4());\n    setKeys(_toConsumableArray(keys));\n  };\n\n  var addWithInitialValue = function addWithInitialValue(initialValue) {\n    keys.push(uuidv4());\n    setKeys(_toConsumableArray(keys));\n\n    var newInitialValues = _toConsumableArray(getInitialValues());\n\n    newInitialValues[keys.length - 1] = initialValue;\n    setInitialValues(newInitialValues);\n  };\n\n  var reset = function reset() {\n    // When resetting we reset to the users initial value not the one tracked by this hook\n    var initVals = updater.getInitialValue(field) || initialValue || []; // Set our initial values back to what the user set at beginning\n\n    setInitialValues(initVals); // Build a new set of keys because everything is new !!!\n\n    var resetKeys = initVals ? initVals.map(function () {\n      return uuidv4();\n    }) : []; // Finally set that shit !\n\n    setKeys(resetKeys);\n  };\n\n  var fields = keys.map(function (key, i) {\n    var arrayFieldItemApi = {\n      remove: function remove() {\n        return _remove(i);\n      }\n    };\n    var arrayFieldItemState = {\n      initialValue: initialValues && initialValues[i],\n      key: key,\n      field: \"\".concat(field, \"[\").concat(i, \"]\"),\n      index: i\n    };\n    return _objectSpread2(_objectSpread2({\n      arrayFieldItemApi: arrayFieldItemApi,\n      arrayFieldItemState: arrayFieldItemState\n    }, arrayFieldItemApi), arrayFieldItemState);\n  });\n  var arrayFieldApi = {\n    add: add,\n    swap: swap,\n    addWithInitialValue: addWithInitialValue,\n    reset: reset\n  };\n\n  if (arrayFieldApiRef) {\n    arrayFieldApiRef.current = arrayFieldApi;\n  }\n\n  var arrayFieldState = {\n    fields: fields,\n    field: field\n  }; // Wrap the updater to update array fields references\n\n  var wrappedUpdator = _objectSpread2(_objectSpread2({}, updater), {}, {\n    register: function register(id, fld) {\n      fieldsById.set(id, fld);\n\n      for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        args[_key - 2] = arguments[_key];\n      }\n\n      updater.register.apply(updater, [id, fld].concat(args));\n    },\n    deregister: function deregister(id) {\n      fieldsById[\"delete\"](id);\n\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      updater.deregister.apply(updater, [id].concat(args));\n    },\n    getInitialValue: function getInitialValue(fieldName) {\n      // If we are getting initial value and its for this field return that\n      if (RegExp(\"\".concat(fullField, \"\\\\[[0-9]+\\\\]\")).test(fieldName)) {\n        var path = fieldName.replace(field, '');\n        var v = ObjectMap.get(getInitialValues(), path);\n        logger$3(\"Resetting \".concat(path, \" to \").concat(v));\n        return v;\n      }\n\n      return updater.getInitialValue(fieldName);\n    }\n  });\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n      value: wrappedUpdator\n    }, /*#__PURE__*/React.createElement(ArrayFieldApiContext.Provider, {\n      value: arrayFieldApi\n    }, /*#__PURE__*/React.createElement(ArrayFieldStateContext.Provider, {\n      value: arrayFieldState\n    }, children)));\n  };\n\n  return {\n    render: render,\n    add: add,\n    swap: swap,\n    addWithInitialValue: addWithInitialValue,\n    fields: fields,\n    arrayFieldState: arrayFieldState,\n    arrayFieldApi: arrayFieldApi,\n    field: field\n  };\n};\n\nvar buildScopedFormApi = function buildScopedFormApi(scope, formApi) {\n  return _objectSpread2(_objectSpread2({}, formApi), {}, {\n    getValue: function getValue(field) {\n      return formApi.getValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getTouched: function getTouched(field) {\n      return formApi.getTouched(\"\".concat(scope, \".\").concat(field));\n    },\n    getError: function getError(field) {\n      return formApi.getError(\"\".concat(scope, \".\").concat(field));\n    },\n    setValue: function setValue(field, value) {\n      return formApi.setValue(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setTouched: function setTouched(field, value) {\n      return formApi.setTouched(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setError: function setError(field, value) {\n      return formApi.setError(\"\".concat(scope, \".\").concat(field), value);\n    },\n    getInitialValue: function getInitialValue(field) {\n      return formApi.getInitialValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getSavedValue: function getSavedValue(field) {\n      return formApi.getSavedValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getFullField: function getFullField(field) {\n      return \"\".concat(formApi.getFullField(scope), \".\").concat(field);\n    }\n  });\n};\n\nfunction useScopedApi(scope) {\n  var formApi = useFormApi(); // VERY important to memoize the builder!\n\n  var scopedFormApi = useMemo(function () {\n    return buildScopedFormApi(scope, formApi);\n  }, [scope]);\n  return scopedFormApi;\n}\n\nfunction useFormState() {\n  var formState = useContext(FormStateContext);\n  return formState;\n}\n\nvar Relevant = function Relevant(_ref) {\n  var when = _ref.when,\n      children = _ref.children;\n  var formState = useFormState();\n  var isRelevant = when(formState);\n\n  if (isRelevant) {\n    return children;\n  }\n\n  return null;\n};\n\nvar ArrayField = function ArrayField(_ref) {\n  var relevant = _ref.relevant,\n      field = _ref.field,\n      props = _objectWithoutProperties(_ref, [\"relevant\", \"field\"]); // Need to get formApi to have consistant interface for relevant function\n\n\n  var formApi = useFormApi();\n\n  if (relevant) {\n    var ff = formApi.getFullField(field);\n    var args = {\n      path: ff,\n      parentPath: ff.replace(/(.*)[.[].*/, '$1'),\n      get: function get(values, path) {\n        return ObjectMap.get(values, path);\n      }\n    };\n\n    var when = function when(_ref2) {\n      var values = _ref2.values;\n      return relevant(values, args);\n    };\n\n    return /*#__PURE__*/React.createElement(Relevant, {\n      when: when\n    }, /*#__PURE__*/React.createElement(ArrayFieldWrapper, _extends({\n      field: field\n    }, props)));\n  } else {\n    return /*#__PURE__*/React.createElement(ArrayFieldWrapper, _extends({\n      field: field\n    }, props));\n  }\n};\n\nvar ArrayFieldWrapper = function ArrayFieldWrapper(_ref3) {\n  var children = _ref3.children,\n      props = _objectWithoutProperties(_ref3, [\"children\"]);\n\n  var _useArrayField = useArrayField(props),\n      render = _useArrayField.render,\n      arrayFieldState = _useArrayField.arrayFieldState,\n      arrayFieldApi = _useArrayField.arrayFieldApi,\n      field = _useArrayField.field;\n\n  if (typeof children === 'function') {\n    return render(children(_objectSpread2(_objectSpread2({\n      field: field,\n      arrayFieldApi: arrayFieldApi,\n      arrayFieldState: arrayFieldState\n    }, arrayFieldApi), arrayFieldState)));\n  }\n\n  return render(children);\n};\n\nvar ArrayFieldItem = function ArrayFieldItem(_ref4) {\n  var arrayFieldItemState = _ref4.arrayFieldItemState,\n      arrayFieldItemApi = _ref4.arrayFieldItemApi,\n      children = _ref4.children; // Grab the form register context\n\n  var updater = useContext(FormRegisterContext); // Grab the form state\n\n  var formApi = useFormApi(); // A little trick I learned in nam to trigger rerender\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1]; // Keep track of fields that belong to this array field\n\n\n  var _useState3 = useState(new Map()),\n      _useState4 = _slicedToArray(_useState3, 1),\n      fieldsById = _useState4[0]; // Get this items field\n\n\n  var field = arrayFieldItemState.field; // Create scoped api\n\n  var scopedApi = useScopedApi(field); // State generation function\n\n  var getState = function getState() {\n    var _formApi$getState = formApi.getState(),\n        values = _formApi$getState.values,\n        errors = _formApi$getState.errors,\n        touched = _formApi$getState.touched; // Get this fields state\n\n\n    var itemState = {\n      values: ObjectMap.get(values, field),\n      errors: ObjectMap.get(errors, field),\n      touched: ObjectMap.get(touched, field)\n    };\n    return itemState;\n  }; // Register for events for rerenders!\n\n\n  useEffect(function () {\n    // Define event handler\n    var onChangeHandler = function onChangeHandler(fieldName) {\n      // Example foo.bar.baz[3].baz >>>> foo.bar.baz[3]\n      var magicValue = fieldName.slice(0, fieldName.lastIndexOf('[') != -1 ? fieldName.lastIndexOf(']') + 1 : fieldName.length); // This field updated so trigger rerender\n\n      if (magicValue === field) {\n        setState(Math.random());\n      }\n    }; // Register for events\n\n\n    formApi.emitter.on('value', onChangeHandler); // Unregister events\n\n    return function () {\n      formApi.emitter.removeListener('value', onChangeHandler);\n    };\n  }, [field]); // Resets all fields in this item\n\n  var reset = function reset() {\n    fieldsById.forEach(function (fld) {\n      fld.fieldApi.reset();\n    });\n  }; // Generate the item state\n\n\n  var itemState = getState(); // Wrap the updater to update array fields references\n\n  var wrappedUpdator = _objectSpread2(_objectSpread2({}, updater), {}, {\n    register: function register(id, fld, initialRender) {\n      fieldsById.set(id, fld);\n      updater.register(id, fld, initialRender);\n    },\n    deregister: function deregister(id) {\n      fieldsById[\"delete\"](id);\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      updater.deregister.apply(updater, [id].concat(args));\n    }\n  });\n\n  var arrayFieldItemApiValue = _objectSpread2(_objectSpread2(_objectSpread2({}, arrayFieldItemApi), scopedApi), {}, {\n    reset: reset\n  });\n\n  var arrayFieldItemStateValue = _objectSpread2(_objectSpread2({}, arrayFieldItemState), itemState);\n\n  if (typeof children === 'function') {\n    return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n      value: wrappedUpdator\n    }, /*#__PURE__*/React.createElement(ArrayFieldItemApiContext.Provider, {\n      value: arrayFieldItemApiValue\n    }, /*#__PURE__*/React.createElement(ArrayFieldItemStateContext.Provider, {\n      value: arrayFieldItemStateValue\n    }, children(_objectSpread2(_objectSpread2({\n      arrayFieldItemApi: arrayFieldItemApiValue,\n      arrayFieldItemState: arrayFieldItemStateValue\n    }, arrayFieldItemApiValue), arrayFieldItemStateValue)))));\n  }\n\n  return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n    value: wrappedUpdator\n  }, /*#__PURE__*/React.createElement(ArrayFieldItemApiContext.Provider, {\n    value: arrayFieldItemApiValue\n  }, /*#__PURE__*/React.createElement(ArrayFieldItemStateContext.Provider, {\n    value: arrayFieldItemStateValue\n  }, children)));\n};\n\nArrayField.Items = function (_ref5) {\n  var children = _ref5.children;\n\n  var _useContext = useContext(ArrayFieldStateContext),\n      fields = _useContext.fields;\n\n  return fields.map(function (_ref6) {\n    var arrayFieldItemState = _ref6.arrayFieldItemState,\n        arrayFieldItemApi = _ref6.arrayFieldItemApi;\n    var key = arrayFieldItemState.key;\n    return /*#__PURE__*/React.createElement(ArrayFieldItem, {\n      key: key,\n      arrayFieldItemApi: arrayFieldItemApi,\n      arrayFieldItemState: arrayFieldItemState\n    }, children);\n  });\n};\n\nvar FormComponents = function FormComponents(_ref) {\n  var components = _ref.components; // Get the field map off the forms context\n\n  var _useContext = useContext(FormRegisterContext),\n      fieldMap = _useContext.fieldMap;\n\n  if (!components) return null;\n  return components.map(function (comp, i) {\n    var componentType = comp['ui:control'];\n    var Component = fieldMap[componentType];\n    return /*#__PURE__*/React.createElement(Component, {\n      key: \"ui-comp-\".concat(i)\n    });\n  });\n};\n\nvar logger$4 = debug('informed:FormFields' + '\\t');\n\nvar FormFields = function FormFields(_ref) {\n  var schema = _ref.schema,\n      prefix = _ref.prefix,\n      onlyValidateSchema = _ref.onlyValidateSchema; // Get the field map off the forms context\n\n  var _useContext = useContext(FormRegisterContext),\n      fieldMap = _useContext.fieldMap; // Get fields from scheama\n\n\n  var fields = useMemo(function () {\n    var schemaFields = computeFieldsFromSchema(schema, onlyValidateSchema, prefix);\n    var mapedFields = schemaFields.map(function (schemaField, i) {\n      var field = schemaField.field,\n          props = schemaField.props,\n          type = schemaField.type,\n          properties = schemaField.properties,\n          items = schemaField.items,\n          componentType = schemaField.componentType,\n          uiBefore = schemaField.uiBefore,\n          uiAfter = schemaField.uiAfter,\n          allOf = schemaField.allOf;\n      var Component = fieldMap[componentType]; // console.log('WTF', schemaField);\n\n      logger$4('Rendering Field', field, schemaField); // Scope for nested\n\n      if (!Component && type === 'object' && properties) {\n        return /*#__PURE__*/React.createElement(FormFields, {\n          schema: schemaField,\n          prefix: field,\n          key: \"ScheamField-\".concat(i)\n        });\n      } // Array field for array ( if none was provided use our default )\n\n\n      if (!Component && type === 'array' && items) {\n        return /*#__PURE__*/React.createElement(ArrayField$1, _extends({\n          key: \"ScheamField-\".concat(i),\n          field: field,\n          items: items,\n          uiBefore: uiBefore,\n          uiAfter: uiAfter\n        }, props));\n      } // User created custom array field\n\n\n      if (Component && componentType === 'array' && items && type === 'array') {\n        return /*#__PURE__*/React.createElement(Component, _extends({\n          key: \"ScheamField-\".concat(i),\n          field: field,\n          items: items,\n          uiBefore: uiBefore,\n          uiAfter: uiAfter\n        }, props));\n      } // For conditionals\n\n\n      if (componentType === 'conditionals') {\n        return allOf.map(function (conditional) {\n          // Example then ( its a subschema )\n          // then: {\n          //   properties: {\n          //     spouse: {\n          //       type: 'string',\n          //       title: 'Spouse name',\n          //       'ui:control': 'input'\n          //     }\n          //   }\n          // }\n          var subSchema = conditional.then; // Turn the if into a when function for informed\n          // Example if condition\n          // if: {\n          //   properties: {\n          //     married: { const: 'yes' }\n          //   },\n          //   required: ['married']\n          // },\n\n          var conditions = conditional[\"if\"].properties;\n\n          var when = function when(_ref2) {\n            var values = _ref2.values; // Example key \"married, Example condition: \"{ const: 'yes' }\"\n\n            return Object.keys(conditions).every(function (key) {\n              var condition = conditions[key]; // values.married === 'yes'\n\n              return values[key] === condition[\"const\"];\n            });\n          };\n\n          return /*#__PURE__*/React.createElement(Relevant, {\n            key: \"ScheamField-\".concat(i),\n            when: when\n          }, /*#__PURE__*/React.createElement(FormFields, {\n            schema: subSchema\n          }));\n        });\n      } // If no com ret null ( dont render )\n\n\n      if (!Component) {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        key: \"ScheamField-\".concat(i),\n        field: field\n      }, props));\n    });\n    return mapedFields;\n  }, [schema, prefix]);\n  return fields;\n};\n\nvar ArrayField$1 = function ArrayField$1(_ref) {\n  var field = _ref.field,\n      items = _ref.items,\n      uiBefore = _ref.uiBefore,\n      uiAfter = _ref.uiAfter,\n      props = _objectWithoutProperties(_ref, [\"field\", \"items\", \"uiBefore\", \"uiAfter\"]);\n\n  return /*#__PURE__*/React.createElement(ArrayField, _extends({\n    field: field\n  }, props), /*#__PURE__*/React.createElement(FormComponents, {\n    components: uiBefore\n  }), /*#__PURE__*/React.createElement(ArrayField.Items, null, function (_ref2) {\n    var field = _ref2.field;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FormComponents, {\n      components: items['ui:before']\n    }), /*#__PURE__*/React.createElement(FormFields, {\n      schema: items,\n      prefix: field\n    }), /*#__PURE__*/React.createElement(FormComponents, {\n      components: items['ui:after']\n    }));\n  }), /*#__PURE__*/React.createElement(FormComponents, {\n    components: uiAfter\n  }));\n};\n\nvar defaultFieldMap = {\n  select: Select$1,\n  input: Text$1,\n  textarea: TextArea$1,\n  checkbox: Checkbox$1,\n  radio: RadioGroup$1,\n  add: AddButton,\n  remove: AddButton$1,\n  array: ArrayField$1\n};\nvar debug$2 = debug('informed:Controller' + '\\t');\n\nvar isExpected = function isExpected(path, expectedRemovals) {\n  var includedKey = Object.keys(expectedRemovals).find(function (key) {\n    return path.includes(key);\n  });\n  if (!includedKey) return;\n  var start = path.slice(0, includedKey.length);\n  return start === includedKey;\n};\n\nvar noop = function noop() {};\n\nvar FormController = /*#__PURE__*/function () {\n  function FormController() {\n    var _this = this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, FormController);\n\n    this.options = options; // Initialize listeners\n\n    this.subscriptions = new Map();\n    var ajv = options.ajv,\n        schema = options.schema,\n        fieldMap = options.fieldMap; // Create new ajv instance if passed\n\n    this.ajv = ajv ? new ajv({\n      allErrors: true\n    }) : null;\n    this.ajvValidate = ajv ? this.ajv.compile(schema) : null; // Add field map ( defaults to our field map )\n\n    this.fieldMap = fieldMap || defaultFieldMap; // Map will store all fields by id\n    // Key => uuid\n    // Val => fieldObj\n    // Why? so the form can control the fields!\n\n    this.fieldsById = new Map(); // Map will store all fields by name\n    // Key => fieldName - example: \"foo.bar[3].baz\"\n    // Val => fieldObj\n    // Why? so the form can control the fields!\n\n    this.fieldsByName = {\n      get: function get(name) {\n        var fieldByName; // TODO speed this up maybe\n\n        _this.fieldsById.forEach(function (value) {\n          if (value && value.field === name) {\n            fieldByName = value;\n          }\n        });\n\n        return fieldByName;\n      }\n    }; // Map to store whos on the screen\n\n    this.onScreen = {}; // Map to store fields being removed\n\n    this.expectedRemovals = {};\n    this.pulledOut = {}; // Map of saved values\n\n    this.savedValues = {}; // Initialize the controller state\n\n    this.state = {\n      pristine: true,\n      dirty: false,\n      invalid: false,\n      submits: 0,\n      step: 0,\n      validating: 0,\n      submitting: false,\n      values: {},\n      errors: {},\n      touched: {}\n    }; // Initialize a dummy field ( see getField for example use )\n\n    this.dummyField = {\n      fieldApi: {\n        setValue: noop,\n        setTouched: noop,\n        setError: noop,\n        reset: noop,\n        validate: noop,\n        getValue: noop,\n        getTouched: noop,\n        getError: noop,\n        getFieldState: noop,\n        checkRelevant: noop,\n        getPristine: noop,\n        getDirty: noop\n      }\n    }; // Bind functions that will be called externally\n\n    this.deregister = this.deregister.bind(this);\n    this.register = this.register.bind(this);\n    this.getValue = this.getValue.bind(this);\n    this.getTouched = this.getTouched.bind(this);\n    this.getError = this.getError.bind(this);\n    this.getErrors = this.getErrors.bind(this);\n    this.setValue = this.setValue.bind(this);\n    this.getValues = this.getValues.bind(this);\n    this.getStep = this.getStep.bind(this);\n    this.setStep = this.setStep.bind(this);\n    this.back = this.back.bind(this);\n    this.next = this.next.bind(this);\n    this.setCurrent = this.setCurrent.bind(this);\n    this.setTouched = this.setTouched.bind(this);\n    this.setError = this.setError.bind(this);\n    this.setFormError = this.setFormError.bind(this);\n    this.submitForm = this.submitForm.bind(this);\n    this.reset = this.reset.bind(this);\n    this.update = this.update.bind(this);\n    this.validate = this.validate.bind(this);\n    this.screenValid = this.screenValid.bind(this);\n    this.keyDown = this.keyDown.bind(this);\n    this.getField = this.getField.bind(this);\n    this.getInitialValue = this.getInitialValue.bind(this);\n    this.setInitialValue = this.setInitialValue.bind(this);\n    this.getOptions = this.getOptions.bind(this);\n    this.getFormState = this.getFormState.bind(this);\n    this.expectRemoval = this.expectRemoval.bind(this);\n    this.getSavedValue = this.getSavedValue.bind(this);\n    this.removeSavedState = this.removeSavedState.bind(this);\n    this.getDerrivedValue = this.getDerrivedValue.bind(this);\n    this.setValues = this.setValues.bind(this);\n    this.resetField = this.resetField.bind(this);\n    this.fieldExists = this.fieldExists.bind(this);\n    this.validateField = this.validateField.bind(this);\n    this.notify = this.notify.bind(this);\n    this.validating = this.validating.bind(this);\n    this.validated = this.validated.bind(this);\n    this.getDirty = this.getDirty.bind(this);\n    this.getPristine = this.getPristine.bind(this);\n    this.on = this.on.bind(this);\n    this.emit = this.emit.bind(this);\n    this.removeListener = this.removeListener.bind(this); // Updater will be used by fields to update and register\n\n    this.updater = {\n      register: this.register,\n      deregister: this.deregister,\n      getField: this.getField,\n      update: this.update,\n      fieldMap: this.fieldMap,\n      setValue: function setValue(fieldId, value) {\n        var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var field = _this.fieldsById.get(fieldId);\n\n        if (!field.shadow) {\n          ObjectMap.set(_this.state.values, field.field, field.fieldApi.getValue());\n        }\n\n        if (!field.fieldApi.relevant(_this.state.values)) {\n          ObjectMap[\"delete\"](_this.state.values, field.field);\n        } // Cleanup phase to get rid of irrelevant fields\n        // Also evaluate relevance on all fields\n\n\n        _this.fieldsById.forEach(function (f) {\n          // If a fields within an irrelivant step then remove it\n          // Otherwise, check to see if its relevant and only remove if keep state is false\n          var newRel = f.fieldApi.checkRelevant();\n\n          if (!f.fieldApi.multistepRelevant(_this.state.values) || !newRel && !f.keepState) {\n            ObjectMap[\"delete\"](_this.state.values, f.field);\n            ObjectMap[\"delete\"](_this.state.touched, f.field);\n            ObjectMap[\"delete\"](_this.state.errors, f.field);\n          }\n        });\n\n        if (emit) {\n          _this.emit('change');\n\n          _this.emit('field', field.field);\n\n          _this.emit('value', field.field, value);\n        }\n      },\n      setTouched: function setTouched(fieldId, touch) {\n        var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var field = _this.fieldsById.get(fieldId);\n\n        if (!field.shadow && field.fieldApi.getIsRelevant()) {\n          ObjectMap.set(_this.state.touched, field.field, field.fieldApi.getTouched());\n        } // Shadow values override unless undefined\n\n\n        if (field.shadow && field.fieldApi.getError() != undefined && field.fieldApi.relevant(_this.state.values)) {\n          ObjectMap.set(_this.state.touched, field.field, field.fieldApi.getTouched());\n        }\n\n        if (emit) {\n          _this.emit('change');\n\n          _this.emit('field', field.field); //this.emit('touch', field.field, touch);\n\n        }\n      },\n      setError: function setError(fieldId, error) {\n        var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var field = _this.fieldsById.get(fieldId);\n\n        if (!field.shadow && field.fieldApi.getIsRelevant()) {\n          ObjectMap.set(_this.state.errors, field.field, field.fieldApi.getError());\n        } // Shadow values override unless undefined\n\n\n        var currentError = ObjectMap.get(_this.state.errors, field.field);\n\n        if (field.shadow && field.fieldApi.getError() != undefined && field.fieldApi.relevant(_this.state.values)) {\n          ObjectMap.set(_this.state.errors, field.field, field.fieldApi.getError());\n        } // Special case for attempting to set shadow to undefiend\n        else if (field.shadow && field.fieldApi.getError() === undefined && field.fieldApi.relevant(_this.state.values) && // TODO maybe check if object or array\n          typeof currentError === 'string') {\n            ObjectMap.set(_this.state.errors, field.field, field.fieldApi.getError());\n          }\n\n        if (emit) {\n          _this.emit('change');\n\n          _this.emit('field', field.field); //this.emit('error', field.field, error);\n\n        }\n      },\n      expectRemoval: this.expectRemoval,\n      getInitialValue: this.getInitialValue,\n      getSavedValue: this.getSavedValue\n    }; // Define the formApi\n\n    this.formApi = {\n      setValue: this.setValue,\n      setTouched: this.setTouched,\n      setError: this.setError,\n      setFormError: this.setFormError,\n      setValues: this.setValues,\n      setInitialValue: this.setInitialValue,\n      getValue: this.getValue,\n      getTouched: this.getTouched,\n      getError: this.getError,\n      reset: this.reset,\n      submitForm: this.submitForm,\n      getState: this.getFormState,\n      getValues: this.getValues,\n      getFullField: this.getFullField,\n      fieldExists: this.fieldExists,\n      getInitialValue: this.getInitialValue,\n      validate: this.validate,\n      validateField: this.validateField,\n      screenValid: this.screenValid,\n      resetField: this.resetField,\n      getOptions: this.getOptions,\n      emitter: this,\n      getSavedValue: this.getSavedValue,\n      removeSavedState: this.removeSavedState,\n      getDerrivedValue: this.getDerrivedValue,\n      getStep: this.getStep,\n      setStep: this.setStep,\n      next: this.next,\n      back: this.back,\n      setCurrent: this.setCurrent,\n      validated: this.validated,\n      validating: this.validating,\n      getDirty: this.getDirty,\n      getPristine: this.getPristine,\n      getField: this.getField\n    };\n    this.on('value', function (field) {\n      // The forms values have changed so we want to clear form level error\n      delete _this.state.error;\n\n      _this.notify(field);\n    });\n  }\n  /* -------------------------------- Event Emitter ------------------------------ */\n\n\n  _createClass(FormController, [{\n    key: \"emit\",\n    value: function emit(event) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      } // Grab the set based on the event\n\n\n      var listeners = this.subscriptions.get(event); // Only call if we have listeners on that event ( null check )\n\n      if (listeners) {\n        listeners.forEach(function (listener) {\n          return listener.apply(void 0, args);\n        });\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, listener) {\n      // Singleton check\n      if (!this.subscriptions.get(event)) {\n        this.subscriptions.set(event, new Set());\n      } // Add listener\n\n\n      var listeners = this.subscriptions.get(event);\n      listeners.add(listener);\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(event, listener) {\n      // Remove listener\n      var listeners = this.subscriptions.get(event);\n      listeners[\"delete\"](listener);\n    }\n    /* ---------------------------------- Setters ---------------------------------- */\n\n  }, {\n    key: \"setOptions\",\n    value: function setOptions(options) {\n      this.options = options;\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(name, value, options) {\n      this.getField(name).fieldApi.setValue(value, null, _objectSpread2({\n        allowEmptyString: this.options.allowEmptyStrings\n      }, options));\n    }\n  }, {\n    key: \"setTouched\",\n    value: function setTouched(name, value) {\n      this.getField(name).fieldApi.setTouched(value);\n    }\n  }, {\n    key: \"setError\",\n    value: function setError(name, value) {\n      this.getField(name).fieldApi.setError(value);\n    }\n  }, {\n    key: \"setFormError\",\n    value: function setFormError(value) {\n      this.state.error = value;\n      this.emit('change');\n    }\n  }, {\n    key: \"validating\",\n    value: function validating() {\n      this.state.validating = this.state.validating + 1;\n      this.emit('change');\n    }\n  }, {\n    key: \"validated\",\n    value: function validated(name, error) {\n      // Decrement the validating\n      this.state.validating = this.state.validating - 1; // Set the error if there is not already one ( sync error first )\n\n      if (!this.getError(name)) {\n        this.setError(name, error);\n      } // If we are not still validating, and we were submitting, then submit form\n      // If we are async validating then dont submit yet\n\n\n      if (this.state.validating > 0) {\n        this.emit('change');\n        return;\n      } // If we were submitting\n\n\n      if (this.state.submitting) {\n        // Check validity and perform submission if valid\n        if (this.valid()) {\n          debug$2('Submit', this.state);\n          this.emit('submit');\n        } else {\n          debug$2('Submit', this.state);\n          this.emit('failure');\n        }\n\n        this.state.submitting = false;\n      }\n\n      this.emit('change');\n    }\n  }, {\n    key: \"setStep\",\n    value: function setStep(value) {\n      this.state.step = value;\n      this.emit('change');\n    }\n  }, {\n    key: \"setCurrent\",\n    value: function setCurrent(component) {\n      this.state.Current = component;\n      this.emit('change');\n    }\n  }, {\n    key: \"back\",\n    value: function back(prevComponent) {\n      this.state.step = this.state.step - 1;\n      this.state.Current = prevComponent;\n      this.emit('change');\n    }\n  }, {\n    key: \"next\",\n    value: function next(nextComponent) {\n      // Validate the entire form\n      this.validate(); // If fields on the screen ( currently rendered ) are valid move on\n\n      if (this.screenValid()) {\n        this.state.step = this.state.step + 1;\n        this.state.Current = nextComponent;\n      } // State will have changed\n\n\n      this.emit('change');\n    }\n  }, {\n    key: \"setInitialValue\",\n    value: function setInitialValue(field, value) {\n      ObjectMap.set(this.options.initialValues, field, value);\n    }\n    /* ---------------------------------- Getters ---------------------------------- */\n\n    /**\n     * Generate the external form state that will be exposed to the users\n     *\n     * @returns Form State\n     */\n\n  }, {\n    key: \"getFormState\",\n    value: function getFormState() {\n      debug$2('Returning form state');\n      return _objectSpread2(_objectSpread2({}, this.state), {}, {\n        pristine: this.pristine(),\n        dirty: this.dirty(),\n        invalid: this.invalid()\n      });\n    }\n  }, {\n    key: \"getFormApi\",\n    value: function getFormApi() {\n      return this.formApi;\n    }\n  }, {\n    key: \"getDerrivedValue\",\n    value: function getDerrivedValue(name) {\n      var values = this.getValues();\n      return ObjectMap.get(values, name);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(name) {\n      var value = this.getField(name).fieldApi.getValue();\n      debug$2('Getting value for', name, value);\n      return value;\n    }\n  }, {\n    key: \"getTouched\",\n    value: function getTouched(field) {\n      var touched = this.getField(field).fieldApi.getTouched();\n      debug$2('Getting touched for', field, touched);\n      return touched;\n    }\n  }, {\n    key: \"getError\",\n    value: function getError(field) {\n      var error = this.getField(field).fieldApi.getError();\n      debug$2('Getting error for', field, error);\n      return error;\n    }\n  }, {\n    key: \"getDirty\",\n    value: function getDirty(field) {\n      var dirty = this.getField(field).fieldApi.getDirty();\n      debug$2('Getting dirty for', field, dirty);\n      return dirty;\n    }\n  }, {\n    key: \"getPristine\",\n    value: function getPristine(field) {\n      var pristine = this.getField(field).fieldApi.getPristine();\n      debug$2('Getting pristine for', field, pristine);\n      return pristine;\n    }\n  }, {\n    key: \"getValues\",\n    value: function getValues() {\n      debug$2('Gettings values');\n      return this.state.values;\n    }\n  }, {\n    key: \"getAllTouched\",\n    value: function getAllTouched() {\n      debug$2('Gettings touched');\n      return this.state.touched;\n    }\n  }, {\n    key: \"getErrors\",\n    value: function getErrors() {\n      debug$2('Gettings errors');\n      return this.state.errors;\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      return this.options;\n    }\n  }, {\n    key: \"getStep\",\n    value: function getStep() {\n      return this.state.step;\n    }\n  }, {\n    key: \"getSavedValue\",\n    value: function getSavedValue(name) {\n      var field = this.fieldsByName.get(name);\n\n      if (field && field.shadow) {\n        return ObjectMap.get(this.savedValues, \"shadow-\".concat(name));\n      }\n\n      return ObjectMap.get(this.savedValues, name);\n    }\n  }, {\n    key: \"removeSavedState\",\n    value: function removeSavedState(name) {\n      var field = this.fieldsByName.get(name);\n\n      if (field && field.shadow) {\n        return ObjectMap[\"delete\"](this.savedValues, \"shadow-\".concat(name));\n      }\n\n      return ObjectMap[\"delete\"](this.savedValues, name);\n    }\n  }, {\n    key: \"getFullField\",\n    value: function getFullField(field) {\n      return field;\n    }\n  }, {\n    key: \"getInitialValue\",\n    value: function getInitialValue(field) {\n      return ObjectMap.get(this.options.initialValues, field);\n    }\n  }, {\n    key: \"getField\",\n    value: function getField(name) {\n      debug$2('Getting Field', name);\n      var field = this.fieldsByName.get(name);\n\n      if (!field) {\n        // eslint-disable-next-line no-console\n        console.warn(\"Attempting to get field \".concat(name, \" but it does not exist\")); // Prevent app from crashing\n\n        return this.dummyField;\n      }\n\n      return field;\n    } // Notify other fields\n\n  }, {\n    key: \"notify\",\n    value: function notify(field) {\n      var _this2 = this; // Example field - siblings[0].married\n      // Get the notifier\n\n\n      var notifier = this.getField(field); // If we have a list we must notify each one\n\n      if (notifier && notifier.notify) {\n        // Example: ['spouse']\n        notifier.notify.forEach(function (fieldName) {\n          // Get the field toNotify\n          var JSPAN = \".\".concat(field);\n          var path = \"\".concat(JSPAN.replace(/(.*)[.[].*/, '$1'), \".\").concat(fieldName).slice(1); // console.log('PATH', path);\n          // Example path - siblings[0].spouse\n\n          var toNotify = _this2.getField(path);\n\n          if (toNotify) {\n            debug$2('Notifying', toNotify.field);\n            toNotify.fieldApi.validate();\n            toNotify.fieldApi.checkRelevant();\n          }\n        });\n      }\n    }\n  }, {\n    key: \"validateField\",\n    value: function validateField(field) {\n      this.getField(field).fieldApi.validate();\n    }\n  }, {\n    key: \"resetField\",\n    value: function resetField(field) {\n      this.getField(field).fieldApi.reset();\n    }\n  }, {\n    key: \"fieldExists\",\n    value: function fieldExists(field) {\n      return this.fieldsByName.get(field) != null;\n    }\n  }, {\n    key: \"valid\",\n    value: function valid() {\n      var errors = this.getErrors();\n      return !!(ObjectMap.empty(errors) && !this.state.error);\n    }\n  }, {\n    key: \"screenValid\",\n    value: function screenValid() {\n      // Return false if any of the fields on the screen are invalid\n      var error = Object.entries(this.onScreen).some(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            field = _ref2[1];\n\n        return field.fieldApi.getError();\n      });\n      return !error;\n    }\n  }, {\n    key: \"invalid\",\n    value: function invalid() {\n      var errors = this.getErrors();\n      return !!(!ObjectMap.empty(errors) || this.state.error);\n    }\n  }, {\n    key: \"pristine\",\n    value: function pristine() {\n      // We are pristine if all our fields are pristine\n      // const touched = this.getAllTouched();\n      // const values = this.getValues();\n      // return ObjectMap.empty(touched) && ObjectMap.empty(values);\n      var pristine = true;\n      this.fieldsById.forEach(function (field) {\n        if (!field.fieldApi.getPristine()) {\n          pristine = false;\n        }\n      });\n      return pristine;\n    }\n  }, {\n    key: \"dirty\",\n    value: function dirty() {\n      return !this.pristine();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      debug$2('Resetting'); // So because all fields controll themselves and, \"inform\", this controller\n      // of their changes, we need to literally itterate through all registered fields\n      // and reset them. Not a big deal but very important to remember that you cant simply\n      // reset this controllers state!\n\n      this.fieldsById.forEach(function (field) {\n        field.fieldApi.reset({\n          preventUpdate: true\n        });\n      });\n      this.emit('reset');\n      this.emit('change');\n    }\n  }, {\n    key: \"setValues\",\n    value: function setValues(values) {\n      debug$2('Setting values'); // So we because all fields controll themselves and, \"inform\", this controller\n      // of their changes, we need to literally itterate through all registered fields\n      // and set them. Not a big deal but very important to remember that you cant simply\n      // set this controllers state!\n\n      this.fieldsById.forEach(function (field) {\n        // Initialize the values if it needs to be\n        var value = ObjectMap.get(values, field.field);\n\n        if (value !== undefined) {\n          field.fieldApi.setValue(value, null, {\n            preventUpdate: true\n          });\n        }\n      });\n      this.emit('change');\n    }\n  }, {\n    key: \"validate\",\n    value: function validate() {\n      var _this3 = this;\n\n      debug$2('Validating all fields');\n      var values = this.getValues(); // Validate schema if needed\n\n      if (this.options.validationSchema) {\n        var errors = validateYupSchema(this.options.validationSchema, values); // So we because all fields controll themselves and, \"inform\", this controller\n        // of their changes, we need to literally itterate through all registered fields\n        // and set them. Not a big deal but very important to remember that you cant simply\n        // set this controllers state!\n\n        this.fieldsById.forEach(function (field) {\n          // Check to see if there is an error to set\n          // Note: we use has becuause value may be there but undefined\n          if (ObjectMap.has(errors, field.field)) {\n            var error = ObjectMap.get(errors, field.field); // If there is an error then set it\n\n            _this3.setError(field.field, error);\n          } else {\n            // If we are doing schema validation then we need to clear out any old errors\n            _this3.setError(field.field, undefined);\n          }\n        });\n      } // Validate AJV schema if needed\n\n\n      if (this.options.schema && this.options.ajv) {\n        var _errors = validateAjvSchema(this.ajvValidate, values); // So we because all fields controll themselves and, \"inform\", this controller\n        // of their changes, we need to literally itterate through all registered fields\n        // and set them. Not a big deal but very important to remember that you cant simply\n        // set this controllers state!\n\n\n        this.fieldsById.forEach(function (field) {\n          // Check to see if there is an error to set\n          // Note: we use has becuause value may be there but undefined\n          if (ObjectMap.has(_errors, field.field)) {\n            var error = ObjectMap.get(_errors, field.field); // If there is an error then set it\n\n            _this3.setError(field.field, error);\n          } else {\n            // If we are doing schema validation then we need to clear out any old errors\n            _this3.setError(field.field, undefined);\n          }\n        });\n      } // Itterate through and call validate on every field\n\n\n      this.fieldsById.forEach(function (field) {\n        field.fieldApi.validate(values); // Second param to prevent validation\n\n        field.fieldApi.setTouched(true, true);\n      }); // Call the form level validation if its present\n\n      if (this.options.validate) {\n        var res = this.options.validate(values);\n        this.setFormError(res);\n      } // Call the forms field level validation\n\n\n      if (this.options.validateFields) {\n        var _errors2 = this.options.validateFields(values); // So we because all fields controll themselves and, \"inform\", this controller\n        // of their changes, we need to literally itterate through all registered fields\n        // and set them. Not a big deal but very important to remember that you cant simply\n        // set this controllers state!\n\n\n        this.fieldsById.forEach(function (field) {\n          // Check to see if there is an error to set\n          // Note: we use has becuause value may be there but undefined\n          if (ObjectMap.has(_errors2, field.field)) {\n            var error = ObjectMap.get(_errors2, field.field); // If there is an error then set it\n\n            _this3.setError(field.field, error);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"asyncValidate\",\n    value: function asyncValidate() {\n      debug$2('Async Validating all fields');\n      var values = this.getValues(); // Itterate through and call validate on every field\n\n      this.fieldsById.forEach(function (field) {\n        field.fieldApi.asyncValidate(values);\n      });\n    }\n  }, {\n    key: \"keyDown\",\n    value: function keyDown(e) {\n      // If preventEnter then return\n      if (e.keyCode == 13 && this.options.preventEnter) {\n        e.preventDefault(e);\n        return false;\n      }\n    }\n  }, {\n    key: \"submitForm\",\n    value: function submitForm(e) {\n      // Incriment number of submit attempts\n      this.state.submits = this.state.submits + 1;\n      this.state.submitting = true;\n\n      if (!this.options.dontPreventDefault && e) {\n        // Prevent default browser form submission\n        e.preventDefault(e);\n      } // Validate the form\n\n\n      this.validate(); // Emit a change\n\n      this.emit('change'); // Trigger all async validations\n\n      this.asyncValidate(); // If we are async validating then dont submit yet\n\n      if (this.state.validating > 0) {\n        return;\n      } // Check validity and perform submission if valid\n\n\n      if (this.valid()) {\n        debug$2('Submit', this.state);\n        this.emit('submit');\n      } else {\n        debug$2('Submit', this.state);\n        this.emit('failure');\n      }\n\n      this.state.submitting = false;\n      this.emit('change');\n    }\n  }, {\n    key: \"mount\",\n    value: function mount() {\n      var _this4 = this;\n\n      this.fieldsById.forEach(function (value) {\n        _this4.emit('field', value.field);\n      });\n    }\n    /* ---------------- Updater Functions (used by fields) ---------------- */\n    // ADDED initialRender parameter because of react 16.13.0 warning that does not like\n    // setting initial value during first render\n\n  }, {\n    key: \"register\",\n    value: function register(id, field, initialRender) {\n      var name = field.field,\n          state = field.state;\n      debug$2('Register ID:', id, 'Name:', name, state, 'Initial', initialRender); // Example foo.bar.baz[3].baz >>>> foo.bar.baz[3]\n\n      var magicValue = name.slice(0, name.lastIndexOf('[') != -1 ? name.lastIndexOf(']') + 1 : name.length); // Field might be coming back after render remove old field\n\n      var alreadyRegistered;\n      this.fieldsById.forEach(function (value, key) {\n        if (value && value.field === name) {\n          alreadyRegistered = key;\n        }\n      });\n\n      if ( //!this.expectedRemovals[magicValue] &&\n      alreadyRegistered && (field.keepState || field.inMultistep)) {\n        debug$2('Already Registered', name);\n        this.fieldsById[\"delete\"](alreadyRegistered);\n      } else if ( //!this.expectedRemovals[magicValue] &&\n      alreadyRegistered && (!field.keepState || !field.inMultistep)) {\n        // eslint-disable-next-line no-console\n        console.warn('Check to make sure you have not registered two fields with the fieldName', name);\n      }\n\n      debug$2('Fields Registered', this.fieldsById.size); // The field is on the screen\n\n      this.onScreen[id] = field; // Always register the field\n\n      this.fieldsById.set(id, field); // Always clear out expected removals when a reregistering array field comes in\n\n      debug$2('clearing expected removal', magicValue);\n      delete this.expectedRemovals[magicValue];\n      delete this.pulledOut[magicValue]; // The field is a shadow field ooo spooky so dont set anything\n\n      if (field.shadow) {\n        return;\n      } // Update the forms state right away\n\n\n      this.updater.setValue(id, field.fieldApi.getValue(), false);\n      this.updater.setError(id, field.fieldApi.getError(), false);\n      this.updater.setTouched(id, field.fieldApi.getTouched(), false); // We register field right away but dont want it to triger a rerender\n\n      if (!initialRender) {\n        this.emit('change');\n      }\n\n      this.emit('field', name);\n    }\n  }, {\n    key: \"deregister\",\n    value: function deregister(id) {\n      var field = this.fieldsById.get(id);\n      var name = field.field;\n      debug$2('Deregister', id, name); // The field is off the screen\n\n      delete this.onScreen[id]; // Example foo.bar.baz[3] --> foo.bar.baz[3].baz && foo.bar.baz[3].taz.raz[4].naz\n\n      var expectedRemoval = isExpected(name, this.expectedRemovals); // Example foo.bar.baz[3].baz >>>> foo.bar.baz[3]\n\n      var magicValue = name.slice(0, name.lastIndexOf('[') != -1 ? name.lastIndexOf(']') + 1 : name.length); // If the fields state is to be kept then save the value\n\n      if ( // We are in a multistep or want to keep the state\n      (field.keepState || field.inMultistep) && // We are NOT expected to be removed\n      !expectedRemoval) {\n        // TODO ?? Exception where the field is irrelivant AND keep state was not passed ??\n        debug$2(\"Saving field \".concat(name, \"'s value\"), field.fieldApi.getFieldState());\n\n        if (!field.shadow) {\n          ObjectMap.set(this.savedValues, name, field.fieldApi.getFieldState());\n        } else {\n          // We are shadow field and will store this value in the shadows\n          ObjectMap.set(this.savedValues, \"shadow-\".concat(name), field.fieldApi.getFieldState());\n        }\n      } // Remove if its an expected removal OR we dont have keep state\n\n\n      if ( // This field was expected to be removed\n      expectedRemoval || // This field does not have keepstate and is NOT within a multistep\n      !field.keepState && !field.inMultistep || // If field is in multistep then we would always keep due to field.inMultistep\n      // BUT.. we need to also check if the field is irrelivant\n      // because if it gets unmounted, even if its part of a multistep, we want to remove\n      // the field completley, unless keep state was passed.\n      !field.fieldApi.getIsRelevant() && !field.keepState) {\n        // Remove the field completley\n        debug$2('Removing field', name);\n        this.fieldsById[\"delete\"](id); // Clean up state only if its not expected removal, otherwise we will just pull it out\n\n        if (!expectedRemoval) {\n          ObjectMap[\"delete\"](this.state.values, name);\n          ObjectMap[\"delete\"](this.state.touched, name);\n          ObjectMap[\"delete\"](this.state.errors, name);\n\n          if (!field.shadow) {\n            ObjectMap[\"delete\"](this.savedValues, name);\n          } else {\n            ObjectMap[\"delete\"](this.savedValues, \"shadow-\".concat(name));\n          }\n        } // If we expected this removal then pullOut\n\n\n        if (expectedRemoval && this.pulledOut[magicValue]) {\n          debug$2('Pulling out', name, 'with magic value', magicValue);\n          ObjectMap.pullOut(this.state.values, magicValue);\n          ObjectMap.pullOut(this.state.touched, magicValue);\n          ObjectMap.pullOut(this.state.errors, magicValue);\n          ObjectMap.pullOut(this.savedValues, magicValue); // console.log('Pull1', this.state.values);\n          // console.log('Pull2', this.savedValues);\n\n          delete this.pulledOut[magicValue];\n        }\n      }\n\n      this.emit('change');\n    }\n  }, {\n    key: \"expectRemoval\",\n    value: function expectRemoval(name) {\n      debug$2('Expecting removal of', name);\n      this.expectedRemovals[name] = true;\n      this.pulledOut[name] = true;\n    }\n  }, {\n    key: \"update\",\n    value: function update(id, field, oldName) {\n      debug$2('Update', id, field.field, oldName, field.fieldState.value); // Update the error touched and values of this field\n\n      var value = field.fieldApi.getValue();\n      var error = field.fieldApi.getError();\n      var t = field.fieldApi.getTouched(); // Clear the old value out\n\n      var oldField = this.fieldsByName.get(oldName); // Only clear if we had an old name ( our name changed )\n      // %% the oldField is gone!\n\n      if (oldName && !oldField) {\n        // Setting nothing sets to undefined and does NOT pull out\n        ObjectMap.set(this.state.values, oldName);\n        ObjectMap.set(this.state.errors, oldName);\n        ObjectMap.set(this.state.touched, oldName);\n      } // Set the value\n\n\n      ObjectMap.set(this.state.values, field.field, value);\n      ObjectMap.set(this.state.errors, field.field, error);\n      ObjectMap.set(this.state.touched, field.field, t);\n      this.emit('change');\n    }\n  }]);\n\n  return FormController;\n}();\n\nvar logger$5 = debug('informed:FormProvider' + '\\t\\t');\n\nvar FormProvider = function FormProvider(_ref) {\n  var children = _ref.children,\n      formApi = _ref.formApi,\n      formController = _ref.formController,\n      formState = _ref.formState,\n      rest = _objectWithoutProperties(_ref, [\"children\", \"formApi\", \"formController\", \"formState\"]);\n\n  logger$5('Render FormProvider');\n\n  if (formApi) {\n    logger$5('Render FormProvider with given values');\n    /* --- Create Provider with given values and render Content --- */\n\n    return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n      value: formController.updater\n    }, /*#__PURE__*/React.createElement(FormApiContext.Provider, {\n      value: formApi\n    }, /*#__PURE__*/React.createElement(FormStateContext.Provider, {\n      value: formState\n    }, children)));\n  }\n\n  logger$5('Render FormProvider with generated values');\n  /* --- User did not pass values so create them --- */\n\n  var value = useForm(rest);\n  return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n    value: value.formController.updater\n  }, /*#__PURE__*/React.createElement(FormApiContext.Provider, {\n    value: value.formApi\n  }, /*#__PURE__*/React.createElement(FormStateContext.Provider, {\n    value: value.formState\n  }, children)));\n};\n\nvar logger$6 = debug('informed:useForm' + '\\t\\t');\n\nvar useForm = function useForm(_ref) {\n  var dontPreventDefault = _ref.dontPreventDefault,\n      initialValues = _ref.initialValues,\n      validate = _ref.validate,\n      validateFields = _ref.validateFields,\n      allowEmptyStrings = _ref.allowEmptyStrings,\n      preventEnter = _ref.preventEnter,\n      getApi = _ref.getApi,\n      apiRef = _ref.apiRef,\n      onChange = _ref.onChange,\n      onReset = _ref.onReset,\n      onSubmit = _ref.onSubmit,\n      onValueChange = _ref.onValueChange,\n      onSubmitFailure = _ref.onSubmitFailure,\n      validationSchema = _ref.validationSchema,\n      schema = _ref.schema,\n      ajv = _ref.ajv,\n      fieldMap = _ref.fieldMap,\n      onlyValidateSchema = _ref.onlyValidateSchema,\n      userProps = _objectWithoutProperties(_ref, [\"dontPreventDefault\", \"initialValues\", \"validate\", \"validateFields\", \"allowEmptyStrings\", \"preventEnter\", \"getApi\", \"apiRef\", \"onChange\", \"onReset\", \"onSubmit\", \"onValueChange\", \"onSubmitFailure\", \"validationSchema\", \"schema\", \"ajv\", \"fieldMap\", \"onlyValidateSchema\"]);\n\n  logger$6('Render useForm'); // Generate form controller options\n\n  var formControllerOptions = useMemo(function () {\n    return {\n      dontPreventDefault: dontPreventDefault,\n      initialValues: initialValues,\n      validate: validate,\n      validateFields: validateFields,\n      allowEmptyStrings: allowEmptyStrings,\n      preventEnter: preventEnter,\n      validationSchema: validationSchema,\n      schema: schema,\n      ajv: ajv,\n      fieldMap: fieldMap\n    };\n  }, [dontPreventDefault, initialValues, validate, validateFields, allowEmptyStrings, preventEnter, validationSchema, schema, ajv, fieldMap]); // Create form controller\n\n  var _useState = useState(function () {\n    return new FormController(formControllerOptions);\n  }),\n      _useState2 = _slicedToArray(_useState, 1),\n      formController = _useState2[0]; // Update the options when they change\n\n\n  useEffect(function () {\n    formController.setOptions(formControllerOptions);\n  }, [formControllerOptions]);\n  useIsomorphicLayoutEffect(function () {\n    formController.mount();\n  }, []); // Form state will be used to trigger rerenders\n\n  var _useState3 = useState(function () {\n    return formController.getFormState();\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      formState = _useState4[0],\n      setFormState = _useState4[1]; // Register for events\n\n\n  useIsomorphicLayoutEffect(function () {\n    var onChangeHandler = function onChangeHandler() {\n      return onChange && onChange(formController.getFormState());\n    };\n\n    var onResetHandler = function onResetHandler() {\n      return onReset && onReset();\n    };\n\n    var onSubmitHandler = function onSubmitHandler() {\n      return onSubmit && onSubmit(formController.getFormState().values);\n    };\n\n    var onValueHandler = function onValueHandler() {\n      return onValueChange && onValueChange(formController.getFormState().values);\n    };\n\n    var onFailureHandler = function onFailureHandler() {\n      return onSubmitFailure && onSubmitFailure(formController.getFormState().errors);\n    }; // Register for events\n\n\n    formController.on('change', onChangeHandler);\n    formController.on('reset', onResetHandler);\n    formController.on('submit', onSubmitHandler);\n    formController.on('value', onValueHandler);\n    formController.on('failure', onFailureHandler); // Unregister events\n\n    return function () {\n      formController.removeListener('change', onChangeHandler);\n      formController.removeListener('reset', onResetHandler);\n      formController.removeListener('submit', onSubmitHandler);\n      formController.removeListener('value', onValueHandler);\n      formController.removeListener('failure', onFailureHandler);\n    };\n  }, [onChange, onReset, onSubmit, onValueChange, onSubmitFailure]); // Initialize code like constructor but not muhahah\n\n  useState(function () {\n    // Update the form state to trigger rerender!\n    var onChangeHandlerRerender = function onChangeHandlerRerender() {\n      logger$6('Setting form state');\n      setFormState(formController.getFormState());\n    }; // const debounced = debounce(onChangeHandlerRerender, 250);\n\n\n    formController.on('change', onChangeHandlerRerender); // Give access to api outside\n\n    if (getApi) {\n      getApi(formController.getFormApi());\n    }\n\n    if (apiRef) {\n      apiRef.current = formController.getFormApi();\n    }\n  }); // We dont want this to happen on every render so thats why useState is used here\n\n  var _useState5 = useState(function () {\n    return formController.getFormApi();\n  }),\n      _useState6 = _slicedToArray(_useState5, 1),\n      formApi = _useState6[0]; // TODO technically speaking this can be unsafe as there is circular dependency\n  // between form provider and useForm.. Its ok because anyone that in theory\n  // Uses a form provider and a use form hook themselves will never call the render\n  // function created here... that being said I will look into fixing that warning\n  // at some point :)\n\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(FormProvider, {\n      formApi: formApi,\n      formState: formState,\n      formController: formController\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, !children ? /*#__PURE__*/React.createElement(FormFields, {\n      schema: schema,\n      onlyValidateSchema: onlyValidateSchema\n    }) : children));\n  };\n\n  return {\n    formApi: formApi,\n    formState: formState,\n    formController: formController,\n    render: render,\n    userProps: userProps\n  };\n};\n\nvar debug$3 = debug('informed:Form' + '\\t\\t');\n\nvar Form = function Form(_ref) {\n  var children = _ref.children,\n      renderProp = _ref.render,\n      component = _ref.component,\n      rest = _objectWithoutProperties(_ref, [\"children\", \"render\", \"component\"]);\n\n  debug$3('Render FORM');\n\n  var _useForm = useForm(rest),\n      formApi = _useForm.formApi,\n      formController = _useForm.formController,\n      formState = _useForm.formState,\n      render = _useForm.render,\n      userProps = _useForm.userProps;\n\n  var getContent = function getContent() {\n    var props = {\n      formState: formState,\n      formApi: formApi\n    };\n\n    if (component) {\n      return /*#__PURE__*/React.createElement(component, props, children);\n    }\n\n    if (renderProp) {\n      return renderProp(props);\n    }\n\n    if (typeof children === 'function') {\n      return children(props);\n    }\n\n    return children;\n  };\n  /* --- Render Content --- */\n\n\n  return render( /*#__PURE__*/React.createElement(\"form\", _extends({}, userProps, {\n    onReset: formController.reset,\n    onSubmit: formController.submitForm,\n    onKeyDown: formController.keyDown\n  }), getContent()));\n};\n\nvar buildScopedFormApi$1 = function buildScopedFormApi(scope, formApi) {\n  return _objectSpread2(_objectSpread2({}, formApi), {}, {\n    getValue: function getValue(field) {\n      return formApi.getValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getTouched: function getTouched(field) {\n      return formApi.getTouched(\"\".concat(scope, \".\").concat(field));\n    },\n    getError: function getError(field) {\n      return formApi.getError(\"\".concat(scope, \".\").concat(field));\n    },\n    setValue: function setValue(field, value) {\n      return formApi.setValue(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setTouched: function setTouched(field, value) {\n      return formApi.setTouched(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setError: function setError(field, value) {\n      return formApi.setError(\"\".concat(scope, \".\").concat(field), value);\n    },\n    getInitialValue: function getInitialValue(field) {\n      return formApi.getInitialValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getFullField: function getFullField(field) {\n      return \"\".concat(formApi.getFullField(scope), \".\").concat(field);\n    }\n  });\n};\n\nvar buildScopedRegister = function buildScopedRegister(scope, formRegister) {\n  var _register = formRegister.register,\n      _deregister = formRegister.deregister,\n      _setValue = formRegister.setValue,\n      _setTouched = formRegister.setTouched,\n      _setError = formRegister.setError,\n      _update = formRegister.update,\n      _getField = formRegister.getField,\n      _expectRemoval = formRegister.expectRemoval,\n      _getInitialValue = formRegister.getInitialValue,\n      fieldMap = formRegister.fieldMap,\n      _getSavedValue = formRegister.getSavedValue;\n  return {\n    register: function register(field) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return _register.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    deregister: function deregister(field) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      return _deregister.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    update: function update(field) {\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n\n      return _update.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    setValue: function setValue(field) {\n      for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        args[_key4 - 1] = arguments[_key4];\n      }\n\n      return _setValue.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    setTouched: function setTouched(field) {\n      for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n        args[_key5 - 1] = arguments[_key5];\n      }\n\n      return _setTouched.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    setError: function setError(field) {\n      for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n        args[_key6 - 1] = arguments[_key6];\n      }\n\n      return _setError.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    getField: function getField(field) {\n      for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {\n        args[_key7 - 1] = arguments[_key7];\n      }\n\n      return _getField.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    expectRemoval: function expectRemoval(field) {\n      for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n        args[_key8 - 1] = arguments[_key8];\n      }\n\n      return _expectRemoval.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    getInitialValue: function getInitialValue(field) {\n      return _getInitialValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getSavedValue: function getSavedValue(field) {\n      return _getSavedValue(\"\".concat(scope, \".\").concat(field));\n    },\n    fieldMap: fieldMap\n  };\n};\n\nvar Scope = function Scope(_ref) {\n  var scope = _ref.scope,\n      children = _ref.children;\n  var formRegister = useContext(FormRegisterContext);\n  var formApi = useFormApi();\n  var formState = useFormState(); // VERY important to memoize the builders!\n\n  var scopedFormApi = useMemo(function () {\n    return buildScopedFormApi$1(scope, formApi);\n  }, [scope]);\n  var scopedRegister = useMemo(function () {\n    return buildScopedRegister(scope, formRegister);\n  }, [scope]);\n  return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n    value: scopedRegister\n  }, /*#__PURE__*/React.createElement(FormApiContext.Provider, {\n    value: scopedFormApi\n  }, /*#__PURE__*/React.createElement(FormStateContext.Provider, {\n    value: formState\n  }, children)));\n};\n\nvar FormState = function FormState(props) {\n  var formState = useFormState();\n  var displayState = {};\n\n  if (Object.keys(props).length > 0) {\n    Object.keys(props).forEach(function (key) {\n      displayState[key] = formState[key];\n    });\n  } else {\n    displayState = formState;\n  }\n\n  var _displayState = displayState,\n      pristine = _displayState.pristine,\n      dirty = _displayState.dirty,\n      invalid = _displayState.invalid,\n      values = _displayState.values,\n      errors = _displayState.errors,\n      touched = _displayState.touched,\n      validating = _displayState.validating,\n      submitting = _displayState.submitting;\n  return /*#__PURE__*/React.createElement(\"pre\", null, /*#__PURE__*/React.createElement(\"code\", null, JSON.stringify({\n    pristine: pristine,\n    dirty: dirty,\n    invalid: invalid,\n    values: values,\n    errors: errors,\n    touched: touched,\n    validating: validating,\n    submitting: submitting\n  }, null, 2)));\n};\n\nvar useMultistep = function useMultistep(_ref) {\n  var initialStep = _ref.initialStep,\n      multistepApiRef = _ref.multistepApiRef; // Get the formApi\n\n  var _useFormApi = useFormApi(),\n      getValues = _useFormApi.getValues,\n      validate = _useFormApi.validate,\n      screenValid = _useFormApi.screenValid; // Track our steps by name\n\n\n  var _useState = useState(new Map()),\n      _useState2 = _slicedToArray(_useState, 1),\n      stepsByName = _useState2[0]; // Track number of steps\n\n\n  var nSteps = useRef(0); // Define our state\n\n  var _useStateWithGetter = useStateWithGetter({\n    current: initialStep,\n    steps: [],\n    goal: null\n  }),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      multistepState = _useStateWithGetter2[0],\n      setMultistepState = _useStateWithGetter2[1],\n      getMultistepState = _useStateWithGetter2[2]; // Define our api\n\n\n  var _useState3 = useState(function () {\n    var getCurrentStep = function getCurrentStep() {\n      // Get the current state\n      var _getMultistepState = getMultistepState(),\n          current = _getMultistepState.current; // Get the current step\n\n\n      var currentStep = stepsByName.get(current); // Return it\n\n      return currentStep;\n    };\n\n    var api = {\n      // Gets the whole state\n      getState: function getState() {\n        return getMultistepState();\n      },\n      // Gets just the current\n      getCurrentStep: getCurrentStep,\n      // Gets that step\n      getStep: function getStep(name) {\n        return stepsByName.get(name);\n      },\n      // gets the current number of steps\n      getNumberOfSteps: function getNumberOfSteps() {\n        return stepsByName.size;\n      },\n      // Goes to next step\n      next: function next() {\n        // Validate the entire form\n        validate(); // If fields on the screen ( currently rendered ) are valid move on\n\n        if (screenValid()) {\n          // Get the current step\n          var _getCurrentStep = getCurrentStep(),\n              getNext = _getCurrentStep.getNext;\n\n          var next = getNext(); // Determine what the next step should be\n\n          var nextStep = typeof next === 'function' ? next(getValues()) : next; // Determine if it has a next\n\n          if (nextStep) {\n            setMultistepState(function (prev) {\n              return _objectSpread2(_objectSpread2({}, prev), {}, {\n                current: nextStep\n              });\n            });\n          }\n        }\n      },\n      // Goes to previous step\n      back: function back() {\n        // Get the current step\n        var _getCurrentStep2 = getCurrentStep(),\n            getPrevious = _getCurrentStep2.getPrevious;\n\n        var previous = getPrevious(); // Determine what the previous step should be\n\n        var previousStep = typeof previous === 'function' ? previous(getValues()) : previous; // Determine if it has a previous\n\n        if (previousStep) {\n          setMultistepState(function (prev) {\n            return _objectSpread2(_objectSpread2({}, prev), {}, {\n              current: previousStep\n            });\n          });\n        }\n      },\n      // Goes to specified step\n      setCurrent: function setCurrent(stp) {\n        if (stp) {\n          var goalIndex = stepsByName.get(stp).index; // console.log(\n          //   'GOAL INDEX',\n          //   goalIndex,\n          //   'STPINDEX',\n          //   getCurrentStep().index\n          // );\n\n          if (goalIndex < getCurrentStep().index) {\n            setMultistepState(function (prev) {\n              return _objectSpread2(_objectSpread2({}, prev), {}, {\n                current: stp,\n                goal: null\n              });\n            });\n          } else {\n            setMultistepState(function (prev) {\n              return _objectSpread2(_objectSpread2({}, prev), {}, {\n                // current: stp,\n                goal: stp\n              });\n            });\n          }\n        }\n      },\n      // Registers the step\n      register: function register(name, step, initial) {\n        if (initial) {\n          nSteps.current = nSteps.current + 1;\n          stepsByName.set(name, _objectSpread2(_objectSpread2({}, step), {}, {\n            index: nSteps.current\n          }));\n        } else {\n          setMultistepState(function (prev) {\n            return _objectSpread2(_objectSpread2({}, prev), {}, {\n              steps: Array.from(stepsByName.keys())\n            });\n          });\n        }\n      },\n      // Deregisters the step\n      deregister: function deregister(name) {\n        stepsByName[\"delete\"](name);\n        nSteps.current = nSteps.current - 1;\n        setMultistepState(function (prev) {\n          return _objectSpread2(_objectSpread2({}, prev), {}, {\n            steps: Array.from(stepsByName.keys())\n          });\n        });\n      }\n    };\n\n    if (multistepApiRef) {\n      multistepApiRef.current = api;\n    }\n\n    return api;\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      multistepApi = _useState4[0]; // Render funtion that will provide state and api\n\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(MultistepApiContext.Provider, {\n      value: multistepApi\n    }, /*#__PURE__*/React.createElement(MultistepStateContext.Provider, {\n      value: multistepState\n    }, children));\n  };\n\n  return _objectSpread2(_objectSpread2(_objectSpread2({}, multistepApi), multistepState), {}, {\n    render: render\n  });\n};\n\nfunction useMultistepState() {\n  return useContext(MultistepStateContext);\n}\n\nfunction useMultistepApi() {\n  return useContext(MultistepApiContext);\n}\n\nvar useMultistepStep = function useMultistepStep(_ref) {\n  var step = _ref.step,\n      next = _ref.next,\n      previous = _ref.previous,\n      relevant = _ref.relevant;\n\n  var _useFormState = useFormState(),\n      values = _useFormState.values;\n\n  var _useMultistepState = useMultistepState(),\n      current = _useMultistepState.current,\n      goal = _useMultistepState.goal;\n\n  var _useMultistepApi = useMultistepApi(),\n      register = _useMultistepApi.register,\n      deregister = _useMultistepApi.deregister,\n      goToNext = _useMultistepApi.next;\n\n  var isCurrent = step === current;\n  var isRelevant = relevant ? relevant(values) : true;\n  var nextRef = useRef(next);\n  var prevRef = useRef(previous);\n  var relevantRef = useRef();\n  nextRef.current = next;\n  prevRef.current = previous;\n  relevantRef.current = relevant;\n  useState(function () {\n    register(step, {\n      name: step,\n      getNext: function getNext() {\n        return nextRef.current;\n      },\n      getPrevious: function getPrevious() {\n        return prevRef.current;\n      }\n    }, true);\n  });\n  useEffect(function () {\n    register(step, {\n      name: step,\n      getNext: function getNext() {\n        return nextRef.current;\n      },\n      getPrevious: function getPrevious() {\n        return prevRef.current;\n      }\n    });\n    return function () {\n      deregister(step);\n    };\n  }, [step]);\n  useEffect(function () {\n    // if we are NOT at the goal go to the next step\n    if (goal && isCurrent && goal !== step) {\n      // console.log('GOAL', goal, 'STEP', step, 'INDEX', getStep(step).index);\n      // console.log('GOING TO NEXT STEP');\n      goToNext();\n    }\n  }, [goal, isCurrent]);\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(MultistepStepContext.Provider, {\n      value: {\n        relevant: function relevant(params) {\n          return relevantRef.current ? relevantRef.current(params) : true;\n        },\n        multistep: true\n      }\n    }, isCurrent && isRelevant ? children : null);\n  };\n\n  return {\n    isCurrent: isCurrent,\n    isRelevant: isRelevant,\n    step: step,\n    render: render\n  };\n};\n\nfunction Multistep(_ref) {\n  var children = _ref.children,\n      props = _objectWithoutProperties(_ref, [\"children\"]);\n\n  var _useMultistep = useMultistep(props),\n      render = _useMultistep.render,\n      context = _objectWithoutProperties(_useMultistep, [\"render\"]);\n\n  if (typeof children === 'function') {\n    return render(children(context));\n  }\n\n  return render(children);\n}\n\nMultistep.Step = function MultistepStep(_ref2) {\n  var children = _ref2.children,\n      props = _objectWithoutProperties(_ref2, [\"children\"]);\n\n  var _useMultistepStep = useMultistepStep(props),\n      render = _useMultistepStep.render;\n\n  return render(children);\n};\n\nvar FormField = function FormField(_ref) {\n  var field = _ref.field; // Get the field map off the forms context\n\n  var _useContext = useContext(FormRegisterContext),\n      fieldMap = _useContext.fieldMap; // Grab the form api ( we need it to get the actual field name because might be in scope )\n\n\n  var _useFormApi = useFormApi(),\n      getFullField = _useFormApi.getFullField,\n      getOptions = _useFormApi.getOptions; // Grab the full field\n\n\n  var fullField = getFullField(field); // Grap the schema\n\n  var _getOptions = getOptions(),\n      schema = _getOptions.schema; // First find property from the schema via the path to that field\n  // Examples\n  // field = \"name\" ---> properties.name\n  // field = \"brother.name\" ---> properties.brother.properties.name\n  // field = \"brother.siblings[1].friend.name\" ---> properties.brother.properties.siblings.items[1].properties.friend.properties.name\n\n\n  var path = getSchemaPathFromJsonPath(fullField);\n  var property = ObjectMap.get(schema, path); // If property was not found return null\n\n  if (!property) {\n    return null;\n  } // Next compute the field from property\n\n\n  var schemaField = computeFieldFromProperty(field, property);\n  var props = schemaField.props,\n      componentType = schemaField.componentType;\n  var Component = fieldMap[componentType];\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    field: field\n  }, props));\n};\n\nvar SchemaFields = function SchemaFields() {\n  var _useFormApi = useFormApi(),\n      getOptions = _useFormApi.getOptions; // Grap the schema\n\n\n  var _getOptions = getOptions(),\n      schema = _getOptions.schema;\n\n  return /*#__PURE__*/React.createElement(FormFields, {\n    schema: schema\n  });\n};\n\nvar withFormApi = function withFormApi(Component) {\n  return /*#__PURE__*/React.forwardRef(function (props, ref) {\n    return /*#__PURE__*/React.createElement(FormApiContext.Consumer, null, function (formApi) {\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        formApi: formApi,\n        ref: ref\n      }, props));\n    });\n  });\n};\n\nvar withFormState = function withFormState(Component) {\n  return /*#__PURE__*/React.forwardRef(function (props, ref) {\n    return /*#__PURE__*/React.createElement(FormStateContext.Consumer, null, function (formState) {\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        formState: formState,\n        ref: ref\n      }, props));\n    });\n  });\n}; // eslint-disable-next-line no-unused-vars\n\n\nvar buildFieldApi = function buildFieldApi(formApi, field) {\n  return {\n    // TODO refactor to use field api from updater.. need to make sure this\n    // will be stable\n    getValue: function getValue() {\n      return formApi.getValue(field);\n    },\n    setValue: function setValue(value) {\n      return formApi.setValue(field, value);\n    },\n    getTouched: function getTouched() {\n      return formApi.getTouched(field);\n    },\n    setTouched: function setTouched(value) {\n      return formApi.setTouched(field, value);\n    },\n    getError: function getError() {\n      return formApi.getError(field);\n    },\n    setError: function setError(value) {\n      return formApi.setError(field, value);\n    },\n    reset: function reset() {\n      return formApi.resetField(field);\n    },\n    validate: function validate() {\n      return formApi.validateField(field);\n    },\n    exists: function exists() {\n      return formApi.fieldExists(field);\n    },\n    getDirty: function getDirty() {\n      return formApi.getDirty(field);\n    },\n    getPristine: function getPristine() {\n      return formApi.getPristine(field);\n    },\n    getFieldState: function getFieldState() {\n      return formApi.getField(field).fieldApi.getFieldState();\n    }\n  };\n};\n\nfunction useFieldApi(field) {\n  var formApi = useFormApi();\n  var fieldApi = useMemo(function () {\n    return buildFieldApi(formApi, field);\n  }, [field]);\n  return fieldApi;\n}\n\nfunction useFieldState(name) {\n  var fieldApi = useFieldApi(name);\n  var formApi = useFormApi();\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      updateState = _React$useState2[1];\n\n  var forceUpdate = React.useCallback(function () {\n    return updateState({});\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    var listener = function listener(target) {\n      if (target === name) {\n        forceUpdate();\n      }\n    };\n\n    formApi.emitter.on('field', listener);\n    return function () {\n      formApi.emitter.removeListener('field', listener);\n    };\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    forceUpdate();\n  }, []); // useEffect(() => {\n  //   forceUpdate();\n  // }, []);\n\n  return fieldApi.getFieldState() || {};\n}\n\nvar withFieldState = function withFieldState(field) {\n  return function (Component) {\n    return function (props) {\n      var fieldState = useFieldState(field);\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        fieldState: fieldState\n      }, props));\n    };\n  };\n};\n\nvar withFieldApi = function withFieldApi(field) {\n  return function (Component) {\n    return function (props) {\n      var fieldApi = useFieldApi(field);\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        fieldApi: fieldApi\n      }, props));\n    };\n  };\n};\n\nvar Option = function Option(_ref) {\n  var value = _ref.value,\n      forwardedRef = _ref.forwardedRef,\n      children = _ref.children,\n      rest = _objectWithoutProperties(_ref, [\"value\", \"forwardedRef\", \"children\"]);\n\n  return /*#__PURE__*/React.createElement(\"option\", _extends({\n    ref: forwardedRef,\n    value: value,\n    key: value\n  }, rest), children);\n};\n\nvar Input = Text$1;\nexport { ArrayField, Checkbox as BasicCheckbox, Radio as BasicRadio, RadioGroup as BasicRadioGroup, Select as BasicSelect, Text as BasicText, TextArea as BasicTextArea, Checkbox$1 as Checkbox, Form, FormComponents, FormField, FormFields, FormProvider, FormState, Input, Multistep, Option, Radio$1 as Radio, RadioGroup$1 as RadioGroup, Relevant, SchemaFields, Scope, Select$1 as Select, Text$1 as Text, TextArea$1 as TextArea, asField, useArrayField, useArrayFieldApi, useArrayFieldItemApi, useCursorPosition, useField, useFieldApi, useFieldState, useForm, useFormApi, useFormState, useMultistepApi, useMultistepState, utils, withFieldApi, withFieldState, withFormApi, withFormState, withRadioGroup };","map":{"version":3,"sources":["C:/Users/Buddhisha Dharmarath/Desktop/fourthpushedequipmentcrud/node_modules/informed/dist/esm/index.js"],"names":["React","useContext","useRef","useState","useEffect","useLayoutEffect","useMemo","Component","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","_defineProperty","obj","value","_extends","assign","arguments","source","hasOwnProperty","call","apply","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","_objectSpread2","forEach","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","e","_objectWithoutPropertiesLoose","excluded","sourceKeys","indexOf","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","self","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","Symbol","iterator","from","_arr","_n","_d","_e","undefined","_i","_s","next","done","err","minLen","n","slice","name","test","len","arr2","_createForOfIteratorHelper","allowArrayLike","it","F","s","f","normalCompletion","didErr","step","return","createCommonjsModule","fn","module","exports","debug","selectColor","namespace","colors","hash","charCodeAt","Math","abs","formatNodeArgs","args","config","useColors","c","color","colorCode","prefix","concat","split","join","formatBrowserArgs","index","lastC","replace","match","splice","browserColors","loadBrowser","namespaces","localStorage","getItem","error","process","env","DEBUG","formatArgs","loadNode","createLogger","_len","_key","unshift","matches","map","RegExp","some","regex","conf","NODE_ENV","_console","console","log","nodeLogger","browserLogger","type","browser","__nwjs","debug$1","ldtoPath","path","String","Boolean","ldget","defaultValue","reduce","res","parentPath","pathKey","ldhas","pPath","parentObj","ldset","val","Number","isInteger","ldunset","found","ldpullAt","pulled","ldvalues","pathToArrayElem","pathArray","ObjectMap","empty","get","has","set","cleanup","_delete","pullOut","every","JSON","stringify","FormRegisterContext","createContext","register","deregister","setValue","setTouched","setError","update","getField","expectRemoval","getInitialValue","getSavedValue","FormStateContext","FormApiContext","getFullField","getValues","getOptions","setInitialValue","getDerrivedValue","removeSavedState","GroupContext","ArrayFieldStateContext","ArrayFieldApiContext","ArrayFieldItemApiContext","ArrayFieldItemStateContext","MultistepStateContext","MultistepApiContext","MultistepStepContext","useFormApi","formApi","useStateWithGetter","initial","ref","mounted","_useState","_useState2","state","setState","current","getChildDisplayName","WrappedComponent","displayName","yupToFormErrors","yupError","errors","inner","message","_iterator","_step","validateYupSchema","schema","values","validateSync","abortEarly","formErrors","yupToFormError","validateYupField","validateAjvSchema","validate","data","_ref","dataPath","keyword","params","missingProperty","uuidv4","r","random","v","debounce","func","wait","timeout","executedFunction","later","clearTimeout","setTimeout","computeFieldFromProperty","propertyName","property","uiControl","informedProps","inputProps","uiBefore","uiAfter","oneOf","items","schemaEnum","label","title","min","minimum","max","maximum","minLength","maxLength","pattern","subProperties","properties","id","field","componentType","options","option","_option$inputProps","_options","_options2","_option$inputProps2","computeFieldsFromSchema","onlyValidateSchema","_schema$properties","allOf","_schema$propertyOrder","propertyOrder","fields","sort","a","b","aIndex","bIndex","getSchemaPathFromJsonPath","jsonPath","schemaPath","getFormatter","formatter","_char","Error","matchingIndex","mi","matching","informedFormat","frmtr","offset","prefixLength","findIndex","suffixStart","reverse","formatted","chars","vIndex","start","matchIndex","matcher","curChar","createIntlNumberFormatter","locale","opts","_numberFormatterWitho","_numberFormatterWitho2","numberFormatter","Intl","NumberFormat","numberFormatterWithoutOpts","decimalChar","formatToParts","find","_ref2","isRegexEqual","x","y","global","ignoreCase","multiline","findLastIndex","predicate","l","insert","nextArr","stripNonNumeric","str","toNumberString","splitStr","toFloat","_float","parseFloat","isNaN","mask","_float2","fraction","numberParts","maskArray","pv","_ref3","partValue","includes","_","lastDigitIndex","maskChar","endOfMask","parser","utils","freeze","useIsomorphicLayoutEffect","window","document","createElement","useCursorPosition","inputRef","_ref$maintainCursor","maintainCursor","_useStateWithGetter","_useStateWithGetter2","cursor","setCursor","getCursor","_useStateWithGetter3","_useStateWithGetter4","cursorOffset","setCursorOffset","getCursorOffset","cursorLoc","setSelectionRange","useUpdateEffect","effect","deps","firstRef","isFirstMount","logger","initializeValue","initialize","initializeMask","format","parse","generateValidationFunction","validationFunc","validationSchema","required","validateRequired","generateOnChange","fieldType","onChange","multiple","setter","selected","checked","generateOnBlur","onBlur","generateValue","_ref4","maskedValue","generateFieldType","useField","fieldProps","userRef","asyncValidate","maskWithCursorOffset","initialValue","validateOnChange","validateOnBlur","validateOnMount","asyncValidateOnBlur","asyncValidateOnMount","maskOnBlur","allowEmptyString","onValueChange","notify","keepState","shadow","formController","userRelevant","relevant","keepStateIfRelevant","_fieldProps$formatter","formatterDependencies","userProps","fieldId","updater","multistepContext","inMultistep","fieldApiRef","initialRenerRef","fieldObjectRef","valueTouched","getPristine","getDirty","getFormApi","_useState3","_useState4","formInitialValue","savedState","initVal","initTouched","touched","setVal","getTheVal","setErr","getErr","_useStateWithGetter5","_useStateWithGetter6","setTouch","getTouch","_useState5","_useState6","setMaskedValue","maskedValueRef","initialValueRef","fieldRef","prevFieldRef","internalRef","_useCursorPosition","relevantFunc","rel","ff","_useStateWithGetter7","_useStateWithGetter8","isRelevant","setIsRelevant","getIsRelevant","multistepRelevant","checkRelevant","newRel","curRel","reset","getVal","_ref5","preventUpdate","getStep","formOptions","maskedVal","allowEmptyStrings","selectionStart","_res","_ref6","_ref7","fieldValidate","fieldAsyncValidate","fieldApi","getValue","getTouched","getError","getFieldState","dirty","pristine","fieldState","fullField","style","border","borderWidth","borderStyle","borderColor","borderImage","shouldUpdate","render","children","changeHandler","blurHandler","hookedValue","informed","asField","forwardRef","_useField","forwardedRef","logger$1","Text","_onChange","_onBlur","rest","background","Fragment","htmlFor","Text$1","TextArea","TextArea$1","logger$2","Select","selectRef","handleChange","disabled","Select$1","Checkbox","Checkbox$1","withRadioGroup","Consumer","radioGroupApi","radioGroupState","Radio","groupValue","groupOnChange","groupOnBlur","Radio$1","RadioGroup","_Component","_super","_this$props","Provider","groupContext","RadioGroup$1","useArrayFieldApi","AddButton","_useArrayFieldApi","add","onClick","useArrayFieldItemApi","AddButton$1","_useArrayFieldItemApi","remove","logger$3","useArrayField","arrayFieldApiRef","Map","fieldsById","initialVals","keptValues","initialValues","setInitialValues","getInitialValues","initialKeys","setKeys","getKeys","validateWithLength","onChangeHandler","fieldName","emitter","on","removeListener","_remove","newKeys","initVals","newInitialValues","swap","warn","addWithInitialValue","resetKeys","arrayFieldItemApi","arrayFieldItemState","arrayFieldApi","arrayFieldState","wrappedUpdator","fld","_len2","_key2","buildScopedFormApi","scope","useScopedApi","scopedFormApi","useFormState","formState","Relevant","when","ArrayField","ArrayFieldWrapper","_useArrayField","ArrayFieldItem","scopedApi","getState","_formApi$getState","itemState","magicValue","lastIndexOf","initialRender","arrayFieldItemApiValue","arrayFieldItemStateValue","Items","_useContext","FormComponents","components","fieldMap","comp","logger$4","FormFields","schemaFields","mapedFields","schemaField","ArrayField$1","conditional","subSchema","then","conditions","condition","defaultFieldMap","select","input","textarea","checkbox","radio","array","debug$2","isExpected","expectedRemovals","includedKey","noop","FormController","_this","subscriptions","ajv","allErrors","ajvValidate","compile","fieldsByName","fieldByName","onScreen","pulledOut","savedValues","invalid","submits","validating","submitting","dummyField","bind","getErrors","setStep","back","setCurrent","setFormError","submitForm","screenValid","keyDown","getFormState","setValues","resetField","fieldExists","validateField","validated","emit","touch","currentError","event","listeners","listener","Set","setOptions","valid","component","Current","prevComponent","nextComponent","getAllTouched","_this2","notifier","JSPAN","toNotify","entries","_this3","_errors","validateFields","_errors2","keyCode","preventEnter","preventDefault","dontPreventDefault","mount","_this4","alreadyRegistered","size","expectedRemoval","oldName","t","oldField","logger$5","FormProvider","useForm","logger$6","getApi","apiRef","onReset","onSubmit","onSubmitFailure","formControllerOptions","setFormState","onResetHandler","onSubmitHandler","onValueHandler","onFailureHandler","onChangeHandlerRerender","debug$3","Form","renderProp","_useForm","getContent","onKeyDown","buildScopedFormApi$1","buildScopedRegister","formRegister","_register","_deregister","_setValue","_setTouched","_setError","_update","_getField","_expectRemoval","_getInitialValue","_getSavedValue","_len3","_key3","_len4","_key4","_len5","_key5","_len6","_key6","_len7","_key7","_len8","_key8","Scope","scopedRegister","FormState","displayState","_displayState","useMultistep","initialStep","multistepApiRef","_useFormApi","stepsByName","nSteps","steps","goal","multistepState","setMultistepState","getMultistepState","getCurrentStep","_getMultistepState","currentStep","api","getNumberOfSteps","_getCurrentStep","getNext","nextStep","prev","_getCurrentStep2","getPrevious","previous","previousStep","stp","goalIndex","multistepApi","useMultistepState","useMultistepApi","useMultistepStep","_useFormState","_useMultistepState","_useMultistepApi","goToNext","isCurrent","nextRef","prevRef","relevantRef","multistep","Multistep","_useMultistep","context","Step","MultistepStep","_useMultistepStep","FormField","_getOptions","SchemaFields","withFormApi","withFormState","buildFieldApi","exists","useFieldApi","useFieldState","_React$useState","_React$useState2","updateState","forceUpdate","useCallback","withFieldState","withFieldApi","Option","Input","BasicCheckbox","BasicRadio","BasicRadioGroup","BasicSelect","BasicText","BasicTextArea"],"mappings":"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","sourcesContent":["import React, { useContext, useRef, useState, useEffect, useLayoutEffect, useMemo, Component } from 'react';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = o[Symbol.iterator]();\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar debug = createCommonjsModule(function (module) {\n/**\n * \n * I stole most of this code from the debug lib\n * https://github.com/visionmedia/debug\n * \n * Just wanted it to be easy to debug without relying on the dependency!\n */\n\n/**\n\t* Selects a color for a debug namespace\n  * @param {String} namespace The namespace string for the for the debug instance to be colored\n  * @param {String} colors color pallette to choose from\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\nfunction selectColor(namespace, colors) {\n  var hash = 0;\n\n  for (var i = 0; i < namespace.length; i++) {\n    hash = (hash << 5) - hash + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return colors[Math.abs(hash) % colors.length];\n}\n/**\n * Adds ANSI color escape codes if enabled.\n *\n * @api public\n */\n\n\nfunction formatNodeArgs(args, config) {\n  var name = config.namespace;\n\n  if (config.useColors) {\n    var c = config.color;\n    var colorCode = \"\\x1B[3\" + (c < 8 ? c : '8;5;' + c);\n    var prefix = \"  \".concat(colorCode, \";1m\").concat(name, \" \\x1B[0m\");\n    args[0] = prefix + args[0].split('\\n').join('\\n' + prefix);\n  } else {\n    args[0] = name + ' ' + args[0];\n  }\n}\n/**\n * Colorize log arguments if enabled.\n *\n */\n\n\nfunction formatBrowserArgs(args, config) {\n  args[0] = (config.useColors ? '%c' : '') + config.namespace;\n\n  if (!config.useColors) {\n    return;\n  }\n\n  var c = 'color: ' + config.color; // The final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function (match) {\n    if (match === '%%') {\n      return;\n    }\n\n    index++;\n\n    if (match === '%c') {\n      // We only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n  args.splice(lastC, 0, c);\n}\n\nvar browserColors = ['#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC', '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF', '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC', '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF', '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC', '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033', '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366', '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933', '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC', '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF', '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'];\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the debug modes\n * @api private\n */\n\nfunction loadBrowser() {\n  var namespaces;\n\n  try {\n    namespaces = localStorage.getItem('debug');\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  } // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\n\n  if (!namespaces && typeof process !== 'undefined' && 'env' in process) {\n    namespaces = process.env.DEBUG;\n  }\n\n  return {\n    namespaces: namespaces || '',\n    colors: browserColors,\n    useColors: true,\n    formatArgs: formatBrowserArgs\n  };\n}\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the debug modes\n * @api private\n */\n\n\nfunction loadNode() {\n  return {\n    namespaces: process.env.DEBUG || '',\n    colors: [6, 2, 3, 4, 5, 1],\n    useColors: true,\n    formatArgs: formatNodeArgs\n  };\n}\n\nfunction createLogger() {\n  var prefix = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var config = arguments.length > 1 ? arguments[1] : undefined;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (prefix) {\n      args.unshift(prefix);\n    } // Create a namespace regex for each namespace\n\n\n    var matches = config.namespaces.split(',').map(function (namespace) {\n      // Remove wildcard and add to regex if wildcard\n      if (namespace[namespace.length - 1] === '*') {\n        return new RegExp('^' + namespace.slice(0, namespace.length - 1) + '.*' + '$');\n      }\n\n      return new RegExp('^' + namespace + '$');\n    }); // Does the prefix match a namespace\n\n    var match = matches.some(function (regex) {\n      return regex.test(prefix);\n    });\n    var conf = {\n      color: selectColor(prefix, config.colors),\n      namespace: prefix,\n      useColors: config.useColors\n    };\n\n    if (process.env.NODE_ENV !== 'production' && match) {\n      var _console;\n\n      config.formatArgs(args, conf);\n\n      (_console = console).log.apply(_console, args);\n    }\n  };\n}\n\nfunction nodeLogger(prefix) {\n  return createLogger(prefix, loadNode());\n}\n\nfunction browserLogger(prefix) {\n  return createLogger(prefix, loadBrowser());\n}\n/**\n * Detect Electron renderer / nwjs process, which is node, but we should\n * treat as a browser.\n */\n\n\nif (typeof process === 'undefined' || process.type === 'renderer' || process.browser === true || process.__nwjs) {\n  module.exports = browserLogger;\n} else {\n  module.exports = nodeLogger;\n}\n});\n\nvar debug$1 = debug('informed:ObjMap' + '\\t');\n/* -------------------- toPath -------------------- */\n\nvar ldtoPath = function ldtoPath() {\n  var path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean);\n};\n/* --------------------- get --------------------- */\n\n\nvar ldget = function ldget(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var defaultValue = arguments.length > 2 ? arguments[2] : undefined;\n  var result = String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key) {\n    return res !== null && res !== undefined ? res[key] : res;\n  }, obj);\n  return result === undefined || result === obj ? defaultValue : result;\n};\n/* --------------------- has --------------------- */\n// foo -->\n// foo.bar --> foo\n// foo.bar[3] --> foo.bar\n// foo.bar.baz[2].raz.taz[5].laz --> foo.bar.baz[2].raz.taz[5]\n\n\nvar parentPath = function parentPath(path) {\n  return \".\".concat(path).replace(/(.*)[.[].*/, '$1').replace(/\\./, '');\n}; // foo --> foo\n// foo.bar --> bar\n// foo.bar[3] --> [3]\n// foo.bar.baz[2].raz.taz[5].laz --> laz\n\n\nvar pathKey = function pathKey(path) {\n  return path.replace(parentPath(path), '').replace(/\\./, '');\n};\n\nvar ldhas = function ldhas(obj, path) {\n  var pPath = parentPath(path);\n  var key = pathKey(path); // If we have parent path then get the object at that location\n  // .. otherwise its the root object\n\n  var parentObj = pPath ? ldget(obj, pPath) : obj; // If its [3] turn key into 3\n\n  return !!(parentObj && Object.hasOwnProperty.call(parentObj, key.replace(/\\[(.*)\\]/, '$1')));\n};\n/* --------------------- set --------------------- */\n\n\nvar ldset = function ldset(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var val = arguments.length > 2 ? arguments[2] : undefined;\n  String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key, i, arr) {\n    //console.log('RES', res, 'Key', key, 'I', i, 'Arr', arr, 'OBJ', obj);\n    // At the leaf set the value\n    if (i === arr.length - 1) {\n      res[key] = val;\n      return res[key];\n    } // Initialize to new array or object if needed\n\n\n    if (res[key] === undefined) {\n      if (Number.isInteger(+arr[i + 1])) {\n        res[key] = [];\n      } else {\n        res[key] = {};\n      }\n\n      return res[key];\n    } // Exception for if the value is changeing to an array\n\n\n    if (Number.isInteger(+arr[i + 1]) && !Array.isArray(res[key])) {\n      res[key] = [];\n    } //TODO exception for if object ??\n    // Otherwise keep whats there\n\n\n    return res[key];\n  }, obj);\n};\n/* --------------------- unset --------------------- */\n\n\nvar ldunset = function ldunset(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var found = false;\n  String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key, i, arr) {\n    // Base case res is undefined\n    if (res === undefined) {\n      return res;\n    } // At the leaf delete the value\n\n\n    if (i === arr.length - 1) {\n      delete res[key];\n      found = true;\n      return res[key];\n    } // Otherwise keep going\n\n\n    return res[key];\n  }, obj);\n  return found;\n};\n/* --------------------- pullAt --------------------- */\n\n\nvar ldpullAt = function ldpullAt(obj) {\n  var path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n  var pulled;\n  String.prototype.replace.call(path, /\\['(.+?)'\\]/g, '.$1').split(/[,[\\].]+?/).filter(Boolean).reduce(function (res, key, i, arr) {\n    // Base case res is undefined\n    if (res === undefined) {\n      return res;\n    } // At the leaf delete the value\n\n\n    if (i === arr.length - 1 && Array.isArray(res)) {\n      // Pull out one value at index ( key )\n      pulled = res.splice(key, 1);\n      return res[key];\n    } // Otherwise keep going\n\n\n    return res[key];\n  }, obj);\n  return pulled;\n};\n/* --------------------- values --------------------- */\n\n\nvar ldvalues = function ldvalues() {\n  var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var props = Object.keys(obj);\n  return props.map(function (key) {\n    return obj[key];\n  });\n};\n\nvar pathToArrayElem = function pathToArrayElem(path) {\n  var pathArray = ldtoPath(path);\n  return Number.isInteger(+pathArray[pathArray.length - 1]);\n};\n\nvar ObjectMap = /*#__PURE__*/function () {\n  function ObjectMap() {\n    _classCallCheck(this, ObjectMap);\n  }\n\n  _createClass(ObjectMap, null, [{\n    key: \"empty\",\n    value: function empty(object) {\n      return ldvalues(object).length === 0;\n    }\n  }, {\n    key: \"get\",\n    value: function get(object, path) {\n      var val = ldget(object, path); //debug('GOT', path, val);\n\n      return val;\n    }\n  }, {\n    key: \"has\",\n    value: function has(object, path) {\n      return ldhas(object, path);\n    }\n  }, {\n    key: \"set\",\n    value: function set(object, path, value) {\n      if (value !== undefined) {\n        debug$1('SETTING', path, value);\n        ldset(object, path, value);\n      } else {\n        // Setting things to undefined in informed is special!\n        // so in this else statement we deal with that\n        // If the path is to an array leaf then we want to set to undefined\n        // Example:\n        // path = 'foo.bar[2]'\n        // foo.bar = [ 'baz', 'raz', 'taz' ]\n        // setting taz to undefined   ^^^\n        if (pathToArrayElem(path) && ObjectMap.get(object, path) !== undefined) {\n          debug$1('Special case SETTING', path, 'to undefined');\n          ldset(object, path, undefined);\n          var pathArray = ldtoPath(path);\n          pathArray = pathArray.slice(0, pathArray.length - 1);\n          cleanup(object, pathArray);\n        } // Only delete the field if it needs to be deleted and its not a path to an array ( array leaf )\n        // Example:\n        // path = 'foo.bar'\n        // foo.bar = 'baz'\n        // removing foo.bar from the object completley\n        else if (!pathToArrayElem(path) && ObjectMap.get(object, path) !== undefined) {\n            debug$1('Special case REMOVING', path, 'from object completley');\n            ObjectMap[\"delete\"](object, path);\n          }\n      }\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(object, path) {\n      debug$1('DELETE', path); // Special case for arrays\n\n      if (pathToArrayElem(path)) {\n        debug$1('ARRAY', path); //ldunset(object, path);\n\n        this.pullOut(object, path);\n      } else {\n        ldunset(object, path);\n      }\n\n      var pathArray = ldtoPath(path);\n      pathArray = pathArray.slice(0, pathArray.length - 1);\n      cleanup(object, pathArray);\n    } // Very important ;)\n\n  }, {\n    key: \"pullOut\",\n    value: function pullOut(object, path) {\n      // Get the path to the array\n      var pathArray = ldtoPath(path); // debug('PathArray1', pathArray);\n\n      var index = pathArray[pathArray.length - 1];\n      pathArray = pathArray.slice(0, pathArray.length - 1);\n      debug$1('Pulling out:', pathArray, 'index', index); // Get the array\n\n      var arr = ldget(object, pathArray);\n      debug$1('Array', arr); // Pull out of array\n\n      if (Array.isArray(arr)) {\n        ldpullAt(arr, index);\n      }\n\n      cleanup(object, pathArray);\n    }\n  }]);\n\n  return ObjectMap;\n}();\n\nfunction cleanup(obj, path) {\n\n  // Base case no path left\n  if (path.length === 0) {\n    return;\n  }\n\n  var object = ldget(obj, path); // Clean up undefined from array\n  // if (Array.isArray(object) && pull) {\n  //   ldpull(object, undefined);\n  // }\n  // Delete object if its empty\n\n  if (Array.isArray(object) ? object.every(function (e) {\n    return e == null;\n  }) : JSON.stringify(object) === '{}') {\n    ldunset(obj, path);\n  } // Recur\n\n\n  cleanup(obj, path.slice(0, path.length - 1));\n}\n\nvar FormRegisterContext = /*#__PURE__*/React.createContext({\n  register: function register() {},\n  deregister: function deregister() {},\n  setValue: function setValue() {},\n  setTouched: function setTouched() {},\n  setError: function setError() {},\n  update: function update() {},\n  getField: function getField() {},\n  expectRemoval: function expectRemoval() {},\n  getInitialValue: function getInitialValue() {},\n  getSavedValue: function getSavedValue() {}\n});\nvar FormStateContext = /*#__PURE__*/React.createContext({});\nvar FormApiContext = /*#__PURE__*/React.createContext({\n  getFullField: function getFullField() {},\n  getValues: function getValues() {},\n  getOptions: function getOptions() {\n    return {};\n  },\n  setInitialValue: function setInitialValue() {},\n  getInitialValue: function getInitialValue() {},\n  getDerrivedValue: function getDerrivedValue() {},\n  getSavedValue: function getSavedValue() {},\n  removeSavedState: function removeSavedState() {}\n});\nvar GroupContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldStateContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldApiContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldItemApiContext = /*#__PURE__*/React.createContext();\nvar ArrayFieldItemStateContext = /*#__PURE__*/React.createContext();\nvar MultistepStateContext = /*#__PURE__*/React.createContext();\nvar MultistepApiContext = /*#__PURE__*/React.createContext();\nvar MultistepStepContext = /*#__PURE__*/React.createContext();\n\nfunction useFormApi() {\n  var formApi = useContext(FormApiContext);\n  return formApi;\n}\n\n// https://github.com/facebook/react/issues/14543\n\nfunction useStateWithGetter(initial) {\n  var ref = useRef();\n  var mounted = useRef(true);\n\n  var _useState = useState(initial),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  ref.current = state;\n\n  var set = function set(value) {\n    ref.current = value;\n    if (mounted.current) setState(value);\n  };\n\n  var get = function get() {\n    return ref.current;\n  };\n\n  useEffect(function () {\n    return function () {\n      mounted.current = false;\n    };\n  }, []);\n  return [state, set, get];\n}\n\nvar getChildDisplayName = function getChildDisplayName(WrappedComponent) {\n  // fix for \"memo\" components\n  if (WrappedComponent.type && WrappedComponent.type.name) {\n    return WrappedComponent.type.name;\n  }\n\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n};\nvar yupToFormErrors = function yupToFormErrors(yupError) {\n  var errors = {};\n\n  if (yupError.inner) {\n    if (yupError.inner.length === 0) {\n      // console.log(yupError.path);\n      ObjectMap.set(errors, yupError.path, yupError.message);\n      return;\n    }\n\n    var _iterator = _createForOfIteratorHelper(yupError.inner),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var err = _step.value;\n\n        if (!ObjectMap.get(errors, err.path)) {\n          // console.log(errors, err.path, err.message);\n          ObjectMap.set(errors, err.path, err.message);\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  }\n\n  return errors;\n};\nvar validateYupSchema = function validateYupSchema(schema, values) {\n  try {\n    schema.validateSync(values, {\n      abortEarly: false\n    });\n  } catch (e) {\n    var formErrors = yupToFormErrors(e);\n    return formErrors;\n  }\n};\nvar yupToFormError = function yupToFormError(yupError) {\n  if (yupError.inner) {\n    if (yupError.inner.length === 0) {\n      return;\n    }\n\n    var err = yupError.inner[0];\n    return err.message;\n  }\n};\nvar validateYupField = function validateYupField(schema, value) {\n  try {\n    schema.validateSync(value, {\n      abortEarly: false\n    });\n  } catch (e) {\n    return yupToFormError(e);\n  }\n};\nvar validateAjvSchema = function validateAjvSchema(validate, data) {\n  validate(data);\n  var errors = {};\n\n  if (validate.errors) {\n    validate.errors.forEach(function (_ref) {\n      var message = _ref.message,\n          dataPath = _ref.dataPath,\n          keyword = _ref.keyword,\n          params = _ref.params;\n      var path = dataPath; // Special case for required\n\n      if (keyword === 'required') {\n        path = \"\".concat(path, \".\").concat(params.missingProperty);\n      } // Get rid of leading dot\n\n\n      path = path.replace('.', ''); // console.log('PATH', path, message);\n      // TODO get message from informed if present\n\n      ObjectMap.set(errors, path, message);\n    });\n  }\n\n  return errors;\n}; // https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n\nvar uuidv4 = function uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c == 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n};\nvar debounce = function debounce(func, wait) {\n  var timeout;\n  return function executedFunction() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var later = function later() {\n      clearTimeout(timeout);\n      func.apply(void 0, args);\n    };\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\nvar computeFieldFromProperty = function computeFieldFromProperty(propertyName, property, prefix) {\n  var uiControl = property['ui:control'],\n      informedProps = property['informed:props'],\n      inputProps = property['input:props'],\n      uiBefore = property['ui:before'],\n      uiAfter = property['ui:after'],\n      oneOf = property.oneOf,\n      items = property.items,\n      schemaEnum = property[\"enum\"],\n      label = property.title,\n      min = property.minimum,\n      max = property.maximum,\n      minLength = property.minLength,\n      maxLength = property.maxLength,\n      pattern = property.pattern,\n      type = property.type,\n      subProperties = property.properties; // Set Id if not passed\n\n  var id = uuidv4();\n\n  if (inputProps && inputProps.id) {\n    id = inputProps.id;\n  }\n\n  var field = {\n    componentType: uiControl,\n    field: prefix ? \"\".concat(prefix, \".\").concat(propertyName) : propertyName,\n    type: type,\n    uiBefore: uiBefore,\n    uiAfter: uiAfter,\n    properties: type === 'object' ? subProperties : undefined,\n    items: type === 'array' ? items : undefined,\n    props: _objectSpread2(_objectSpread2({\n      label: label,\n      id: id,\n      min: min,\n      max: max,\n      minLength: minLength,\n      maxLength: maxLength,\n      pattern: pattern\n    }, informedProps), inputProps)\n  };\n\n  if (oneOf) {\n    var options = property.oneOf.map(function (option) {\n      var _option$inputProps = option['input:props'],\n          inputProps = _option$inputProps === void 0 ? {} : _option$inputProps;\n      return _objectSpread2({\n        value: option[\"const\"],\n        label: option.title\n      }, inputProps);\n    });\n    field.props.options = options;\n  }\n\n  if (schemaEnum) {\n    var _options = property[\"enum\"].map(function (val) {\n      return {\n        value: val,\n        label: val\n      };\n    });\n\n    field.props.options = _options;\n  }\n\n  if (items && items.oneOf) {\n    var _options2 = items.oneOf.map(function (option) {\n      var _option$inputProps2 = option['input:props'],\n          inputProps = _option$inputProps2 === void 0 ? {} : _option$inputProps2;\n      return _objectSpread2({\n        value: option[\"const\"],\n        label: option.title\n      }, inputProps);\n    });\n\n    field.props.options = _options2;\n  }\n\n  return field;\n};\nvar computeFieldsFromSchema = function computeFieldsFromSchema(schema, onlyValidateSchema, prefix) {\n  if (!schema || onlyValidateSchema) {\n    return [];\n  } // Grab properties and items off of schema\n\n\n  var _schema$properties = schema.properties,\n      properties = _schema$properties === void 0 ? {} : _schema$properties,\n      allOf = schema.allOf,\n      _schema$propertyOrder = schema.propertyOrder,\n      propertyOrder = _schema$propertyOrder === void 0 ? [] : _schema$propertyOrder;\n\n  if (Object.keys(properties).length > 0) {\n    // Attempt to generate fields from properties\n    var fields = Object.keys(properties).sort(function (a, b) {\n      var aIndex = propertyOrder.indexOf(a);\n      var bIndex = propertyOrder.indexOf(b);\n      return (aIndex > -1 ? aIndex : propertyOrder.length + 1) - (bIndex > -1 ? bIndex : propertyOrder.length + 1);\n    }).map(function (propertyName) {\n      var property = properties[propertyName];\n      var field = computeFieldFromProperty(propertyName, property, prefix);\n      return field;\n    }); // Check for all of ( we have conditionals )\n\n    if (allOf) {\n      fields.push({\n        componentType: 'conditionals',\n        // Each element of the \"allOf\" array is a conditional\n        allOf: allOf\n      });\n    }\n\n    return fields;\n  }\n\n  return [];\n}; // Examples\n// field = \"name\" ---> properties.name\n// field = \"brother.name\" ---> properties.brother.properties.name\n// field = \"brother.siblings[1].friend.name\" ---> properties.brother.properties.siblings.items[1].properties.friend.properties.name\n\nvar getSchemaPathFromJsonPath = function getSchemaPathFromJsonPath(jsonPath) {\n  // Convert\n  var schemaPath = jsonPath.replace(/\\./g, '.properties.').replace(/\\[/g, '.itmes['); // Add first properties\n\n  schemaPath = \"properties.\".concat(schemaPath);\n  return schemaPath;\n};\n/* -------------------------- Formatter ----------------------------- */\n\nvar getFormatter = function getFormatter(formatter, value) {\n  // If mask is a string turn it into an array;\n  if (typeof formatter === 'string') {\n    return formatter.split('').map(function (_char) {\n      if (_char === '#') {\n        return /\\d/;\n      }\n\n      if (_char === '*') {\n        return /[\\w]/;\n      }\n\n      return _char;\n    });\n  } // If mask is a function use it to genreate current mask\n\n\n  if (typeof formatter === 'function') {\n    return formatter(value);\n  }\n\n  if (Array.isArray(formatter)) {\n    return formatter;\n  } // Should never make it here throw\n\n\n  throw new Error('Formatter must be string, array, or function');\n};\n\nvar matchingIndex = function matchingIndex(a, b) {\n  var i = 0;\n  var mi = -1;\n  var matching = true; // a = \"+1 \"\n  // b = \"+12\"\n\n  while (matching && i < a.length) {\n    if (a[i] == b[i]) {\n      mi = i;\n    } else {\n      matching = false;\n    }\n\n    i = i + 1;\n  }\n\n  return mi;\n};\n\nvar informedFormat = function informedFormat(val, frmtr) {\n  // console.log('Formatting', val);\n  // Null check\n  if (!val) {\n    return {\n      val: val,\n      offset: 0\n    };\n  }\n\n  var value = \"\".concat(val); // Generate formatter array\n\n  var formatter = getFormatter(frmtr, value); // Start to fill in the array\n  // Example: phone formatter\n  // formatter =['+', '1', ' ', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, /\\d/, '-', /\\d/, /\\d/, /\\d/, /\\d/]\n  // value examples:\n  // \"1231231234 ----> +1 123-123-1234\n  // \"+\" \t\t\t\t ----> +\n  // \"+1\" \t\t\t ----> +1\n  // \"+2\"\t\t\t\t ----> +1 2\n  // \"1\"\t\t\t\t ----> +1 1\n  // \"1234\"\t\t\t ----> +1 123-4\n  // \"123a\"      ----> +1 123\n  // Determine prefix length and suffix start\n\n  var prefixLength = formatter.findIndex(function (v) {\n    return typeof v != 'string';\n  });\n\n  var suffixStart = formatter.length - _toConsumableArray(formatter).reverse().findIndex(function (v) {\n    return typeof v != 'string';\n  }); // Formatted value\n\n\n  var formatted = []; // The characters from the current value\n\n  var chars = value.split(''); // To track the value index during itteration\n\n  var vIndex = 0;\n  var start = 0; // If the value matches part of the prefix take it out\n  // Example prefix = \"+1 \" value = [\"+1 123-123-1234\", \"+12\", \"+2\"]\n\n  var matchIndex = matchingIndex(formatter.slice(0, prefixLength), chars.slice(0, prefixLength)); // console.log('Matching index', matchIndex);\n\n  if (matchIndex > -1) {\n    //vIndex = prefixLength;\n    vIndex = matchIndex + 1;\n    formatted = formatted.concat(formatter.slice(0, matchIndex + 1));\n    start = matchIndex + 1;\n  } // Example prefix = \"+1 \" value=[\"1\", \"1234\"]\n\n\n  if (matchIndex < 0) {\n    // Start past the prefix\n    formatted = formatted.concat(formatter.slice(0, prefixLength));\n    start = prefixLength;\n  } // console.log('start', start, formatted);\n\n  for (var i = start; i < formatter.length; i++) {\n    // Get current formatter location matcher\n    var matcher = formatter[i]; // We get past the prefix if matcher is not a string\n\n\n    if (vIndex != chars.length) {\n      // Get the current value character\n      var curChar = chars[vIndex]; // Special case for function\n\n      if (typeof matcher === 'function') {\n        formatted.push(matcher(curChar));\n        vIndex = vIndex + 1;\n      } else {\n        // If type is string normal compare otherwise regex compare\n        var match = typeof matcher === 'string' ? matcher === curChar : matcher.test(curChar); // If the current character of the value matches and matcher is a string\n        // \"1\" === \"1\"\n\n        if (match && typeof matcher === 'string') {\n          formatted.push(matcher); //if( pastPrefix ){\n\n          vIndex = vIndex + 1; //}\n        } // If the current character does not match and matcher is a stirng\n        // \"1\" != \"+\"\n        else if (!match && typeof matcher === 'string') {\n            // Special check for 123a ---> dont want \"+1 123-\"\n            // Special check for 1234 ---> DO want \"+1 123-4\"\n            if (vIndex != chars.length) formatted.push(matcher);\n          } // If the current character matches and the matcher is not a string\n          // /\\d/.test(\"2\")\n          else if (match && typeof matcher != 'string') {\n              formatted.push(curChar);\n              vIndex = vIndex + 1;\n            } // If the current character does NOT match and the matecer is regex\n            // /\\d/.test(\"a\")\n            else if (!match && typeof matcher != 'string') {\n                // Throw out this value\n                vIndex = vIndex + 1;\n                i = i - 1;\n              }\n      }\n    } else {\n      // If mattcher is a string and we are at suffix keep going\n      if (typeof matcher === 'string' && i >= suffixStart) {\n        formatted.push(matcher);\n      } else {\n        // Otherwise we want to break out\n        break;\n      }\n    }\n  }\n\n  return {\n    value: formatted.join(''),\n    offset: value ? formatted.length - value.length : 0\n  };\n};\n/* --------------------------------------- createIntlNumberFormatter --------------------------------------- */\n\nvar createIntlNumberFormatter = function createIntlNumberFormatter(locale, opts) {\n  var _numberFormatterWitho, _numberFormatterWitho2;\n\n  var numberFormatter = new Intl.NumberFormat(locale, opts);\n  var numberFormatterWithoutOpts = new Intl.NumberFormat(locale);\n  var decimalChar = (_numberFormatterWitho = (_numberFormatterWitho2 = numberFormatterWithoutOpts.formatToParts(0.1).find(function (_ref2) {\n    var type = _ref2.type;\n    return type === 'decimal';\n  })) === null || _numberFormatterWitho2 === void 0 ? void 0 : _numberFormatterWitho2.value) !== null && _numberFormatterWitho !== void 0 ? _numberFormatterWitho : '.';\n\n  function isRegexEqual(x, y) {\n    return x instanceof RegExp && y instanceof RegExp && x.source === y.source && x.global === y.global && x.ignoreCase === y.ignoreCase && x.multiline === y.multiline;\n  }\n\n  function findLastIndex(arr, predicate) {\n    var l = arr.length; // eslint-disable-next-line no-plusplus\n\n    while (l--) {\n      if (predicate(arr[l])) return l;\n    }\n\n    return -1;\n  }\n\n  function insert(arr, index, value) {\n    var nextArr = _toConsumableArray(arr);\n\n    if (Array.isArray(value)) {\n      nextArr.splice.apply(nextArr, [index, 0].concat(_toConsumableArray(value)));\n    } else {\n      nextArr.splice(index, 0, value);\n    }\n\n    return nextArr;\n  }\n\n  function stripNonNumeric(str) {\n    return \"\".concat(str).replace(/\\D/g, '');\n  }\n\n  function toNumberString(str) {\n    return \"\".concat(str).split(decimalChar).map(function (splitStr) {\n      return stripNonNumeric(splitStr);\n    }).join('.');\n  }\n\n  function toFloat(str) {\n    if (typeof str === 'number') {\n      return str;\n    }\n\n    var _float = parseFloat(toNumberString(str));\n\n    return !Number.isNaN(_float) ? _float : undefined;\n  }\n\n  function mask(value) {\n    var _float2 = toNumberString(value); // if (!float) {\n    //   return [];\n    // }\n\n\n    var fraction = \"\".concat(_float2).split('.')[1];\n    var numberParts = numberFormatter.formatToParts(Number(_float2));\n\n    if (fraction === '0') {\n      numberParts.push({\n        type: 'decimal',\n        value: decimalChar\n      }, {\n        type: 'fraction',\n        value: fraction\n      });\n    }\n\n    var maskArray = numberParts.reduce(function (pv, _ref3) {\n      var type = _ref3.type,\n          partValue = _ref3.value;\n\n      if (['decimal', 'fraction'].includes(type) && fraction == null) {\n        return pv;\n      }\n\n      if (['integer', 'fraction'].includes(type)) {\n        return [].concat(_toConsumableArray(pv), _toConsumableArray(partValue.split('').filter(function (_, index) {\n          return type === 'fraction' ? index < fraction.length : true;\n        }).map(function () {\n          return /\\d/;\n        })));\n      }\n\n      if (type === 'currency') {\n        return [].concat(_toConsumableArray(pv), _toConsumableArray(partValue.split('')));\n      }\n\n      return [].concat(_toConsumableArray(pv), [partValue]);\n    }, []);\n    var lastDigitIndex = findLastIndex(maskArray, function (maskChar) {\n      return isRegexEqual(maskChar, /\\d/);\n    });\n\n    if (maskArray.indexOf(decimalChar) === -1 && \"\".concat(value).indexOf(decimalChar) !== -1) {\n      maskArray = insert(maskArray, lastDigitIndex + 1, [decimalChar, '[]']);\n      lastDigitIndex += 2; // we want to insert a new number after the decimal\n    }\n\n    var endOfMask = maskArray.slice(lastDigitIndex + 1).join('');\n    maskArray = [].concat(_toConsumableArray(maskArray.slice(0, lastDigitIndex + 1)), [endOfMask]);\n    return maskArray;\n  }\n\n  var parser = function parser(value) {\n    if (value == null) {\n      return undefined;\n    }\n\n    return toFloat(value);\n  };\n\n  return {\n    formatter: mask,\n    parser: parser\n  };\n};\n\nvar utils = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  getChildDisplayName: getChildDisplayName,\n  yupToFormErrors: yupToFormErrors,\n  validateYupSchema: validateYupSchema,\n  yupToFormError: yupToFormError,\n  validateYupField: validateYupField,\n  validateAjvSchema: validateAjvSchema,\n  uuidv4: uuidv4,\n  debounce: debounce,\n  computeFieldFromProperty: computeFieldFromProperty,\n  computeFieldsFromSchema: computeFieldsFromSchema,\n  getSchemaPathFromJsonPath: getSchemaPathFromJsonPath,\n  informedFormat: informedFormat,\n  createIntlNumberFormatter: createIntlNumberFormatter\n});\n\n// To get around it, we can conditionally useEffect on the server (no-op) and\n// useLayoutEffect in the browser.\n// @see https://gist.github.com/gaearon/e7d97cdf38a2907924ea12e4ebdf3c85\n\nvar useIsomorphicLayoutEffect = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined' ? useLayoutEffect : useEffect;\n\nvar useCursorPosition = function useCursorPosition(_ref) {\n  var value = _ref.value,\n      inputRef = _ref.inputRef,\n      _ref$maintainCursor = _ref.maintainCursor,\n      maintainCursor = _ref$maintainCursor === void 0 ? true : _ref$maintainCursor;\n\n  var _useStateWithGetter = useStateWithGetter(0),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      cursor = _useStateWithGetter2[0],\n      setCursor = _useStateWithGetter2[1],\n      getCursor = _useStateWithGetter2[2];\n\n  var _useStateWithGetter3 = useStateWithGetter(0),\n      _useStateWithGetter4 = _slicedToArray(_useStateWithGetter3, 3),\n      cursorOffset = _useStateWithGetter4[0],\n      setCursorOffset = _useStateWithGetter4[1],\n      getCursorOffset = _useStateWithGetter4[2];\n\n  useIsomorphicLayoutEffect(function () {\n    if (inputRef.current != null && getCursor()) {\n      // inputRef.current.selectionEnd = getCursor() + getCursorOffset();\n      var cursorLoc = getCursor() + getCursorOffset(); // Only offset if we need to\n\n      if (getCursorOffset() != 0 && maintainCursor) {\n        inputRef.current.setSelectionRange(cursorLoc + 1, cursorLoc + 1);\n      } else if (maintainCursor) {\n        inputRef.current.setSelectionRange(cursorLoc, cursorLoc);\n      }\n    }\n  }, [value]);\n  return {\n    setCursorOffset: setCursorOffset,\n    setCursor: setCursor,\n    cursor: cursor,\n    getCursor: getCursor,\n    cursorOffset: cursorOffset\n  };\n};\n\n/**\n *\n * Acts as a react useEffect that does not run on first render.\n *\n * @example\n * useUpdateEffect(()=>{...}, [foo])\n * 1st Render: NO CALL\n * foo changes: GETS CALLED\n *\n */\n\nvar useUpdateEffect = function useUpdateEffect(effect, deps) {\n  var firstRef = useRef(true);\n  var isFirstMount = firstRef.current;\n  useEffect(function () {\n    if (!isFirstMount) {\n      return effect();\n    } else {\n      firstRef.current = false;\n    }\n  }, deps);\n};\n\nvar logger = debug('informed:useField' + '\\t'); // localStorage.debug = 'informed:.*' << HOW to enable debuging\n\nvar initializeValue = function initializeValue(value, mask, formatter, parser, initialize) {\n  if (value != null) {\n    // Call users initialize if it was passed\n    if (initialize) {\n      return initialize(value);\n    } // Call mask if it was passed\n\n\n    if (mask) {\n      return mask(value);\n    }\n\n    if (formatter && !parser) {\n      var res = informedFormat(value, formatter);\n      return res.value;\n    }\n\n    return value;\n  } // Not needed but called out specifically\n\n\n  return undefined;\n};\n\nvar initializeMask = function initializeMask(value, format, parse, formatter) {\n  // Call format and parse if they were passed\n  if (format && parse) {\n    return format(value);\n  } // Call formatter\n\n\n  if (formatter) {\n    var res = informedFormat(value, formatter);\n    return res.value;\n  }\n\n  return value;\n};\n\nvar generateValidationFunction = function generateValidationFunction(validationFunc, validationSchema, _ref) {\n  var required = _ref.required;\n\n  // We dont want a validation function if there was nothing passed\n  if (validationFunc || validationSchema) {\n    return function (val, values) {\n      if (validationSchema) {\n        return validateYupField(validationSchema, val);\n      }\n\n      if (validationFunc) {\n        return validationFunc(val, values);\n      }\n    };\n  }\n\n  if (required) {\n    return function (val) {\n      return validateRequired(val, required);\n    };\n  }\n};\n\nvar generateOnChange = function generateOnChange(_ref2) {\n  var fieldType = _ref2.fieldType,\n      setValue = _ref2.setValue,\n      onChange = _ref2.onChange,\n      multiple = _ref2.multiple,\n      ref = _ref2.ref;\n\n  var setter = function setter(e) {\n    return setValue(e);\n  };\n\n  if (fieldType === 'text' || fieldType === 'textArea' || fieldType === 'number') {\n    setter = function setter(e) {\n      return setValue(e.target.value, e);\n    };\n  }\n\n  if (fieldType === 'select') {\n    setter = function setter() {\n      var selected = Array.from(ref.current).filter(function (option) {\n        return option.selected;\n      }).map(function (option) {\n        return option.value;\n      });\n      setValue(multiple ? selected : selected[0] || '');\n    };\n  }\n\n  if (fieldType === 'checkbox') {\n    setter = function setter(e) {\n      setValue(e.target.checked);\n\n      if (onChange) {\n        onChange(e);\n      }\n    };\n  }\n\n  return function (e) {\n    setter(e);\n  };\n};\n\nvar generateOnBlur = function generateOnBlur(_ref3) {\n  var setTouched = _ref3.setTouched,\n      onBlur = _ref3.onBlur;\n  return function (e) {\n    setTouched(true);\n\n    if (onBlur) {\n      onBlur(e);\n    }\n  };\n};\n\nvar generateValue = function generateValue(_ref4) {\n  var fieldType = _ref4.fieldType,\n      maskedValue = _ref4.maskedValue,\n      multiple = _ref4.multiple,\n      value = _ref4.value;\n\n  switch (fieldType) {\n    case 'text':\n    case 'number':\n      return !maskedValue && maskedValue !== 0 ? '' : maskedValue;\n\n    case 'textArea':\n      return !maskedValue ? '' : maskedValue;\n\n    case 'select':\n      return value || (multiple ? [] : '');\n\n    case 'checkbox':\n      return !!value;\n\n    default:\n      return value;\n  }\n};\n\nvar generateFieldType = function generateFieldType(fieldType) {\n  switch (fieldType) {\n    case 'text':\n      return fieldType;\n\n    case 'number':\n      return fieldType;\n\n    case 'checkbox':\n      return fieldType;\n\n    default:\n      return;\n  }\n};\n\nvar validateRequired = function validateRequired(value, required) {\n  if (required && (value == null || value === '')) {\n    return typeof required === 'string' ? required : 'This field is required';\n  }\n};\n\nfunction useField() {\n  var fieldProps = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var userRef = arguments.length > 1 ? arguments[1] : undefined;\n\n  // Pull props off of field props\n  var field = fieldProps.field,\n      validationFunc = fieldProps.validate,\n      asyncValidate = fieldProps.asyncValidate,\n      validationSchema = fieldProps.validationSchema,\n      mask = fieldProps.mask,\n      maskWithCursorOffset = fieldProps.maskWithCursorOffset,\n      format = fieldProps.format,\n      parse = fieldProps.parse,\n      formatter = fieldProps.formatter,\n      parser = fieldProps.parser,\n      initialValue = fieldProps.initialValue,\n      validateOnChange = fieldProps.validateOnChange,\n      validateOnBlur = fieldProps.validateOnBlur,\n      validateOnMount = fieldProps.validateOnMount,\n      asyncValidateOnBlur = fieldProps.asyncValidateOnBlur,\n      asyncValidateOnMount = fieldProps.asyncValidateOnMount,\n      maskOnBlur = fieldProps.maskOnBlur,\n      allowEmptyString = fieldProps.allowEmptyString,\n      onValueChange = fieldProps.onValueChange,\n      notify = fieldProps.notify,\n      keepState = fieldProps.keepState,\n      maintainCursor = fieldProps.maintainCursor,\n      debug = fieldProps.debug,\n      shadow = fieldProps.shadow,\n      step = fieldProps.step,\n      fieldType = fieldProps.fieldType,\n      multiple = fieldProps.multiple,\n      onChange = fieldProps.onChange,\n      onBlur = fieldProps.onBlur,\n      formController = fieldProps.formController,\n      userRelevant = fieldProps.relevant,\n      required = fieldProps.required,\n      keepStateIfRelevant = fieldProps.keepStateIfRelevant,\n      initialize = fieldProps.initialize,\n      _fieldProps$formatter = fieldProps.formatterDependencies,\n      formatterDependencies = _fieldProps$formatter === void 0 ? [] : _fieldProps$formatter,\n      userProps = _objectWithoutProperties(fieldProps, [\"field\", \"validate\", \"asyncValidate\", \"validationSchema\", \"mask\", \"maskWithCursorOffset\", \"format\", \"parse\", \"formatter\", \"parser\", \"initialValue\", \"validateOnChange\", \"validateOnBlur\", \"validateOnMount\", \"asyncValidateOnBlur\", \"asyncValidateOnMount\", \"maskOnBlur\", \"allowEmptyString\", \"onValueChange\", \"notify\", \"keepState\", \"maintainCursor\", \"debug\", \"shadow\", \"step\", \"fieldType\", \"multiple\", \"onChange\", \"onBlur\", \"formController\", \"relevant\", \"required\", \"keepStateIfRelevant\", \"initialize\", \"formatterDependencies\"]); // Create ref to a field id\n\n\n  var _useState = useState(uuidv4()),\n      _useState2 = _slicedToArray(_useState, 1),\n      fieldId = _useState2[0]; // Grab the form register context\n\n\n  var updater = useContext(FormRegisterContext); // Grab multistepContext\n\n  var multistepContext = useContext(MultistepStepContext);\n  var inMultistep = multistepContext || keepStateIfRelevant; // Grab the form api\n\n  var formApi = useFormApi(); // Create ref to fieldApi\n\n  var fieldApiRef = useRef(); // Create initial render ref\n\n  var initialRenerRef = useRef(true); // Create ref to fieldObject\n\n  var fieldObjectRef = useRef(); // Create ref for pristine and dirty\n\n  var valueTouched = useRef(false); // Getters for value ref\n\n  var getPristine = function getPristine() {\n    return !valueTouched.current;\n  };\n\n  var getDirty = function getDirty() {\n    return valueTouched.current;\n  }; // If the form Controller was passed in then use that instead\n\n\n  if (formController) {\n    updater = formController.updater;\n    formApi = formController.getFormApi();\n  } // Generate validation function\n\n\n  var validate = generateValidationFunction(validationFunc, validationSchema, {\n    required: required\n  }); // Grab possible initial value from form\n\n  var _useState3 = useState(function () {\n    return updater.getInitialValue(field);\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      formInitialValue = _useState4[0]; // We might have keep state so check for it!\n\n\n  var savedState = updater.getSavedValue(field); // Create Initial Values\n\n  var initVal;\n  var initTouched; // We do these checks because initial value could be false or zero!!\n\n  if ((keepState || inMultistep) && savedState) {\n    logger(\"Setting field \".concat(name, \"'s kept state\"), savedState);\n    initVal = savedState.value;\n    initTouched = savedState.touched; // Remove the saved state\n\n    formApi.removeSavedState(name);\n  } else if (initialValue != undefined) {\n    initVal = initialValue;\n  } else {\n    initVal = formInitialValue;\n  } // Initialize state\n\n\n  var _useStateWithGetter = useStateWithGetter(initializeValue(initVal, mask, formatter, parser, initialize)),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      value = _useStateWithGetter2[0],\n      setVal = _useStateWithGetter2[1],\n      getTheVal = _useStateWithGetter2[2];\n\n  var _useStateWithGetter3 = useStateWithGetter(validateOnMount ? validate(value) : undefined),\n      _useStateWithGetter4 = _slicedToArray(_useStateWithGetter3, 3),\n      error = _useStateWithGetter4[0],\n      setErr = _useStateWithGetter4[1],\n      getErr = _useStateWithGetter4[2];\n\n  var _useStateWithGetter5 = useStateWithGetter(initTouched),\n      _useStateWithGetter6 = _slicedToArray(_useStateWithGetter5, 3),\n      touched = _useStateWithGetter6[0],\n      setTouch = _useStateWithGetter6[1],\n      getTouch = _useStateWithGetter6[2];\n\n  var _useState5 = useState(function () {\n    return initializeMask(value, format, parse, formatter);\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      maskedValue = _useState6[0],\n      setMaskedValue = _useState6[1];\n\n  var maskedValueRef = useRef();\n  maskedValueRef.current = maskedValue; // Create then update refs to props\n\n  var initialValueRef = useRef(initialValue);\n  var fieldRef = useRef(field);\n  var prevFieldRef = useRef();\n  initialValueRef.current = initialValue;\n  fieldRef.current = field; // Create ref to input\n\n  var internalRef = useRef(null);\n  var ref = React.useMemo(function () {\n    return userRef || internalRef;\n  }, []); // Setup cursor position tracking\n\n  var _useCursorPosition = useCursorPosition({\n    value: value,\n    inputRef: ref,\n    maintainCursor: !!maintainCursor\n  }),\n      getCursor = _useCursorPosition.getCursor,\n      setCursor = _useCursorPosition.setCursor,\n      setCursorOffset = _useCursorPosition.setCursorOffset; // Default relevant function\n\n\n  var relevantFunc = function relevantFunc() {\n    return true;\n  };\n\n  var relevant = function relevant(params) {\n    var rel = userRelevant || relevantFunc;\n    var ff = formApi.getFullField(fieldRef.current) || fieldRef.current;\n    var args = {\n      path: ff,\n      parentPath: ff.replace(/(.*)[.[].*/, '$1'),\n      get: function get(values, path) {\n        return ObjectMap.get(values, path);\n      }\n    };\n\n    if (multistepContext && multistepContext.relevant) {\n      return rel(params, args) && multistepContext.relevant(params, args);\n    }\n\n    return rel(params, args);\n  };\n\n  var _useStateWithGetter7 = useStateWithGetter(relevant(formApi.getValues())),\n      _useStateWithGetter8 = _slicedToArray(_useStateWithGetter7, 3),\n      isRelevant = _useStateWithGetter8[0],\n      setIsRelevant = _useStateWithGetter8[1],\n      getIsRelevant = _useStateWithGetter8[2];\n\n  var multistepRelevant = function multistepRelevant(params) {\n    if (multistepContext && multistepContext.relevant) {\n      return multistepContext.relevant(params);\n    }\n\n    return true;\n  };\n\n  var checkRelevant = function checkRelevant() {\n    var newRel = relevant(formApi.getValues());\n    var curRel = getIsRelevant();\n\n    if (newRel != curRel) {\n      setIsRelevant(newRel);\n    }\n\n    return newRel;\n  };\n\n  useEffect(function () {\n    // Reset if we dont have keep state and relevance changed.\n    if (!isRelevant && !keepState) {\n      fieldApiRef.current.reset();\n    }\n  }, [isRelevant]);\n  useEffect(function () {\n    if (asyncValidate && asyncValidateOnMount) {\n      asyncValidate(getVal(), formApi.getValues());\n    }\n  }, [asyncValidateOnMount, asyncValidate]); // Special getter to support shadow fields\n\n  var getVal = function getVal() {\n    return shadow ? formApi.getDerrivedValue(field) : getTheVal();\n  };\n  /* ---------------------- Setters ---------------------- */\n  // ---- Define set error ----\n\n\n  var setError = function setError(val) {\n    var _ref5 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        preventUpdate = _ref5.preventUpdate;\n\n    // For multistep forms always set error to undefined when not at that step\n    if (step && formApi.getStep() < step) {\n      logger(\"Setting \".concat(field, \"'s error to undefined as we are not at that step\"));\n      setErr(undefined);\n      updater.setError(fieldId, undefined, !preventUpdate);\n    } else {\n      logger(\"Setting \".concat(field, \"'s error to \").concat(val));\n      setErr(val);\n      updater.setError(fieldId, val, !preventUpdate);\n    }\n  }; // ---- Define set value ----\n\n\n  var setValue = function setValue(v, e) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var val = v; // This value has now been modified\n\n    valueTouched.current = true;\n    logger(\"Setting \".concat(field, \" to \").concat(val)); // Set value may have been called externally\n    // NOT from an inputs change event ( onChange )\n    // Therefore, as a precausion, we call the initialize function to format it just in case\n\n    if (initialize) {\n      val = initialize(val);\n    } // Get the most up to date options\n\n\n    var formOptions = formApi.getOptions(); // Initialize maked value\n\n    var maskedVal = val;\n\n    if (val === '' && !allowEmptyString && !options.allowEmptyString && !formOptions.allowEmptyStrings) {\n      val = undefined;\n    } // Turn string into number for number fields\n\n\n    if ((fieldProps.type === 'number' || fieldType === 'number') && val !== undefined) {\n      val = +val;\n    } // Remember Cursor position!\n\n\n    if (e && e.target && e.target.selectionStart) {\n      setCursor(e.target.selectionStart);\n    } // Call mask if it was passed\n\n\n    if (mask && !maskOnBlur) {\n      maskedVal = mask(val, getCursor());\n      val = mask(val, getCursor());\n    } // Call maskWithCursorOffset if it was passed\n\n\n    if (maskWithCursorOffset && !maskOnBlur) {\n      var res = maskWithCursorOffset(val, getCursor());\n      maskedVal = res.value;\n      val = res.value;\n      setCursorOffset(res.offset);\n    } // Call format and parse if they were passed\n\n\n    if (format && parse) {\n      // Masked value only differs from value when format and parse are used\n      val = parse(val);\n      maskedVal = format(val);\n    } // Call formatter and parser if passed\n\n\n    if (formatter) {\n      var _res = informedFormat(val, formatter);\n\n      setCursorOffset(_res.offset);\n      maskedVal = _res.value;\n      val = maskedVal;\n    } // // Only parse if parser was passed\n\n\n    if (parser) {\n      val = val != null ? parser(val) : val;\n    } // We only need to call validate if the user gave us one\n    // and they want us to validate on change && its not the initial validation\n\n\n    if (validate && validateOnChange && !options.initial) {\n      logger(\"Validating after change \".concat(field, \" \").concat(val));\n      setError(validate(val, formApi.getValues()));\n    } // Now we update the value\n\n\n    setVal(val);\n    setMaskedValue(maskedVal); // If the user passed in onValueChange then call it!\n\n    if (onValueChange) {\n      onValueChange(val);\n    } // Call the updater\n\n\n    updater.setValue(fieldId, val, !options.preventUpdate);\n  };\n\n  useUpdateEffect(function () {\n    fieldApiRef.current.setValue(maskedValueRef.current);\n  }, _toConsumableArray(formatterDependencies)); // ---- Define set touched ----\n\n  var setTouched = function setTouched(val, reset) {\n    var _ref6 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n        preventUpdate = _ref6.preventUpdate;\n\n    logger(\"Field \".concat(field, \" has been touched\")); // We only need to call validate if the user gave us one\n    // and they want us to validate on blur\n\n    if (validate && validateOnBlur && !reset && val) {\n      logger(\"Validating after blur \".concat(field, \" \").concat(getVal()));\n      setError(validate(getVal(), formApi.getValues()));\n    } // Same for async\n\n\n    if (asyncValidate && asyncValidateOnBlur && !reset && val) {\n      logger(\"Validating async after blur \".concat(field, \" \").concat(getVal()));\n      asyncValidate(getVal(), formApi.getValues());\n    } // Call mask if it was passed\n\n\n    if (mask && maskOnBlur) {\n      // Generate the masked value from the current value\n      var maskedVal = mask(getVal()); // Now we update the value\n\n      setVal(maskedVal);\n      setMaskedValue(maskedVal); // If the user passed in onValueChange then call it!\n\n      if (onValueChange) {\n        onValueChange(maskedVal);\n      } // Call the updater\n\n\n      updater.setValue(fieldId, maskedVal, !preventUpdate);\n    } // Call maskWithCursorOffset if it was passed\n\n\n    if (maskWithCursorOffset && maskOnBlur) {\n      // Generate the mask and offset\n      var res = maskWithCursorOffset(getVal()); // Set the offset\n\n      setCursorOffset(res.offset); // Now we update the value\n\n      setVal(res.value);\n      setMaskedValue(res.value); // If the user passed in onValueChange then call it!\n\n      if (onValueChange) {\n        onValueChange(res.value);\n      } // Call the updater\n\n\n      updater.setValue(fieldId, res.value, !preventUpdate);\n    } // Finally we set touched and call the updater\n\n\n    setTouch(val);\n    updater.setTouched(fieldId, val, !preventUpdate);\n  }; // ---- Define reset ----\n\n\n  var reset = function reset() {\n    var _ref7 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        preventUpdate = _ref7.preventUpdate;\n\n    var initVal = initializeValue(initialValueRef.current || updater.getInitialValue(fieldRef.current), mask, formatter, parser, initialize); // TODO support numbers\n\n    setValue(initVal, null, {\n      initial: true,\n      preventUpdate: preventUpdate\n    }); // Setting somthing to undefined will remove it\n\n    setError(validateOnMount ? validate(initVal) : undefined, {\n      preventUpdate: preventUpdate\n    });\n    setTouched(undefined, true, {\n      preventUpdate: preventUpdate\n    });\n\n    if (asyncValidateOnMount && asyncValidate) {\n      asyncValidate(getVal(), formApi.getValues());\n    } // We are now at our initial state\n\n\n    valueTouched.current = false;\n  }; // ---- Define validate ----\n  // Note: it takes values as an optimization for when\n  // the form controller calls it ( dont need to generate all values )\n  // over and over :)\n\n\n  var fieldValidate = function fieldValidate(values) {\n    if (validate) {\n      logger(\"Field validating \".concat(field, \" \").concat(getVal()));\n      setError(validate(getVal(), values || formApi.getValues()));\n    }\n  };\n\n  var fieldAsyncValidate = function fieldAsyncValidate(values) {\n    if (asyncValidate) {\n      logger(\"Field async validating \".concat(field, \" \").concat(getVal()));\n      asyncValidate(getVal(), values || formApi.getValues());\n    }\n  };\n  /* ----------------- Field Api && State ----------------- */\n  // Build the field api\n\n\n  var fieldApi = {\n    setValue: setValue,\n    setTouched: setTouched,\n    setError: setError,\n    reset: reset,\n    validate: fieldValidate,\n    asyncValidate: fieldAsyncValidate,\n    getValue: getVal,\n    getTouched: getTouch,\n    getError: getErr,\n    getIsRelevant: getIsRelevant,\n    getDirty: getDirty,\n    getPristine: getPristine,\n    getFieldState: function getFieldState() {\n      return {\n        value: getVal(),\n        touched: getTouch(),\n        dirty: getDirty(),\n        pristine: getPristine()\n      };\n    },\n    relevant: relevant,\n    multistepRelevant: multistepRelevant,\n    checkRelevant: checkRelevant\n  };\n  fieldApiRef.current = fieldApi; // Build the field state\n\n  var fieldState = {\n    value: value,\n    error: error,\n    touched: touched,\n    maskedValue: maskedValue,\n    isRelevant: isRelevant,\n    dirty: valueTouched.current,\n    pristine: !valueTouched.current\n  }; // Create shadow state if this is a shadow field\n\n  if (shadow) {\n    fieldState = {\n      error: error,\n      touched: touched\n    };\n  }\n\n  logger('Render', formApi.getFullField(field), fieldState); // We want to register and deregister this field\n\n  useIsomorphicLayoutEffect(function () {\n    var fullField = formApi.getFullField(fieldRef.current);\n    logger('Register', fieldId, fieldRef.current);\n    fieldObjectRef.current = {\n      field: fullField,\n      fieldId: fieldId,\n      fieldApi: fieldApi,\n      fieldState: fieldState,\n      notify: notify,\n      keepState: keepState,\n      inMultistep: inMultistep,\n      shadow: shadow\n    };\n    updater.register(fieldId, fieldObjectRef.current);\n    return function () {\n      var fullField = formApi.getFullField(fieldRef.current);\n      logger('Deregister', fieldId, fullField);\n      updater.deregister(fieldId);\n    };\n  }, []); // We want to let the controller know of changes on this field when specific props change\n\n  useEffect(function () {\n    var fullField = formApi.getFullField(field);\n\n    if (initialRenerRef.current) {\n      initialRenerRef.current = false;\n    } else {\n      logger('Update', field, inMultistep);\n      fieldObjectRef.current.field = fullField;\n      updater.update(fieldId, fieldObjectRef.current, prevFieldRef.current);\n    }\n\n    return function () {\n      prevFieldRef.current = fullField;\n    };\n  }, [field]); // Maintain cursor position\n  // useLayoutEffect(\n  //   () => {\n  //     if (maintainCursor && ref.current != null && getCursor())\n  //       ref.current.selectionEnd = getCursor() + getCursorOffset();\n  //   },\n  //   [value]\n  // );\n  // for debugging\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && ref) {\n      ref.current.style.border = '5px solid orange';\n      setTimeout(function () {\n        ref.current.style.borderWidth = '2px';\n        ref.current.style.borderStyle = 'inset';\n        ref.current.style.borderColor = 'initial';\n        ref.current.style.borderImage = 'initial';\n      }, 500);\n    }\n  }); // This is an awesome optimization!!\n\n  var shouldUpdate = [].concat(_toConsumableArray(Object.values(fieldState)), _toConsumableArray(Object.values(fieldProps)), _toConsumableArray(Object.values(userProps)));\n\n  var render = function render(children) {\n    return useMemo(function () {\n      return isRelevant ? children : null;\n    }, _toConsumableArray(shouldUpdate));\n  }; // const render = children => {\n  //   // console.log('RENDER', field);\n  //   return isRelevant ? children : null;\n  // };\n  // Build some setub fields so users can easily intagrate without any hookup code\n\n\n  var name = field;\n  var changeHandler = generateOnChange({\n    fieldType: fieldType,\n    setValue: setValue,\n    onChange: onChange,\n    multiple: multiple,\n    ref: ref\n  });\n  var blurHandler = generateOnBlur({\n    setTouched: setTouched,\n    onBlur: onBlur\n  });\n  var hookedValue = generateValue({\n    fieldType: fieldType,\n    maskedValue: maskedValue,\n    multiple: multiple,\n    value: value\n  });\n  var type = generateFieldType(fieldType);\n  return {\n    fieldState: fieldState,\n    fieldApi: fieldApi,\n    render: render,\n    ref: ref,\n    userProps: _objectSpread2(_objectSpread2({}, userProps), {}, {\n      multiple: multiple,\n      // WE NEED TO PUT THESE BACK!!\n      onChange: onChange,\n      // WE NEED TO PUT THESE BACK!!\n      onBlur: onBlur,\n      // WE NEED TO PUT THESE BACK!!\n      // required // WE NEED TO PUT THESE BACK!!\n      id: userProps.id || fieldId // If user did not pass id we pass fields id\n\n    }),\n    informed: _objectSpread2({\n      name: name,\n      multiple: multiple,\n      onChange: changeHandler,\n      onBlur: blurHandler,\n      value: hookedValue,\n      ref: ref,\n      type: type,\n      id: userProps.id || fieldId\n    }, userProps)\n  };\n}\n\nvar asField = function asField(Component) {\n  var forwardRef = /*#__PURE__*/React.forwardRef(function (props, userRef) {\n    var _useField = useField(props, userRef),\n        fieldState = _useField.fieldState,\n        fieldApi = _useField.fieldApi,\n        render = _useField.render,\n        ref = _useField.ref,\n        userProps = _useField.userProps;\n\n    return render( /*#__PURE__*/React.createElement(Component, _extends({\n      fieldApi: fieldApi,\n      fieldState: fieldState,\n      field: props.field,\n      forwardedRef: ref,\n      debug: props.debug,\n      type: props.type\n    }, userProps)));\n  });\n  forwardRef.displayName = \"asField(\".concat(getChildDisplayName(Component), \")\");\n  return forwardRef;\n};\n\nvar logger$1 = debug('informed:Text' + '\\t');\n\nvar Text = function Text(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var maskedValue = fieldState.maskedValue;\n  var setValue = fieldApi.setValue,\n      setTouched = fieldApi.setTouched;\n\n  var _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      forwardedRef = props.forwardedRef,\n      debug = props.debug,\n      label = props.label,\n      title = props.title,\n      id = props.id,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"forwardedRef\", \"debug\", \"label\", \"title\", \"id\"]);\n\n  logger$1('Render', field); // for debugging\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && forwardedRef) {\n      forwardedRef.current.style.background = 'red';\n      setTimeout(function () {\n        forwardedRef.current.style.background = 'white';\n      }, 500);\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"input\", _extends({}, rest, {\n    id: id,\n    name: field,\n    ref: forwardedRef,\n    value: !maskedValue && maskedValue !== 0 ? '' : maskedValue,\n    onChange: function onChange(e) {\n      setValue(e.target.value, e);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    }\n  })));\n};\nvar Text$1 = asField(Text);\n\nvar TextArea = function TextArea(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var maskedValue = fieldState.maskedValue;\n  var setValue = fieldApi.setValue,\n      setTouched = fieldApi.setTouched;\n\n  var _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      forwardedRef = props.forwardedRef,\n      debug = props.debug,\n      label = props.label,\n      id = props.id,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"forwardedRef\", \"debug\", \"label\", \"id\"]); // for debugging\n\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && forwardedRef) {\n      forwardedRef.current.style.background = 'red';\n      setTimeout(function () {\n        forwardedRef.current.style.background = 'white';\n      }, 500);\n    }\n  });\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"textarea\", _extends({}, rest, {\n    id: id,\n    name: field,\n    ref: forwardedRef,\n    value: !maskedValue ? '' : maskedValue,\n    onChange: function onChange(e) {\n      setValue(e.target.value, e);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    }\n  })));\n};\nvar TextArea$1 = asField(TextArea);\n\nvar logger$2 = debug('informed:Select' + '\\t');\n\nvar Select = function Select(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var value = fieldState.value;\n  var setTouched = fieldApi.setTouched;\n\n  var onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      options = props.options,\n      children = props.children,\n      forwardedRef = props.forwardedRef,\n      debug = props.debug,\n      multiple = props.multiple,\n      label = props.label,\n      id = props.id,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"options\", \"children\", \"forwardedRef\", \"debug\", \"multiple\", \"label\", \"id\"]);\n\n  var selectRef = useRef();\n\n  var handleChange = function handleChange(e) {\n    var selected = Array.from((forwardedRef || selectRef).current).filter(function (option) {\n      return option.selected;\n    }).map(function (option) {\n      return option.value;\n    });\n    fieldApi.setValue(multiple ? selected : selected[0] || '');\n\n    if (onChange && e) {\n      onChange(e);\n    }\n  }; // for debugging\n\n\n  useIsomorphicLayoutEffect(function () {\n    if (debug && forwardedRef) {\n      forwardedRef.current.style.background = 'red';\n      setTimeout(function () {\n        forwardedRef.current.style.background = 'white';\n      }, 500);\n    }\n  });\n  logger$2('Render', field, value);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"select\", _extends({}, rest, {\n    id: id,\n    multiple: multiple,\n    name: field,\n    ref: forwardedRef || selectRef,\n    value: value || (multiple ? [] : ''),\n    onChange: handleChange,\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    }\n  }), options ? options.map(function (option) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: option.value,\n      value: option.value,\n      disabled: option.disabled\n    }, option.label);\n  }) : children));\n};\nvar Select$1 = asField(Select);\n\nvar Checkbox = function Checkbox(_ref) {\n  var fieldApi = _ref.fieldApi,\n      fieldState = _ref.fieldState,\n      props = _objectWithoutProperties(_ref, [\"fieldApi\", \"fieldState\"]);\n\n  var value = fieldState.value;\n  var setValue = fieldApi.setValue,\n      setTouched = fieldApi.setTouched;\n\n  var _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      debug = props.debug,\n      forwardedRef = props.forwardedRef,\n      id = props.id,\n      label = props.label,\n      rest = _objectWithoutProperties(props, [\"onChange\", \"onBlur\", \"field\", \"initialValue\", \"debug\", \"forwardedRef\", \"id\", \"label\"]);\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, label ? /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: id\n  }, \" \", label, \" \") : null, /*#__PURE__*/React.createElement(\"input\", _extends({}, rest, {\n    id: id,\n    name: field,\n    ref: forwardedRef,\n    checked: !!value,\n    onChange: function onChange(e) {\n      setValue(e.target.checked);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n    },\n    type: \"checkbox\"\n  })));\n};\nvar Checkbox$1 = asField(Checkbox);\n\nvar withRadioGroup = function withRadioGroup(Component) {\n  return /*#__PURE__*/React.forwardRef(function (props, ref) {\n    return /*#__PURE__*/React.createElement(GroupContext.Consumer, null, function (_ref) {\n      var radioGroupApi = _ref.radioGroupApi,\n          radioGroupState = _ref.radioGroupState;\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        radioGroupApi: radioGroupApi,\n        radioGroupState: radioGroupState,\n        ref: ref\n      }, props));\n    });\n  });\n};\n\nvar Radio = function Radio(_ref) {\n  var radioGroupApi = _ref.radioGroupApi,\n      radioGroupState = _ref.radioGroupState,\n      props = _objectWithoutProperties(_ref, [\"radioGroupApi\", \"radioGroupState\"]);\n\n  var groupValue = radioGroupState.value;\n  var setValue = radioGroupApi.setValue,\n      setTouched = radioGroupApi.setTouched,\n      groupOnChange = radioGroupApi.onChange,\n      groupOnBlur = radioGroupApi.onBlur;\n\n  var value = props.value,\n      _onChange = props.onChange,\n      _onBlur = props.onBlur,\n      field = props.field,\n      initialValue = props.initialValue,\n      forwardedRef = props.forwardedRef,\n      rest = _objectWithoutProperties(props, [\"value\", \"onChange\", \"onBlur\", \"field\", \"initialValue\", \"forwardedRef\"]);\n\n  return /*#__PURE__*/React.createElement(\"input\", _extends({}, rest, {\n    name: field,\n    ref: forwardedRef,\n    value: value,\n    checked: groupValue === value,\n    onChange: function onChange(e) {\n      if (!e.target.checked) {\n        return;\n      }\n\n      setValue(value);\n\n      if (_onChange) {\n        _onChange(e);\n      }\n\n      if (groupOnChange) {\n        groupOnChange(e);\n      }\n    },\n    onBlur: function onBlur(e) {\n      setTouched(true);\n\n      if (_onBlur) {\n        _onBlur(e);\n      }\n\n      if (groupOnBlur) {\n        groupOnBlur(e);\n      }\n    },\n    type: \"radio\"\n  }));\n};\nvar Radio$1 = withRadioGroup(Radio);\n\nvar RadioGroup = /*#__PURE__*/function (_Component) {\n  _inherits(RadioGroup, _Component);\n\n  var _super = _createSuper(RadioGroup);\n\n  function RadioGroup() {\n    _classCallCheck(this, RadioGroup);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(RadioGroup, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          options = _this$props.options,\n          children = _this$props.children;\n      return /*#__PURE__*/React.createElement(GroupContext.Provider, {\n        value: this.groupContext\n      }, options ? options.map(function (option) {\n        return /*#__PURE__*/React.createElement(\"label\", {\n          key: option.value\n        }, option.label, \" \", /*#__PURE__*/React.createElement(Radio$1, {\n          value: option.value\n        }));\n      }) : children);\n    }\n  }, {\n    key: \"groupContext\",\n    get: function get() {\n      return {\n        radioGroupApi: _objectSpread2(_objectSpread2({}, this.props.fieldApi), {}, {\n          onChange: this.props.onChange,\n          onBlur: this.props.onBlur\n        }),\n        radioGroupState: this.props.fieldState\n      };\n    }\n  }]);\n\n  return RadioGroup;\n}(Component);\nvar RadioGroup$1 = asField(RadioGroup);\n\nfunction useArrayFieldApi() {\n  return useContext(ArrayFieldApiContext);\n}\n\nvar AddButton = function AddButton() {\n  var _useArrayFieldApi = useArrayFieldApi(),\n      add = _useArrayFieldApi.add;\n\n  return /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      add();\n    },\n    type: \"button\"\n  }, \"Add\");\n};\n\nfunction useArrayFieldItemApi() {\n  return useContext(ArrayFieldItemApiContext);\n}\n\nvar AddButton$1 = function AddButton() {\n  var _useArrayFieldItemApi = useArrayFieldItemApi(),\n      remove = _useArrayFieldItemApi.remove;\n\n  return /*#__PURE__*/React.createElement(\"button\", {\n    onClick: function onClick() {\n      remove();\n    },\n    type: \"button\"\n  }, \"Remove\");\n};\n\nvar logger$3 = debug('informed:useArrayField' + '\\t');\n\nvar useArrayField = function useArrayField(_ref) {\n  var field = _ref.field,\n      initialValue = _ref.initialValue,\n      validate = _ref.validate,\n      arrayFieldApiRef = _ref.arrayFieldApiRef,\n      props = _objectWithoutProperties(_ref, [\"field\", \"initialValue\", \"validate\", \"arrayFieldApiRef\"]);\n\n  // Reference to the form Api\n  var formApi = useFormApi(); // Keep track of fields that belong to this array field\n\n  var _useState = useState(new Map()),\n      _useState2 = _slicedToArray(_useState, 1),\n      fieldsById = _useState2[0]; // Grab the form register context\n\n\n  var updater = useContext(FormRegisterContext); // May be scoped so get full field name!!\n\n  var fullField = formApi.getFullField(field);\n  var initialVals = updater.getInitialValue(field) || initialValue || []; // TODO throw error if initial value and its not array\n  // If keep state was passed into the child inputs we need to maintain the length of\n  // keys, in order to do so we grab the value from informeds api\n\n  var keptValues = formApi.getSavedValue(fullField) && formApi.getSavedValue(fullField).value;\n\n  var _useStateWithGetter = useStateWithGetter(keptValues || initialVals),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      initialValues = _useStateWithGetter2[0],\n      setInitialValues = _useStateWithGetter2[1],\n      getInitialValues = _useStateWithGetter2[2];\n\n  var initialKeys = initialValues ? initialValues.map(function () {\n    return uuidv4();\n  }) : [];\n\n  var _useStateWithGetter3 = useStateWithGetter(initialKeys),\n      _useStateWithGetter4 = _slicedToArray(_useStateWithGetter3, 3),\n      keys = _useStateWithGetter4[0],\n      setKeys = _useStateWithGetter4[1],\n      getKeys = _useStateWithGetter4[2];\n\n  var validateWithLength = useMemo(function () {\n    return function (value, values) {\n      var length = getKeys() == null ? 0 : getKeys().length;\n      return validate ? validate(value, length, values) : undefined;\n    };\n  }); // Register shadow field\n\n  var _useField = useField(_objectSpread2({\n    field: field,\n    validate: validate ? validateWithLength : undefined,\n    shadow: true\n  }, props)),\n      fieldApi = _useField.fieldApi; // Register for events\n\n\n  useIsomorphicLayoutEffect(function () {\n    // Define event handler\n    var onChangeHandler = function onChangeHandler(fieldName) {\n      // Dont do anythign if we updated\n      if (fieldName === fullField) {\n        return;\n      }\n\n      logger$3(\"\".concat(fullField, \" changed\")); // determine if one of our array children triggered this change\n\n      if (RegExp(\"\".concat(fullField, \"\\\\[[0-9]+\\\\]\")).test(fieldName)) {\n        // If it was we need to call validate\n        fieldApi.validate();\n      }\n    }; // Register for events\n\n\n    formApi.emitter.on('value', onChangeHandler); // Unregister events\n\n    return function () {\n      formApi.emitter.removeListener('value', onChangeHandler);\n    };\n  }, [field]);\n\n  var _remove = function remove(i) {\n    // Notify form to expect removal on this field\n    logger$3('EXPECTING REMOVAL OF', \"\".concat(field, \"[\").concat(i, \"] and \").concat(field, \"[\").concat(keys.length - 1, \"]\"));\n    updater.expectRemoval(\"\".concat(field, \"[\").concat(i, \"]\"));\n    updater.expectRemoval(\"\".concat(field, \"[\").concat(keys.length - 1, \"]\")); // Remove the key\n\n    var newKeys = keys.slice(0, i).concat(keys.slice(i + 1, keys.length));\n    setKeys(newKeys); // Remove the initial value ( user wanted to get rid of that input )\n\n    var initVals = getInitialValues();\n    var newInitialValues = initVals.slice(0, i).concat(initVals.slice(i + 1, initVals.length));\n    setInitialValues(newInitialValues); //formApi.setInitialValue(field, newInitialValues);\n  };\n\n  var swap = function swap(a, b) {\n    logger$3('Swapping', \"\".concat(field, \"[\").concat(a, \"] and \").concat(field, \"[\").concat(b, \"]\")); // Swap the keys\n\n    var newKeys = _toConsumableArray(keys);\n\n    if (keys[a] && keys[b]) {\n      newKeys[a] = keys[b];\n      newKeys[b] = keys[a];\n    } else {\n      // eslint-disable-next-line no-console\n      console.warn(\"Attempted to swap \".concat(a, \" with \").concat(b, \" but one of them does not exist :(\"));\n    }\n\n    setKeys(newKeys);\n  };\n\n  var add = function add() {\n    keys.push(uuidv4());\n    setKeys(_toConsumableArray(keys));\n  };\n\n  var addWithInitialValue = function addWithInitialValue(initialValue) {\n    keys.push(uuidv4());\n    setKeys(_toConsumableArray(keys));\n\n    var newInitialValues = _toConsumableArray(getInitialValues());\n\n    newInitialValues[keys.length - 1] = initialValue;\n    setInitialValues(newInitialValues);\n  };\n\n  var reset = function reset() {\n    // When resetting we reset to the users initial value not the one tracked by this hook\n    var initVals = updater.getInitialValue(field) || initialValue || []; // Set our initial values back to what the user set at beginning\n\n    setInitialValues(initVals); // Build a new set of keys because everything is new !!!\n\n    var resetKeys = initVals ? initVals.map(function () {\n      return uuidv4();\n    }) : []; // Finally set that shit !\n\n    setKeys(resetKeys);\n  };\n\n  var fields = keys.map(function (key, i) {\n    var arrayFieldItemApi = {\n      remove: function remove() {\n        return _remove(i);\n      }\n    };\n    var arrayFieldItemState = {\n      initialValue: initialValues && initialValues[i],\n      key: key,\n      field: \"\".concat(field, \"[\").concat(i, \"]\"),\n      index: i\n    };\n    return _objectSpread2(_objectSpread2({\n      arrayFieldItemApi: arrayFieldItemApi,\n      arrayFieldItemState: arrayFieldItemState\n    }, arrayFieldItemApi), arrayFieldItemState);\n  });\n  var arrayFieldApi = {\n    add: add,\n    swap: swap,\n    addWithInitialValue: addWithInitialValue,\n    reset: reset\n  };\n\n  if (arrayFieldApiRef) {\n    arrayFieldApiRef.current = arrayFieldApi;\n  }\n\n  var arrayFieldState = {\n    fields: fields,\n    field: field\n  }; // Wrap the updater to update array fields references\n\n  var wrappedUpdator = _objectSpread2(_objectSpread2({}, updater), {}, {\n    register: function register(id, fld) {\n      fieldsById.set(id, fld);\n\n      for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        args[_key - 2] = arguments[_key];\n      }\n\n      updater.register.apply(updater, [id, fld].concat(args));\n    },\n    deregister: function deregister(id) {\n      fieldsById[\"delete\"](id);\n\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      updater.deregister.apply(updater, [id].concat(args));\n    },\n    getInitialValue: function getInitialValue(fieldName) {\n      // If we are getting initial value and its for this field return that\n      if (RegExp(\"\".concat(fullField, \"\\\\[[0-9]+\\\\]\")).test(fieldName)) {\n        var path = fieldName.replace(field, '');\n        var v = ObjectMap.get(getInitialValues(), path);\n        logger$3(\"Resetting \".concat(path, \" to \").concat(v));\n        return v;\n      }\n\n      return updater.getInitialValue(fieldName);\n    }\n  });\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n      value: wrappedUpdator\n    }, /*#__PURE__*/React.createElement(ArrayFieldApiContext.Provider, {\n      value: arrayFieldApi\n    }, /*#__PURE__*/React.createElement(ArrayFieldStateContext.Provider, {\n      value: arrayFieldState\n    }, children)));\n  };\n\n  return {\n    render: render,\n    add: add,\n    swap: swap,\n    addWithInitialValue: addWithInitialValue,\n    fields: fields,\n    arrayFieldState: arrayFieldState,\n    arrayFieldApi: arrayFieldApi,\n    field: field\n  };\n};\n\nvar buildScopedFormApi = function buildScopedFormApi(scope, formApi) {\n  return _objectSpread2(_objectSpread2({}, formApi), {}, {\n    getValue: function getValue(field) {\n      return formApi.getValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getTouched: function getTouched(field) {\n      return formApi.getTouched(\"\".concat(scope, \".\").concat(field));\n    },\n    getError: function getError(field) {\n      return formApi.getError(\"\".concat(scope, \".\").concat(field));\n    },\n    setValue: function setValue(field, value) {\n      return formApi.setValue(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setTouched: function setTouched(field, value) {\n      return formApi.setTouched(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setError: function setError(field, value) {\n      return formApi.setError(\"\".concat(scope, \".\").concat(field), value);\n    },\n    getInitialValue: function getInitialValue(field) {\n      return formApi.getInitialValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getSavedValue: function getSavedValue(field) {\n      return formApi.getSavedValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getFullField: function getFullField(field) {\n      return \"\".concat(formApi.getFullField(scope), \".\").concat(field);\n    }\n  });\n};\n\nfunction useScopedApi(scope) {\n  var formApi = useFormApi(); // VERY important to memoize the builder!\n\n  var scopedFormApi = useMemo(function () {\n    return buildScopedFormApi(scope, formApi);\n  }, [scope]);\n  return scopedFormApi;\n}\n\nfunction useFormState() {\n  var formState = useContext(FormStateContext);\n  return formState;\n}\n\nvar Relevant = function Relevant(_ref) {\n  var when = _ref.when,\n      children = _ref.children;\n  var formState = useFormState();\n  var isRelevant = when(formState);\n\n  if (isRelevant) {\n    return children;\n  }\n\n  return null;\n};\n\nvar ArrayField = function ArrayField(_ref) {\n  var relevant = _ref.relevant,\n      field = _ref.field,\n      props = _objectWithoutProperties(_ref, [\"relevant\", \"field\"]);\n\n  // Need to get formApi to have consistant interface for relevant function\n  var formApi = useFormApi();\n\n  if (relevant) {\n    var ff = formApi.getFullField(field);\n    var args = {\n      path: ff,\n      parentPath: ff.replace(/(.*)[.[].*/, '$1'),\n      get: function get(values, path) {\n        return ObjectMap.get(values, path);\n      }\n    };\n\n    var when = function when(_ref2) {\n      var values = _ref2.values;\n      return relevant(values, args);\n    };\n\n    return /*#__PURE__*/React.createElement(Relevant, {\n      when: when\n    }, /*#__PURE__*/React.createElement(ArrayFieldWrapper, _extends({\n      field: field\n    }, props)));\n  } else {\n    return /*#__PURE__*/React.createElement(ArrayFieldWrapper, _extends({\n      field: field\n    }, props));\n  }\n};\n\nvar ArrayFieldWrapper = function ArrayFieldWrapper(_ref3) {\n  var children = _ref3.children,\n      props = _objectWithoutProperties(_ref3, [\"children\"]);\n\n  var _useArrayField = useArrayField(props),\n      render = _useArrayField.render,\n      arrayFieldState = _useArrayField.arrayFieldState,\n      arrayFieldApi = _useArrayField.arrayFieldApi,\n      field = _useArrayField.field;\n\n  if (typeof children === 'function') {\n    return render(children(_objectSpread2(_objectSpread2({\n      field: field,\n      arrayFieldApi: arrayFieldApi,\n      arrayFieldState: arrayFieldState\n    }, arrayFieldApi), arrayFieldState)));\n  }\n\n  return render(children);\n};\n\nvar ArrayFieldItem = function ArrayFieldItem(_ref4) {\n  var arrayFieldItemState = _ref4.arrayFieldItemState,\n      arrayFieldItemApi = _ref4.arrayFieldItemApi,\n      children = _ref4.children;\n  // Grab the form register context\n  var updater = useContext(FormRegisterContext); // Grab the form state\n\n  var formApi = useFormApi(); // A little trick I learned in nam to trigger rerender\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1]; // Keep track of fields that belong to this array field\n\n\n  var _useState3 = useState(new Map()),\n      _useState4 = _slicedToArray(_useState3, 1),\n      fieldsById = _useState4[0]; // Get this items field\n\n\n  var field = arrayFieldItemState.field; // Create scoped api\n\n  var scopedApi = useScopedApi(field); // State generation function\n\n  var getState = function getState() {\n    var _formApi$getState = formApi.getState(),\n        values = _formApi$getState.values,\n        errors = _formApi$getState.errors,\n        touched = _formApi$getState.touched; // Get this fields state\n\n\n    var itemState = {\n      values: ObjectMap.get(values, field),\n      errors: ObjectMap.get(errors, field),\n      touched: ObjectMap.get(touched, field)\n    };\n    return itemState;\n  }; // Register for events for rerenders!\n\n\n  useEffect(function () {\n    // Define event handler\n    var onChangeHandler = function onChangeHandler(fieldName) {\n      // Example foo.bar.baz[3].baz >>>> foo.bar.baz[3]\n      var magicValue = fieldName.slice(0, fieldName.lastIndexOf('[') != -1 ? fieldName.lastIndexOf(']') + 1 : fieldName.length); // This field updated so trigger rerender\n\n      if (magicValue === field) {\n        setState(Math.random());\n      }\n    }; // Register for events\n\n\n    formApi.emitter.on('value', onChangeHandler); // Unregister events\n\n    return function () {\n      formApi.emitter.removeListener('value', onChangeHandler);\n    };\n  }, [field]); // Resets all fields in this item\n\n  var reset = function reset() {\n    fieldsById.forEach(function (fld) {\n      fld.fieldApi.reset();\n    });\n  }; // Generate the item state\n\n\n  var itemState = getState(); // Wrap the updater to update array fields references\n\n  var wrappedUpdator = _objectSpread2(_objectSpread2({}, updater), {}, {\n    register: function register(id, fld, initialRender) {\n      fieldsById.set(id, fld);\n      updater.register(id, fld, initialRender);\n    },\n    deregister: function deregister(id) {\n      fieldsById[\"delete\"](id);\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      updater.deregister.apply(updater, [id].concat(args));\n    }\n  });\n\n  var arrayFieldItemApiValue = _objectSpread2(_objectSpread2(_objectSpread2({}, arrayFieldItemApi), scopedApi), {}, {\n    reset: reset\n  });\n\n  var arrayFieldItemStateValue = _objectSpread2(_objectSpread2({}, arrayFieldItemState), itemState);\n\n  if (typeof children === 'function') {\n    return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n      value: wrappedUpdator\n    }, /*#__PURE__*/React.createElement(ArrayFieldItemApiContext.Provider, {\n      value: arrayFieldItemApiValue\n    }, /*#__PURE__*/React.createElement(ArrayFieldItemStateContext.Provider, {\n      value: arrayFieldItemStateValue\n    }, children(_objectSpread2(_objectSpread2({\n      arrayFieldItemApi: arrayFieldItemApiValue,\n      arrayFieldItemState: arrayFieldItemStateValue\n    }, arrayFieldItemApiValue), arrayFieldItemStateValue)))));\n  }\n\n  return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n    value: wrappedUpdator\n  }, /*#__PURE__*/React.createElement(ArrayFieldItemApiContext.Provider, {\n    value: arrayFieldItemApiValue\n  }, /*#__PURE__*/React.createElement(ArrayFieldItemStateContext.Provider, {\n    value: arrayFieldItemStateValue\n  }, children)));\n};\n\nArrayField.Items = function (_ref5) {\n  var children = _ref5.children;\n\n  var _useContext = useContext(ArrayFieldStateContext),\n      fields = _useContext.fields;\n\n  return fields.map(function (_ref6) {\n    var arrayFieldItemState = _ref6.arrayFieldItemState,\n        arrayFieldItemApi = _ref6.arrayFieldItemApi;\n    var key = arrayFieldItemState.key;\n    return /*#__PURE__*/React.createElement(ArrayFieldItem, {\n      key: key,\n      arrayFieldItemApi: arrayFieldItemApi,\n      arrayFieldItemState: arrayFieldItemState\n    }, children);\n  });\n};\n\nvar FormComponents = function FormComponents(_ref) {\n  var components = _ref.components;\n\n  // Get the field map off the forms context\n  var _useContext = useContext(FormRegisterContext),\n      fieldMap = _useContext.fieldMap;\n\n  if (!components) return null;\n  return components.map(function (comp, i) {\n    var componentType = comp['ui:control'];\n    var Component = fieldMap[componentType];\n    return /*#__PURE__*/React.createElement(Component, {\n      key: \"ui-comp-\".concat(i)\n    });\n  });\n};\n\nvar logger$4 = debug('informed:FormFields' + '\\t');\n\nvar FormFields = function FormFields(_ref) {\n  var schema = _ref.schema,\n      prefix = _ref.prefix,\n      onlyValidateSchema = _ref.onlyValidateSchema;\n\n  // Get the field map off the forms context\n  var _useContext = useContext(FormRegisterContext),\n      fieldMap = _useContext.fieldMap; // Get fields from scheama\n\n\n  var fields = useMemo(function () {\n    var schemaFields = computeFieldsFromSchema(schema, onlyValidateSchema, prefix);\n    var mapedFields = schemaFields.map(function (schemaField, i) {\n      var field = schemaField.field,\n          props = schemaField.props,\n          type = schemaField.type,\n          properties = schemaField.properties,\n          items = schemaField.items,\n          componentType = schemaField.componentType,\n          uiBefore = schemaField.uiBefore,\n          uiAfter = schemaField.uiAfter,\n          allOf = schemaField.allOf;\n      var Component = fieldMap[componentType]; // console.log('WTF', schemaField);\n\n      logger$4('Rendering Field', field, schemaField); // Scope for nested\n\n      if (!Component && type === 'object' && properties) {\n        return /*#__PURE__*/React.createElement(FormFields, {\n          schema: schemaField,\n          prefix: field,\n          key: \"ScheamField-\".concat(i)\n        });\n      } // Array field for array ( if none was provided use our default )\n\n\n      if (!Component && type === 'array' && items) {\n        return /*#__PURE__*/React.createElement(ArrayField$1, _extends({\n          key: \"ScheamField-\".concat(i),\n          field: field,\n          items: items,\n          uiBefore: uiBefore,\n          uiAfter: uiAfter\n        }, props));\n      } // User created custom array field\n\n\n      if (Component && componentType === 'array' && items && type === 'array') {\n        return /*#__PURE__*/React.createElement(Component, _extends({\n          key: \"ScheamField-\".concat(i),\n          field: field,\n          items: items,\n          uiBefore: uiBefore,\n          uiAfter: uiAfter\n        }, props));\n      } // For conditionals\n\n\n      if (componentType === 'conditionals') {\n        return allOf.map(function (conditional) {\n          // Example then ( its a subschema )\n          // then: {\n          //   properties: {\n          //     spouse: {\n          //       type: 'string',\n          //       title: 'Spouse name',\n          //       'ui:control': 'input'\n          //     }\n          //   }\n          // }\n          var subSchema = conditional.then; // Turn the if into a when function for informed\n          // Example if condition\n          // if: {\n          //   properties: {\n          //     married: { const: 'yes' }\n          //   },\n          //   required: ['married']\n          // },\n\n          var conditions = conditional[\"if\"].properties;\n\n          var when = function when(_ref2) {\n            var values = _ref2.values;\n            // Example key \"married, Example condition: \"{ const: 'yes' }\"\n            return Object.keys(conditions).every(function (key) {\n              var condition = conditions[key]; // values.married === 'yes'\n\n              return values[key] === condition[\"const\"];\n            });\n          };\n\n          return /*#__PURE__*/React.createElement(Relevant, {\n            key: \"ScheamField-\".concat(i),\n            when: when\n          }, /*#__PURE__*/React.createElement(FormFields, {\n            schema: subSchema\n          }));\n        });\n      } // If no com ret null ( dont render )\n\n\n      if (!Component) {\n        return null;\n      }\n\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        key: \"ScheamField-\".concat(i),\n        field: field\n      }, props));\n    });\n    return mapedFields;\n  }, [schema, prefix]);\n  return fields;\n};\n\nvar ArrayField$1 = function ArrayField$1(_ref) {\n  var field = _ref.field,\n      items = _ref.items,\n      uiBefore = _ref.uiBefore,\n      uiAfter = _ref.uiAfter,\n      props = _objectWithoutProperties(_ref, [\"field\", \"items\", \"uiBefore\", \"uiAfter\"]);\n\n  return /*#__PURE__*/React.createElement(ArrayField, _extends({\n    field: field\n  }, props), /*#__PURE__*/React.createElement(FormComponents, {\n    components: uiBefore\n  }), /*#__PURE__*/React.createElement(ArrayField.Items, null, function (_ref2) {\n    var field = _ref2.field;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FormComponents, {\n      components: items['ui:before']\n    }), /*#__PURE__*/React.createElement(FormFields, {\n      schema: items,\n      prefix: field\n    }), /*#__PURE__*/React.createElement(FormComponents, {\n      components: items['ui:after']\n    }));\n  }), /*#__PURE__*/React.createElement(FormComponents, {\n    components: uiAfter\n  }));\n};\n\nvar defaultFieldMap = {\n  select: Select$1,\n  input: Text$1,\n  textarea: TextArea$1,\n  checkbox: Checkbox$1,\n  radio: RadioGroup$1,\n  add: AddButton,\n  remove: AddButton$1,\n  array: ArrayField$1\n};\n\nvar debug$2 = debug('informed:Controller' + '\\t');\n\nvar isExpected = function isExpected(path, expectedRemovals) {\n  var includedKey = Object.keys(expectedRemovals).find(function (key) {\n    return path.includes(key);\n  });\n  if (!includedKey) return;\n  var start = path.slice(0, includedKey.length);\n  return start === includedKey;\n};\n\nvar noop = function noop() {};\n\nvar FormController = /*#__PURE__*/function () {\n  function FormController() {\n    var _this = this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, FormController);\n\n    this.options = options; // Initialize listeners\n\n    this.subscriptions = new Map();\n    var ajv = options.ajv,\n        schema = options.schema,\n        fieldMap = options.fieldMap; // Create new ajv instance if passed\n\n    this.ajv = ajv ? new ajv({\n      allErrors: true\n    }) : null;\n    this.ajvValidate = ajv ? this.ajv.compile(schema) : null; // Add field map ( defaults to our field map )\n\n    this.fieldMap = fieldMap || defaultFieldMap; // Map will store all fields by id\n    // Key => uuid\n    // Val => fieldObj\n    // Why? so the form can control the fields!\n\n    this.fieldsById = new Map(); // Map will store all fields by name\n    // Key => fieldName - example: \"foo.bar[3].baz\"\n    // Val => fieldObj\n    // Why? so the form can control the fields!\n\n    this.fieldsByName = {\n      get: function get(name) {\n        var fieldByName; // TODO speed this up maybe\n\n        _this.fieldsById.forEach(function (value) {\n          if (value && value.field === name) {\n            fieldByName = value;\n          }\n        });\n\n        return fieldByName;\n      }\n    }; // Map to store whos on the screen\n\n    this.onScreen = {}; // Map to store fields being removed\n\n    this.expectedRemovals = {};\n    this.pulledOut = {}; // Map of saved values\n\n    this.savedValues = {}; // Initialize the controller state\n\n    this.state = {\n      pristine: true,\n      dirty: false,\n      invalid: false,\n      submits: 0,\n      step: 0,\n      validating: 0,\n      submitting: false,\n      values: {},\n      errors: {},\n      touched: {}\n    }; // Initialize a dummy field ( see getField for example use )\n\n    this.dummyField = {\n      fieldApi: {\n        setValue: noop,\n        setTouched: noop,\n        setError: noop,\n        reset: noop,\n        validate: noop,\n        getValue: noop,\n        getTouched: noop,\n        getError: noop,\n        getFieldState: noop,\n        checkRelevant: noop,\n        getPristine: noop,\n        getDirty: noop\n      }\n    }; // Bind functions that will be called externally\n\n    this.deregister = this.deregister.bind(this);\n    this.register = this.register.bind(this);\n    this.getValue = this.getValue.bind(this);\n    this.getTouched = this.getTouched.bind(this);\n    this.getError = this.getError.bind(this);\n    this.getErrors = this.getErrors.bind(this);\n    this.setValue = this.setValue.bind(this);\n    this.getValues = this.getValues.bind(this);\n    this.getStep = this.getStep.bind(this);\n    this.setStep = this.setStep.bind(this);\n    this.back = this.back.bind(this);\n    this.next = this.next.bind(this);\n    this.setCurrent = this.setCurrent.bind(this);\n    this.setTouched = this.setTouched.bind(this);\n    this.setError = this.setError.bind(this);\n    this.setFormError = this.setFormError.bind(this);\n    this.submitForm = this.submitForm.bind(this);\n    this.reset = this.reset.bind(this);\n    this.update = this.update.bind(this);\n    this.validate = this.validate.bind(this);\n    this.screenValid = this.screenValid.bind(this);\n    this.keyDown = this.keyDown.bind(this);\n    this.getField = this.getField.bind(this);\n    this.getInitialValue = this.getInitialValue.bind(this);\n    this.setInitialValue = this.setInitialValue.bind(this);\n    this.getOptions = this.getOptions.bind(this);\n    this.getFormState = this.getFormState.bind(this);\n    this.expectRemoval = this.expectRemoval.bind(this);\n    this.getSavedValue = this.getSavedValue.bind(this);\n    this.removeSavedState = this.removeSavedState.bind(this);\n    this.getDerrivedValue = this.getDerrivedValue.bind(this);\n    this.setValues = this.setValues.bind(this);\n    this.resetField = this.resetField.bind(this);\n    this.fieldExists = this.fieldExists.bind(this);\n    this.validateField = this.validateField.bind(this);\n    this.notify = this.notify.bind(this);\n    this.validating = this.validating.bind(this);\n    this.validated = this.validated.bind(this);\n    this.getDirty = this.getDirty.bind(this);\n    this.getPristine = this.getPristine.bind(this);\n    this.on = this.on.bind(this);\n    this.emit = this.emit.bind(this);\n    this.removeListener = this.removeListener.bind(this); // Updater will be used by fields to update and register\n\n    this.updater = {\n      register: this.register,\n      deregister: this.deregister,\n      getField: this.getField,\n      update: this.update,\n      fieldMap: this.fieldMap,\n      setValue: function setValue(fieldId, value) {\n        var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var field = _this.fieldsById.get(fieldId);\n\n        if (!field.shadow) {\n          ObjectMap.set(_this.state.values, field.field, field.fieldApi.getValue());\n        }\n\n        if (!field.fieldApi.relevant(_this.state.values)) {\n          ObjectMap[\"delete\"](_this.state.values, field.field);\n        } // Cleanup phase to get rid of irrelevant fields\n        // Also evaluate relevance on all fields\n\n\n        _this.fieldsById.forEach(function (f) {\n          // If a fields within an irrelivant step then remove it\n          // Otherwise, check to see if its relevant and only remove if keep state is false\n          var newRel = f.fieldApi.checkRelevant();\n\n          if (!f.fieldApi.multistepRelevant(_this.state.values) || !newRel && !f.keepState) {\n            ObjectMap[\"delete\"](_this.state.values, f.field);\n            ObjectMap[\"delete\"](_this.state.touched, f.field);\n            ObjectMap[\"delete\"](_this.state.errors, f.field);\n          }\n        });\n\n        if (emit) {\n          _this.emit('change');\n\n          _this.emit('field', field.field);\n\n          _this.emit('value', field.field, value);\n        }\n      },\n      setTouched: function setTouched(fieldId, touch) {\n        var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var field = _this.fieldsById.get(fieldId);\n\n        if (!field.shadow && field.fieldApi.getIsRelevant()) {\n          ObjectMap.set(_this.state.touched, field.field, field.fieldApi.getTouched());\n        } // Shadow values override unless undefined\n\n\n        if (field.shadow && field.fieldApi.getError() != undefined && field.fieldApi.relevant(_this.state.values)) {\n          ObjectMap.set(_this.state.touched, field.field, field.fieldApi.getTouched());\n        }\n\n        if (emit) {\n          _this.emit('change');\n\n          _this.emit('field', field.field); //this.emit('touch', field.field, touch);\n\n        }\n      },\n      setError: function setError(fieldId, error) {\n        var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n        var field = _this.fieldsById.get(fieldId);\n\n        if (!field.shadow && field.fieldApi.getIsRelevant()) {\n          ObjectMap.set(_this.state.errors, field.field, field.fieldApi.getError());\n        } // Shadow values override unless undefined\n\n\n        var currentError = ObjectMap.get(_this.state.errors, field.field);\n\n        if (field.shadow && field.fieldApi.getError() != undefined && field.fieldApi.relevant(_this.state.values)) {\n          ObjectMap.set(_this.state.errors, field.field, field.fieldApi.getError());\n        } // Special case for attempting to set shadow to undefiend\n        else if (field.shadow && field.fieldApi.getError() === undefined && field.fieldApi.relevant(_this.state.values) && // TODO maybe check if object or array\n          typeof currentError === 'string') {\n            ObjectMap.set(_this.state.errors, field.field, field.fieldApi.getError());\n          }\n\n        if (emit) {\n          _this.emit('change');\n\n          _this.emit('field', field.field); //this.emit('error', field.field, error);\n\n        }\n      },\n      expectRemoval: this.expectRemoval,\n      getInitialValue: this.getInitialValue,\n      getSavedValue: this.getSavedValue\n    }; // Define the formApi\n\n    this.formApi = {\n      setValue: this.setValue,\n      setTouched: this.setTouched,\n      setError: this.setError,\n      setFormError: this.setFormError,\n      setValues: this.setValues,\n      setInitialValue: this.setInitialValue,\n      getValue: this.getValue,\n      getTouched: this.getTouched,\n      getError: this.getError,\n      reset: this.reset,\n      submitForm: this.submitForm,\n      getState: this.getFormState,\n      getValues: this.getValues,\n      getFullField: this.getFullField,\n      fieldExists: this.fieldExists,\n      getInitialValue: this.getInitialValue,\n      validate: this.validate,\n      validateField: this.validateField,\n      screenValid: this.screenValid,\n      resetField: this.resetField,\n      getOptions: this.getOptions,\n      emitter: this,\n      getSavedValue: this.getSavedValue,\n      removeSavedState: this.removeSavedState,\n      getDerrivedValue: this.getDerrivedValue,\n      getStep: this.getStep,\n      setStep: this.setStep,\n      next: this.next,\n      back: this.back,\n      setCurrent: this.setCurrent,\n      validated: this.validated,\n      validating: this.validating,\n      getDirty: this.getDirty,\n      getPristine: this.getPristine,\n      getField: this.getField\n    };\n    this.on('value', function (field) {\n      // The forms values have changed so we want to clear form level error\n      delete _this.state.error;\n\n      _this.notify(field);\n    });\n  }\n  /* -------------------------------- Event Emitter ------------------------------ */\n\n\n  _createClass(FormController, [{\n    key: \"emit\",\n    value: function emit(event) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      // Grab the set based on the event\n      var listeners = this.subscriptions.get(event); // Only call if we have listeners on that event ( null check )\n\n      if (listeners) {\n        listeners.forEach(function (listener) {\n          return listener.apply(void 0, args);\n        });\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, listener) {\n      // Singleton check\n      if (!this.subscriptions.get(event)) {\n        this.subscriptions.set(event, new Set());\n      } // Add listener\n\n\n      var listeners = this.subscriptions.get(event);\n      listeners.add(listener);\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(event, listener) {\n      // Remove listener\n      var listeners = this.subscriptions.get(event);\n      listeners[\"delete\"](listener);\n    }\n    /* ---------------------------------- Setters ---------------------------------- */\n\n  }, {\n    key: \"setOptions\",\n    value: function setOptions(options) {\n      this.options = options;\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(name, value, options) {\n      this.getField(name).fieldApi.setValue(value, null, _objectSpread2({\n        allowEmptyString: this.options.allowEmptyStrings\n      }, options));\n    }\n  }, {\n    key: \"setTouched\",\n    value: function setTouched(name, value) {\n      this.getField(name).fieldApi.setTouched(value);\n    }\n  }, {\n    key: \"setError\",\n    value: function setError(name, value) {\n      this.getField(name).fieldApi.setError(value);\n    }\n  }, {\n    key: \"setFormError\",\n    value: function setFormError(value) {\n      this.state.error = value;\n      this.emit('change');\n    }\n  }, {\n    key: \"validating\",\n    value: function validating() {\n      this.state.validating = this.state.validating + 1;\n      this.emit('change');\n    }\n  }, {\n    key: \"validated\",\n    value: function validated(name, error) {\n      // Decrement the validating\n      this.state.validating = this.state.validating - 1; // Set the error if there is not already one ( sync error first )\n\n      if (!this.getError(name)) {\n        this.setError(name, error);\n      } // If we are not still validating, and we were submitting, then submit form\n      // If we are async validating then dont submit yet\n\n\n      if (this.state.validating > 0) {\n        this.emit('change');\n        return;\n      } // If we were submitting\n\n\n      if (this.state.submitting) {\n        // Check validity and perform submission if valid\n        if (this.valid()) {\n          debug$2('Submit', this.state);\n          this.emit('submit');\n        } else {\n          debug$2('Submit', this.state);\n          this.emit('failure');\n        }\n\n        this.state.submitting = false;\n      }\n\n      this.emit('change');\n    }\n  }, {\n    key: \"setStep\",\n    value: function setStep(value) {\n      this.state.step = value;\n      this.emit('change');\n    }\n  }, {\n    key: \"setCurrent\",\n    value: function setCurrent(component) {\n      this.state.Current = component;\n      this.emit('change');\n    }\n  }, {\n    key: \"back\",\n    value: function back(prevComponent) {\n      this.state.step = this.state.step - 1;\n      this.state.Current = prevComponent;\n      this.emit('change');\n    }\n  }, {\n    key: \"next\",\n    value: function next(nextComponent) {\n      // Validate the entire form\n      this.validate(); // If fields on the screen ( currently rendered ) are valid move on\n\n      if (this.screenValid()) {\n        this.state.step = this.state.step + 1;\n        this.state.Current = nextComponent;\n      } // State will have changed\n\n\n      this.emit('change');\n    }\n  }, {\n    key: \"setInitialValue\",\n    value: function setInitialValue(field, value) {\n      ObjectMap.set(this.options.initialValues, field, value);\n    }\n    /* ---------------------------------- Getters ---------------------------------- */\n\n    /**\n     * Generate the external form state that will be exposed to the users\n     *\n     * @returns Form State\n     */\n\n  }, {\n    key: \"getFormState\",\n    value: function getFormState() {\n      debug$2('Returning form state');\n      return _objectSpread2(_objectSpread2({}, this.state), {}, {\n        pristine: this.pristine(),\n        dirty: this.dirty(),\n        invalid: this.invalid()\n      });\n    }\n  }, {\n    key: \"getFormApi\",\n    value: function getFormApi() {\n      return this.formApi;\n    }\n  }, {\n    key: \"getDerrivedValue\",\n    value: function getDerrivedValue(name) {\n      var values = this.getValues();\n      return ObjectMap.get(values, name);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(name) {\n      var value = this.getField(name).fieldApi.getValue();\n      debug$2('Getting value for', name, value);\n      return value;\n    }\n  }, {\n    key: \"getTouched\",\n    value: function getTouched(field) {\n      var touched = this.getField(field).fieldApi.getTouched();\n      debug$2('Getting touched for', field, touched);\n      return touched;\n    }\n  }, {\n    key: \"getError\",\n    value: function getError(field) {\n      var error = this.getField(field).fieldApi.getError();\n      debug$2('Getting error for', field, error);\n      return error;\n    }\n  }, {\n    key: \"getDirty\",\n    value: function getDirty(field) {\n      var dirty = this.getField(field).fieldApi.getDirty();\n      debug$2('Getting dirty for', field, dirty);\n      return dirty;\n    }\n  }, {\n    key: \"getPristine\",\n    value: function getPristine(field) {\n      var pristine = this.getField(field).fieldApi.getPristine();\n      debug$2('Getting pristine for', field, pristine);\n      return pristine;\n    }\n  }, {\n    key: \"getValues\",\n    value: function getValues() {\n      debug$2('Gettings values');\n      return this.state.values;\n    }\n  }, {\n    key: \"getAllTouched\",\n    value: function getAllTouched() {\n      debug$2('Gettings touched');\n      return this.state.touched;\n    }\n  }, {\n    key: \"getErrors\",\n    value: function getErrors() {\n      debug$2('Gettings errors');\n      return this.state.errors;\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      return this.options;\n    }\n  }, {\n    key: \"getStep\",\n    value: function getStep() {\n      return this.state.step;\n    }\n  }, {\n    key: \"getSavedValue\",\n    value: function getSavedValue(name) {\n      var field = this.fieldsByName.get(name);\n\n      if (field && field.shadow) {\n        return ObjectMap.get(this.savedValues, \"shadow-\".concat(name));\n      }\n\n      return ObjectMap.get(this.savedValues, name);\n    }\n  }, {\n    key: \"removeSavedState\",\n    value: function removeSavedState(name) {\n      var field = this.fieldsByName.get(name);\n\n      if (field && field.shadow) {\n        return ObjectMap[\"delete\"](this.savedValues, \"shadow-\".concat(name));\n      }\n\n      return ObjectMap[\"delete\"](this.savedValues, name);\n    }\n  }, {\n    key: \"getFullField\",\n    value: function getFullField(field) {\n      return field;\n    }\n  }, {\n    key: \"getInitialValue\",\n    value: function getInitialValue(field) {\n      return ObjectMap.get(this.options.initialValues, field);\n    }\n  }, {\n    key: \"getField\",\n    value: function getField(name) {\n      debug$2('Getting Field', name);\n      var field = this.fieldsByName.get(name);\n\n      if (!field) {\n        // eslint-disable-next-line no-console\n        console.warn(\"Attempting to get field \".concat(name, \" but it does not exist\")); // Prevent app from crashing\n\n        return this.dummyField;\n      }\n\n      return field;\n    } // Notify other fields\n\n  }, {\n    key: \"notify\",\n    value: function notify(field) {\n      var _this2 = this;\n\n      // Example field - siblings[0].married\n      // Get the notifier\n      var notifier = this.getField(field); // If we have a list we must notify each one\n\n      if (notifier && notifier.notify) {\n        // Example: ['spouse']\n        notifier.notify.forEach(function (fieldName) {\n          // Get the field toNotify\n          var JSPAN = \".\".concat(field);\n          var path = \"\".concat(JSPAN.replace(/(.*)[.[].*/, '$1'), \".\").concat(fieldName).slice(1); // console.log('PATH', path);\n          // Example path - siblings[0].spouse\n\n          var toNotify = _this2.getField(path);\n\n          if (toNotify) {\n            debug$2('Notifying', toNotify.field);\n            toNotify.fieldApi.validate();\n            toNotify.fieldApi.checkRelevant();\n          }\n        });\n      }\n    }\n  }, {\n    key: \"validateField\",\n    value: function validateField(field) {\n      this.getField(field).fieldApi.validate();\n    }\n  }, {\n    key: \"resetField\",\n    value: function resetField(field) {\n      this.getField(field).fieldApi.reset();\n    }\n  }, {\n    key: \"fieldExists\",\n    value: function fieldExists(field) {\n      return this.fieldsByName.get(field) != null;\n    }\n  }, {\n    key: \"valid\",\n    value: function valid() {\n      var errors = this.getErrors();\n      return !!(ObjectMap.empty(errors) && !this.state.error);\n    }\n  }, {\n    key: \"screenValid\",\n    value: function screenValid() {\n      // Return false if any of the fields on the screen are invalid\n      var error = Object.entries(this.onScreen).some(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            field = _ref2[1];\n\n        return field.fieldApi.getError();\n      });\n      return !error;\n    }\n  }, {\n    key: \"invalid\",\n    value: function invalid() {\n      var errors = this.getErrors();\n      return !!(!ObjectMap.empty(errors) || this.state.error);\n    }\n  }, {\n    key: \"pristine\",\n    value: function pristine() {\n      // We are pristine if all our fields are pristine\n      // const touched = this.getAllTouched();\n      // const values = this.getValues();\n      // return ObjectMap.empty(touched) && ObjectMap.empty(values);\n      var pristine = true;\n      this.fieldsById.forEach(function (field) {\n        if (!field.fieldApi.getPristine()) {\n          pristine = false;\n        }\n      });\n      return pristine;\n    }\n  }, {\n    key: \"dirty\",\n    value: function dirty() {\n      return !this.pristine();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      debug$2('Resetting'); // So because all fields controll themselves and, \"inform\", this controller\n      // of their changes, we need to literally itterate through all registered fields\n      // and reset them. Not a big deal but very important to remember that you cant simply\n      // reset this controllers state!\n\n      this.fieldsById.forEach(function (field) {\n        field.fieldApi.reset({\n          preventUpdate: true\n        });\n      });\n      this.emit('reset');\n      this.emit('change');\n    }\n  }, {\n    key: \"setValues\",\n    value: function setValues(values) {\n      debug$2('Setting values'); // So we because all fields controll themselves and, \"inform\", this controller\n      // of their changes, we need to literally itterate through all registered fields\n      // and set them. Not a big deal but very important to remember that you cant simply\n      // set this controllers state!\n\n      this.fieldsById.forEach(function (field) {\n        // Initialize the values if it needs to be\n        var value = ObjectMap.get(values, field.field);\n\n        if (value !== undefined) {\n          field.fieldApi.setValue(value, null, {\n            preventUpdate: true\n          });\n        }\n      });\n      this.emit('change');\n    }\n  }, {\n    key: \"validate\",\n    value: function validate() {\n      var _this3 = this;\n\n      debug$2('Validating all fields');\n      var values = this.getValues(); // Validate schema if needed\n\n      if (this.options.validationSchema) {\n        var errors = validateYupSchema(this.options.validationSchema, values); // So we because all fields controll themselves and, \"inform\", this controller\n        // of their changes, we need to literally itterate through all registered fields\n        // and set them. Not a big deal but very important to remember that you cant simply\n        // set this controllers state!\n\n        this.fieldsById.forEach(function (field) {\n          // Check to see if there is an error to set\n          // Note: we use has becuause value may be there but undefined\n          if (ObjectMap.has(errors, field.field)) {\n            var error = ObjectMap.get(errors, field.field); // If there is an error then set it\n\n            _this3.setError(field.field, error);\n          } else {\n            // If we are doing schema validation then we need to clear out any old errors\n            _this3.setError(field.field, undefined);\n          }\n        });\n      } // Validate AJV schema if needed\n\n\n      if (this.options.schema && this.options.ajv) {\n        var _errors = validateAjvSchema(this.ajvValidate, values); // So we because all fields controll themselves and, \"inform\", this controller\n        // of their changes, we need to literally itterate through all registered fields\n        // and set them. Not a big deal but very important to remember that you cant simply\n        // set this controllers state!\n\n\n        this.fieldsById.forEach(function (field) {\n          // Check to see if there is an error to set\n          // Note: we use has becuause value may be there but undefined\n          if (ObjectMap.has(_errors, field.field)) {\n            var error = ObjectMap.get(_errors, field.field); // If there is an error then set it\n\n            _this3.setError(field.field, error);\n          } else {\n            // If we are doing schema validation then we need to clear out any old errors\n            _this3.setError(field.field, undefined);\n          }\n        });\n      } // Itterate through and call validate on every field\n\n\n      this.fieldsById.forEach(function (field) {\n        field.fieldApi.validate(values); // Second param to prevent validation\n\n        field.fieldApi.setTouched(true, true);\n      }); // Call the form level validation if its present\n\n      if (this.options.validate) {\n        var res = this.options.validate(values);\n        this.setFormError(res);\n      } // Call the forms field level validation\n\n\n      if (this.options.validateFields) {\n        var _errors2 = this.options.validateFields(values); // So we because all fields controll themselves and, \"inform\", this controller\n        // of their changes, we need to literally itterate through all registered fields\n        // and set them. Not a big deal but very important to remember that you cant simply\n        // set this controllers state!\n\n\n        this.fieldsById.forEach(function (field) {\n          // Check to see if there is an error to set\n          // Note: we use has becuause value may be there but undefined\n          if (ObjectMap.has(_errors2, field.field)) {\n            var error = ObjectMap.get(_errors2, field.field); // If there is an error then set it\n\n            _this3.setError(field.field, error);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"asyncValidate\",\n    value: function asyncValidate() {\n      debug$2('Async Validating all fields');\n      var values = this.getValues(); // Itterate through and call validate on every field\n\n      this.fieldsById.forEach(function (field) {\n        field.fieldApi.asyncValidate(values);\n      });\n    }\n  }, {\n    key: \"keyDown\",\n    value: function keyDown(e) {\n      // If preventEnter then return\n      if (e.keyCode == 13 && this.options.preventEnter) {\n        e.preventDefault(e);\n        return false;\n      }\n    }\n  }, {\n    key: \"submitForm\",\n    value: function submitForm(e) {\n      // Incriment number of submit attempts\n      this.state.submits = this.state.submits + 1;\n      this.state.submitting = true;\n\n      if (!this.options.dontPreventDefault && e) {\n        // Prevent default browser form submission\n        e.preventDefault(e);\n      } // Validate the form\n\n\n      this.validate(); // Emit a change\n\n      this.emit('change'); // Trigger all async validations\n\n      this.asyncValidate(); // If we are async validating then dont submit yet\n\n      if (this.state.validating > 0) {\n        return;\n      } // Check validity and perform submission if valid\n\n\n      if (this.valid()) {\n        debug$2('Submit', this.state);\n        this.emit('submit');\n      } else {\n        debug$2('Submit', this.state);\n        this.emit('failure');\n      }\n\n      this.state.submitting = false;\n      this.emit('change');\n    }\n  }, {\n    key: \"mount\",\n    value: function mount() {\n      var _this4 = this;\n\n      this.fieldsById.forEach(function (value) {\n        _this4.emit('field', value.field);\n      });\n    }\n    /* ---------------- Updater Functions (used by fields) ---------------- */\n    // ADDED initialRender parameter because of react 16.13.0 warning that does not like\n    // setting initial value during first render\n\n  }, {\n    key: \"register\",\n    value: function register(id, field, initialRender) {\n      var name = field.field,\n          state = field.state;\n      debug$2('Register ID:', id, 'Name:', name, state, 'Initial', initialRender); // Example foo.bar.baz[3].baz >>>> foo.bar.baz[3]\n\n      var magicValue = name.slice(0, name.lastIndexOf('[') != -1 ? name.lastIndexOf(']') + 1 : name.length); // Field might be coming back after render remove old field\n\n      var alreadyRegistered;\n      this.fieldsById.forEach(function (value, key) {\n        if (value && value.field === name) {\n          alreadyRegistered = key;\n        }\n      });\n\n      if ( //!this.expectedRemovals[magicValue] &&\n      alreadyRegistered && (field.keepState || field.inMultistep)) {\n        debug$2('Already Registered', name);\n        this.fieldsById[\"delete\"](alreadyRegistered);\n      } else if ( //!this.expectedRemovals[magicValue] &&\n      alreadyRegistered && (!field.keepState || !field.inMultistep)) {\n        // eslint-disable-next-line no-console\n        console.warn('Check to make sure you have not registered two fields with the fieldName', name);\n      }\n\n      debug$2('Fields Registered', this.fieldsById.size); // The field is on the screen\n\n      this.onScreen[id] = field; // Always register the field\n\n      this.fieldsById.set(id, field); // Always clear out expected removals when a reregistering array field comes in\n\n      debug$2('clearing expected removal', magicValue);\n      delete this.expectedRemovals[magicValue];\n      delete this.pulledOut[magicValue]; // The field is a shadow field ooo spooky so dont set anything\n\n      if (field.shadow) {\n        return;\n      } // Update the forms state right away\n\n\n      this.updater.setValue(id, field.fieldApi.getValue(), false);\n      this.updater.setError(id, field.fieldApi.getError(), false);\n      this.updater.setTouched(id, field.fieldApi.getTouched(), false); // We register field right away but dont want it to triger a rerender\n\n      if (!initialRender) {\n        this.emit('change');\n      }\n\n      this.emit('field', name);\n    }\n  }, {\n    key: \"deregister\",\n    value: function deregister(id) {\n      var field = this.fieldsById.get(id);\n      var name = field.field;\n      debug$2('Deregister', id, name); // The field is off the screen\n\n      delete this.onScreen[id]; // Example foo.bar.baz[3] --> foo.bar.baz[3].baz && foo.bar.baz[3].taz.raz[4].naz\n\n      var expectedRemoval = isExpected(name, this.expectedRemovals); // Example foo.bar.baz[3].baz >>>> foo.bar.baz[3]\n\n      var magicValue = name.slice(0, name.lastIndexOf('[') != -1 ? name.lastIndexOf(']') + 1 : name.length); // If the fields state is to be kept then save the value\n\n      if ( // We are in a multistep or want to keep the state\n      (field.keepState || field.inMultistep) && // We are NOT expected to be removed\n      !expectedRemoval) {\n        // TODO ?? Exception where the field is irrelivant AND keep state was not passed ??\n        debug$2(\"Saving field \".concat(name, \"'s value\"), field.fieldApi.getFieldState());\n\n        if (!field.shadow) {\n          ObjectMap.set(this.savedValues, name, field.fieldApi.getFieldState());\n        } else {\n          // We are shadow field and will store this value in the shadows\n          ObjectMap.set(this.savedValues, \"shadow-\".concat(name), field.fieldApi.getFieldState());\n        }\n      } // Remove if its an expected removal OR we dont have keep state\n\n\n      if ( // This field was expected to be removed\n      expectedRemoval || // This field does not have keepstate and is NOT within a multistep\n      !field.keepState && !field.inMultistep || // If field is in multistep then we would always keep due to field.inMultistep\n      // BUT.. we need to also check if the field is irrelivant\n      // because if it gets unmounted, even if its part of a multistep, we want to remove\n      // the field completley, unless keep state was passed.\n      !field.fieldApi.getIsRelevant() && !field.keepState) {\n        // Remove the field completley\n        debug$2('Removing field', name);\n        this.fieldsById[\"delete\"](id); // Clean up state only if its not expected removal, otherwise we will just pull it out\n\n        if (!expectedRemoval) {\n          ObjectMap[\"delete\"](this.state.values, name);\n          ObjectMap[\"delete\"](this.state.touched, name);\n          ObjectMap[\"delete\"](this.state.errors, name);\n\n          if (!field.shadow) {\n            ObjectMap[\"delete\"](this.savedValues, name);\n          } else {\n            ObjectMap[\"delete\"](this.savedValues, \"shadow-\".concat(name));\n          }\n        } // If we expected this removal then pullOut\n\n\n        if (expectedRemoval && this.pulledOut[magicValue]) {\n          debug$2('Pulling out', name, 'with magic value', magicValue);\n          ObjectMap.pullOut(this.state.values, magicValue);\n          ObjectMap.pullOut(this.state.touched, magicValue);\n          ObjectMap.pullOut(this.state.errors, magicValue);\n          ObjectMap.pullOut(this.savedValues, magicValue); // console.log('Pull1', this.state.values);\n          // console.log('Pull2', this.savedValues);\n\n          delete this.pulledOut[magicValue];\n        }\n      }\n\n      this.emit('change');\n    }\n  }, {\n    key: \"expectRemoval\",\n    value: function expectRemoval(name) {\n      debug$2('Expecting removal of', name);\n      this.expectedRemovals[name] = true;\n      this.pulledOut[name] = true;\n    }\n  }, {\n    key: \"update\",\n    value: function update(id, field, oldName) {\n      debug$2('Update', id, field.field, oldName, field.fieldState.value); // Update the error touched and values of this field\n\n      var value = field.fieldApi.getValue();\n      var error = field.fieldApi.getError();\n      var t = field.fieldApi.getTouched(); // Clear the old value out\n\n      var oldField = this.fieldsByName.get(oldName); // Only clear if we had an old name ( our name changed )\n      // %% the oldField is gone!\n\n      if (oldName && !oldField) {\n        // Setting nothing sets to undefined and does NOT pull out\n        ObjectMap.set(this.state.values, oldName);\n        ObjectMap.set(this.state.errors, oldName);\n        ObjectMap.set(this.state.touched, oldName);\n      } // Set the value\n\n\n      ObjectMap.set(this.state.values, field.field, value);\n      ObjectMap.set(this.state.errors, field.field, error);\n      ObjectMap.set(this.state.touched, field.field, t);\n      this.emit('change');\n    }\n  }]);\n\n  return FormController;\n}();\n\nvar logger$5 = debug('informed:FormProvider' + '\\t\\t');\n\nvar FormProvider = function FormProvider(_ref) {\n  var children = _ref.children,\n      formApi = _ref.formApi,\n      formController = _ref.formController,\n      formState = _ref.formState,\n      rest = _objectWithoutProperties(_ref, [\"children\", \"formApi\", \"formController\", \"formState\"]);\n\n  logger$5('Render FormProvider');\n\n  if (formApi) {\n    logger$5('Render FormProvider with given values');\n    /* --- Create Provider with given values and render Content --- */\n\n    return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n      value: formController.updater\n    }, /*#__PURE__*/React.createElement(FormApiContext.Provider, {\n      value: formApi\n    }, /*#__PURE__*/React.createElement(FormStateContext.Provider, {\n      value: formState\n    }, children)));\n  }\n\n  logger$5('Render FormProvider with generated values');\n  /* --- User did not pass values so create them --- */\n\n  var value = useForm(rest);\n  return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n    value: value.formController.updater\n  }, /*#__PURE__*/React.createElement(FormApiContext.Provider, {\n    value: value.formApi\n  }, /*#__PURE__*/React.createElement(FormStateContext.Provider, {\n    value: value.formState\n  }, children)));\n};\n\nvar logger$6 = debug('informed:useForm' + '\\t\\t');\n\nvar useForm = function useForm(_ref) {\n  var dontPreventDefault = _ref.dontPreventDefault,\n      initialValues = _ref.initialValues,\n      validate = _ref.validate,\n      validateFields = _ref.validateFields,\n      allowEmptyStrings = _ref.allowEmptyStrings,\n      preventEnter = _ref.preventEnter,\n      getApi = _ref.getApi,\n      apiRef = _ref.apiRef,\n      onChange = _ref.onChange,\n      onReset = _ref.onReset,\n      onSubmit = _ref.onSubmit,\n      onValueChange = _ref.onValueChange,\n      onSubmitFailure = _ref.onSubmitFailure,\n      validationSchema = _ref.validationSchema,\n      schema = _ref.schema,\n      ajv = _ref.ajv,\n      fieldMap = _ref.fieldMap,\n      onlyValidateSchema = _ref.onlyValidateSchema,\n      userProps = _objectWithoutProperties(_ref, [\"dontPreventDefault\", \"initialValues\", \"validate\", \"validateFields\", \"allowEmptyStrings\", \"preventEnter\", \"getApi\", \"apiRef\", \"onChange\", \"onReset\", \"onSubmit\", \"onValueChange\", \"onSubmitFailure\", \"validationSchema\", \"schema\", \"ajv\", \"fieldMap\", \"onlyValidateSchema\"]);\n\n  logger$6('Render useForm'); // Generate form controller options\n\n  var formControllerOptions = useMemo(function () {\n    return {\n      dontPreventDefault: dontPreventDefault,\n      initialValues: initialValues,\n      validate: validate,\n      validateFields: validateFields,\n      allowEmptyStrings: allowEmptyStrings,\n      preventEnter: preventEnter,\n      validationSchema: validationSchema,\n      schema: schema,\n      ajv: ajv,\n      fieldMap: fieldMap\n    };\n  }, [dontPreventDefault, initialValues, validate, validateFields, allowEmptyStrings, preventEnter, validationSchema, schema, ajv, fieldMap]); // Create form controller\n\n  var _useState = useState(function () {\n    return new FormController(formControllerOptions);\n  }),\n      _useState2 = _slicedToArray(_useState, 1),\n      formController = _useState2[0]; // Update the options when they change\n\n\n  useEffect(function () {\n    formController.setOptions(formControllerOptions);\n  }, [formControllerOptions]);\n  useIsomorphicLayoutEffect(function () {\n    formController.mount();\n  }, []); // Form state will be used to trigger rerenders\n\n  var _useState3 = useState(function () {\n    return formController.getFormState();\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      formState = _useState4[0],\n      setFormState = _useState4[1]; // Register for events\n\n\n  useIsomorphicLayoutEffect(function () {\n    var onChangeHandler = function onChangeHandler() {\n      return onChange && onChange(formController.getFormState());\n    };\n\n    var onResetHandler = function onResetHandler() {\n      return onReset && onReset();\n    };\n\n    var onSubmitHandler = function onSubmitHandler() {\n      return onSubmit && onSubmit(formController.getFormState().values);\n    };\n\n    var onValueHandler = function onValueHandler() {\n      return onValueChange && onValueChange(formController.getFormState().values);\n    };\n\n    var onFailureHandler = function onFailureHandler() {\n      return onSubmitFailure && onSubmitFailure(formController.getFormState().errors);\n    }; // Register for events\n\n\n    formController.on('change', onChangeHandler);\n    formController.on('reset', onResetHandler);\n    formController.on('submit', onSubmitHandler);\n    formController.on('value', onValueHandler);\n    formController.on('failure', onFailureHandler); // Unregister events\n\n    return function () {\n      formController.removeListener('change', onChangeHandler);\n      formController.removeListener('reset', onResetHandler);\n      formController.removeListener('submit', onSubmitHandler);\n      formController.removeListener('value', onValueHandler);\n      formController.removeListener('failure', onFailureHandler);\n    };\n  }, [onChange, onReset, onSubmit, onValueChange, onSubmitFailure]); // Initialize code like constructor but not muhahah\n\n  useState(function () {\n    // Update the form state to trigger rerender!\n    var onChangeHandlerRerender = function onChangeHandlerRerender() {\n      logger$6('Setting form state');\n      setFormState(formController.getFormState());\n    }; // const debounced = debounce(onChangeHandlerRerender, 250);\n\n\n    formController.on('change', onChangeHandlerRerender); // Give access to api outside\n\n    if (getApi) {\n      getApi(formController.getFormApi());\n    }\n\n    if (apiRef) {\n      apiRef.current = formController.getFormApi();\n    }\n  }); // We dont want this to happen on every render so thats why useState is used here\n\n  var _useState5 = useState(function () {\n    return formController.getFormApi();\n  }),\n      _useState6 = _slicedToArray(_useState5, 1),\n      formApi = _useState6[0]; // TODO technically speaking this can be unsafe as there is circular dependency\n  // between form provider and useForm.. Its ok because anyone that in theory\n  // Uses a form provider and a use form hook themselves will never call the render\n  // function created here... that being said I will look into fixing that warning\n  // at some point :)\n\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(FormProvider, {\n      formApi: formApi,\n      formState: formState,\n      formController: formController\n    }, /*#__PURE__*/React.createElement(React.Fragment, null, !children ? /*#__PURE__*/React.createElement(FormFields, {\n      schema: schema,\n      onlyValidateSchema: onlyValidateSchema\n    }) : children));\n  };\n\n  return {\n    formApi: formApi,\n    formState: formState,\n    formController: formController,\n    render: render,\n    userProps: userProps\n  };\n};\n\nvar debug$3 = debug('informed:Form' + '\\t\\t');\n\nvar Form = function Form(_ref) {\n  var children = _ref.children,\n      renderProp = _ref.render,\n      component = _ref.component,\n      rest = _objectWithoutProperties(_ref, [\"children\", \"render\", \"component\"]);\n\n  debug$3('Render FORM');\n\n  var _useForm = useForm(rest),\n      formApi = _useForm.formApi,\n      formController = _useForm.formController,\n      formState = _useForm.formState,\n      render = _useForm.render,\n      userProps = _useForm.userProps;\n\n  var getContent = function getContent() {\n    var props = {\n      formState: formState,\n      formApi: formApi\n    };\n\n    if (component) {\n      return /*#__PURE__*/React.createElement(component, props, children);\n    }\n\n    if (renderProp) {\n      return renderProp(props);\n    }\n\n    if (typeof children === 'function') {\n      return children(props);\n    }\n\n    return children;\n  };\n  /* --- Render Content --- */\n\n\n  return render( /*#__PURE__*/React.createElement(\"form\", _extends({}, userProps, {\n    onReset: formController.reset,\n    onSubmit: formController.submitForm,\n    onKeyDown: formController.keyDown\n  }), getContent()));\n};\n\nvar buildScopedFormApi$1 = function buildScopedFormApi(scope, formApi) {\n  return _objectSpread2(_objectSpread2({}, formApi), {}, {\n    getValue: function getValue(field) {\n      return formApi.getValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getTouched: function getTouched(field) {\n      return formApi.getTouched(\"\".concat(scope, \".\").concat(field));\n    },\n    getError: function getError(field) {\n      return formApi.getError(\"\".concat(scope, \".\").concat(field));\n    },\n    setValue: function setValue(field, value) {\n      return formApi.setValue(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setTouched: function setTouched(field, value) {\n      return formApi.setTouched(\"\".concat(scope, \".\").concat(field), value);\n    },\n    setError: function setError(field, value) {\n      return formApi.setError(\"\".concat(scope, \".\").concat(field), value);\n    },\n    getInitialValue: function getInitialValue(field) {\n      return formApi.getInitialValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getFullField: function getFullField(field) {\n      return \"\".concat(formApi.getFullField(scope), \".\").concat(field);\n    }\n  });\n};\n\nvar buildScopedRegister = function buildScopedRegister(scope, formRegister) {\n  var _register = formRegister.register,\n      _deregister = formRegister.deregister,\n      _setValue = formRegister.setValue,\n      _setTouched = formRegister.setTouched,\n      _setError = formRegister.setError,\n      _update = formRegister.update,\n      _getField = formRegister.getField,\n      _expectRemoval = formRegister.expectRemoval,\n      _getInitialValue = formRegister.getInitialValue,\n      fieldMap = formRegister.fieldMap,\n      _getSavedValue = formRegister.getSavedValue;\n  return {\n    register: function register(field) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return _register.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    deregister: function deregister(field) {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      return _deregister.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    update: function update(field) {\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n\n      return _update.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    setValue: function setValue(field) {\n      for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        args[_key4 - 1] = arguments[_key4];\n      }\n\n      return _setValue.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    setTouched: function setTouched(field) {\n      for (var _len5 = arguments.length, args = new Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n        args[_key5 - 1] = arguments[_key5];\n      }\n\n      return _setTouched.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    setError: function setError(field) {\n      for (var _len6 = arguments.length, args = new Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n        args[_key6 - 1] = arguments[_key6];\n      }\n\n      return _setError.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    getField: function getField(field) {\n      for (var _len7 = arguments.length, args = new Array(_len7 > 1 ? _len7 - 1 : 0), _key7 = 1; _key7 < _len7; _key7++) {\n        args[_key7 - 1] = arguments[_key7];\n      }\n\n      return _getField.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    expectRemoval: function expectRemoval(field) {\n      for (var _len8 = arguments.length, args = new Array(_len8 > 1 ? _len8 - 1 : 0), _key8 = 1; _key8 < _len8; _key8++) {\n        args[_key8 - 1] = arguments[_key8];\n      }\n\n      return _expectRemoval.apply(void 0, [\"\".concat(scope, \".\").concat(field)].concat(args));\n    },\n    getInitialValue: function getInitialValue(field) {\n      return _getInitialValue(\"\".concat(scope, \".\").concat(field));\n    },\n    getSavedValue: function getSavedValue(field) {\n      return _getSavedValue(\"\".concat(scope, \".\").concat(field));\n    },\n    fieldMap: fieldMap\n  };\n};\n\nvar Scope = function Scope(_ref) {\n  var scope = _ref.scope,\n      children = _ref.children;\n  var formRegister = useContext(FormRegisterContext);\n  var formApi = useFormApi();\n  var formState = useFormState(); // VERY important to memoize the builders!\n\n  var scopedFormApi = useMemo(function () {\n    return buildScopedFormApi$1(scope, formApi);\n  }, [scope]);\n  var scopedRegister = useMemo(function () {\n    return buildScopedRegister(scope, formRegister);\n  }, [scope]);\n  return /*#__PURE__*/React.createElement(FormRegisterContext.Provider, {\n    value: scopedRegister\n  }, /*#__PURE__*/React.createElement(FormApiContext.Provider, {\n    value: scopedFormApi\n  }, /*#__PURE__*/React.createElement(FormStateContext.Provider, {\n    value: formState\n  }, children)));\n};\n\nvar FormState = function FormState(props) {\n  var formState = useFormState();\n  var displayState = {};\n\n  if (Object.keys(props).length > 0) {\n    Object.keys(props).forEach(function (key) {\n      displayState[key] = formState[key];\n    });\n  } else {\n    displayState = formState;\n  }\n\n  var _displayState = displayState,\n      pristine = _displayState.pristine,\n      dirty = _displayState.dirty,\n      invalid = _displayState.invalid,\n      values = _displayState.values,\n      errors = _displayState.errors,\n      touched = _displayState.touched,\n      validating = _displayState.validating,\n      submitting = _displayState.submitting;\n  return /*#__PURE__*/React.createElement(\"pre\", null, /*#__PURE__*/React.createElement(\"code\", null, JSON.stringify({\n    pristine: pristine,\n    dirty: dirty,\n    invalid: invalid,\n    values: values,\n    errors: errors,\n    touched: touched,\n    validating: validating,\n    submitting: submitting\n  }, null, 2)));\n};\n\nvar useMultistep = function useMultistep(_ref) {\n  var initialStep = _ref.initialStep,\n      multistepApiRef = _ref.multistepApiRef;\n\n  // Get the formApi\n  var _useFormApi = useFormApi(),\n      getValues = _useFormApi.getValues,\n      validate = _useFormApi.validate,\n      screenValid = _useFormApi.screenValid; // Track our steps by name\n\n\n  var _useState = useState(new Map()),\n      _useState2 = _slicedToArray(_useState, 1),\n      stepsByName = _useState2[0]; // Track number of steps\n\n\n  var nSteps = useRef(0); // Define our state\n\n  var _useStateWithGetter = useStateWithGetter({\n    current: initialStep,\n    steps: [],\n    goal: null\n  }),\n      _useStateWithGetter2 = _slicedToArray(_useStateWithGetter, 3),\n      multistepState = _useStateWithGetter2[0],\n      setMultistepState = _useStateWithGetter2[1],\n      getMultistepState = _useStateWithGetter2[2]; // Define our api\n\n\n  var _useState3 = useState(function () {\n    var getCurrentStep = function getCurrentStep() {\n      // Get the current state\n      var _getMultistepState = getMultistepState(),\n          current = _getMultistepState.current; // Get the current step\n\n\n      var currentStep = stepsByName.get(current); // Return it\n\n      return currentStep;\n    };\n\n    var api = {\n      // Gets the whole state\n      getState: function getState() {\n        return getMultistepState();\n      },\n      // Gets just the current\n      getCurrentStep: getCurrentStep,\n      // Gets that step\n      getStep: function getStep(name) {\n        return stepsByName.get(name);\n      },\n      // gets the current number of steps\n      getNumberOfSteps: function getNumberOfSteps() {\n        return stepsByName.size;\n      },\n      // Goes to next step\n      next: function next() {\n        // Validate the entire form\n        validate(); // If fields on the screen ( currently rendered ) are valid move on\n\n        if (screenValid()) {\n          // Get the current step\n          var _getCurrentStep = getCurrentStep(),\n              getNext = _getCurrentStep.getNext;\n\n          var next = getNext(); // Determine what the next step should be\n\n          var nextStep = typeof next === 'function' ? next(getValues()) : next; // Determine if it has a next\n\n          if (nextStep) {\n            setMultistepState(function (prev) {\n              return _objectSpread2(_objectSpread2({}, prev), {}, {\n                current: nextStep\n              });\n            });\n          }\n        }\n      },\n      // Goes to previous step\n      back: function back() {\n        // Get the current step\n        var _getCurrentStep2 = getCurrentStep(),\n            getPrevious = _getCurrentStep2.getPrevious;\n\n        var previous = getPrevious(); // Determine what the previous step should be\n\n        var previousStep = typeof previous === 'function' ? previous(getValues()) : previous; // Determine if it has a previous\n\n        if (previousStep) {\n          setMultistepState(function (prev) {\n            return _objectSpread2(_objectSpread2({}, prev), {}, {\n              current: previousStep\n            });\n          });\n        }\n      },\n      // Goes to specified step\n      setCurrent: function setCurrent(stp) {\n        if (stp) {\n          var goalIndex = stepsByName.get(stp).index; // console.log(\n          //   'GOAL INDEX',\n          //   goalIndex,\n          //   'STPINDEX',\n          //   getCurrentStep().index\n          // );\n\n          if (goalIndex < getCurrentStep().index) {\n            setMultistepState(function (prev) {\n              return _objectSpread2(_objectSpread2({}, prev), {}, {\n                current: stp,\n                goal: null\n              });\n            });\n          } else {\n            setMultistepState(function (prev) {\n              return _objectSpread2(_objectSpread2({}, prev), {}, {\n                // current: stp,\n                goal: stp\n              });\n            });\n          }\n        }\n      },\n      // Registers the step\n      register: function register(name, step, initial) {\n        if (initial) {\n          nSteps.current = nSteps.current + 1;\n          stepsByName.set(name, _objectSpread2(_objectSpread2({}, step), {}, {\n            index: nSteps.current\n          }));\n        } else {\n          setMultistepState(function (prev) {\n            return _objectSpread2(_objectSpread2({}, prev), {}, {\n              steps: Array.from(stepsByName.keys())\n            });\n          });\n        }\n      },\n      // Deregisters the step\n      deregister: function deregister(name) {\n        stepsByName[\"delete\"](name);\n        nSteps.current = nSteps.current - 1;\n        setMultistepState(function (prev) {\n          return _objectSpread2(_objectSpread2({}, prev), {}, {\n            steps: Array.from(stepsByName.keys())\n          });\n        });\n      }\n    };\n\n    if (multistepApiRef) {\n      multistepApiRef.current = api;\n    }\n\n    return api;\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      multistepApi = _useState4[0]; // Render funtion that will provide state and api\n\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(MultistepApiContext.Provider, {\n      value: multistepApi\n    }, /*#__PURE__*/React.createElement(MultistepStateContext.Provider, {\n      value: multistepState\n    }, children));\n  };\n\n  return _objectSpread2(_objectSpread2(_objectSpread2({}, multistepApi), multistepState), {}, {\n    render: render\n  });\n};\n\nfunction useMultistepState() {\n  return useContext(MultistepStateContext);\n}\n\nfunction useMultistepApi() {\n  return useContext(MultistepApiContext);\n}\n\nvar useMultistepStep = function useMultistepStep(_ref) {\n  var step = _ref.step,\n      next = _ref.next,\n      previous = _ref.previous,\n      relevant = _ref.relevant;\n\n  var _useFormState = useFormState(),\n      values = _useFormState.values;\n\n  var _useMultistepState = useMultistepState(),\n      current = _useMultistepState.current,\n      goal = _useMultistepState.goal;\n\n  var _useMultistepApi = useMultistepApi(),\n      register = _useMultistepApi.register,\n      deregister = _useMultistepApi.deregister,\n      goToNext = _useMultistepApi.next;\n\n  var isCurrent = step === current;\n  var isRelevant = relevant ? relevant(values) : true;\n  var nextRef = useRef(next);\n  var prevRef = useRef(previous);\n  var relevantRef = useRef();\n  nextRef.current = next;\n  prevRef.current = previous;\n  relevantRef.current = relevant;\n  useState(function () {\n    register(step, {\n      name: step,\n      getNext: function getNext() {\n        return nextRef.current;\n      },\n      getPrevious: function getPrevious() {\n        return prevRef.current;\n      }\n    }, true);\n  });\n  useEffect(function () {\n    register(step, {\n      name: step,\n      getNext: function getNext() {\n        return nextRef.current;\n      },\n      getPrevious: function getPrevious() {\n        return prevRef.current;\n      }\n    });\n    return function () {\n      deregister(step);\n    };\n  }, [step]);\n  useEffect(function () {\n    // if we are NOT at the goal go to the next step\n    if (goal && isCurrent && goal !== step) {\n      // console.log('GOAL', goal, 'STEP', step, 'INDEX', getStep(step).index);\n      // console.log('GOING TO NEXT STEP');\n      goToNext();\n    }\n  }, [goal, isCurrent]);\n\n  var render = function render(children) {\n    return /*#__PURE__*/React.createElement(MultistepStepContext.Provider, {\n      value: {\n        relevant: function relevant(params) {\n          return relevantRef.current ? relevantRef.current(params) : true;\n        },\n        multistep: true\n      }\n    }, isCurrent && isRelevant ? children : null);\n  };\n\n  return {\n    isCurrent: isCurrent,\n    isRelevant: isRelevant,\n    step: step,\n    render: render\n  };\n};\n\nfunction Multistep(_ref) {\n  var children = _ref.children,\n      props = _objectWithoutProperties(_ref, [\"children\"]);\n\n  var _useMultistep = useMultistep(props),\n      render = _useMultistep.render,\n      context = _objectWithoutProperties(_useMultistep, [\"render\"]);\n\n  if (typeof children === 'function') {\n    return render(children(context));\n  }\n\n  return render(children);\n}\n\nMultistep.Step = function MultistepStep(_ref2) {\n  var children = _ref2.children,\n      props = _objectWithoutProperties(_ref2, [\"children\"]);\n\n  var _useMultistepStep = useMultistepStep(props),\n      render = _useMultistepStep.render;\n\n  return render(children);\n};\n\nvar FormField = function FormField(_ref) {\n  var field = _ref.field;\n\n  // Get the field map off the forms context\n  var _useContext = useContext(FormRegisterContext),\n      fieldMap = _useContext.fieldMap; // Grab the form api ( we need it to get the actual field name because might be in scope )\n\n\n  var _useFormApi = useFormApi(),\n      getFullField = _useFormApi.getFullField,\n      getOptions = _useFormApi.getOptions; // Grab the full field\n\n\n  var fullField = getFullField(field); // Grap the schema\n\n  var _getOptions = getOptions(),\n      schema = _getOptions.schema; // First find property from the schema via the path to that field\n  // Examples\n  // field = \"name\" ---> properties.name\n  // field = \"brother.name\" ---> properties.brother.properties.name\n  // field = \"brother.siblings[1].friend.name\" ---> properties.brother.properties.siblings.items[1].properties.friend.properties.name\n\n\n  var path = getSchemaPathFromJsonPath(fullField);\n  var property = ObjectMap.get(schema, path); // If property was not found return null\n\n  if (!property) {\n    return null;\n  } // Next compute the field from property\n\n\n  var schemaField = computeFieldFromProperty(field, property);\n  var props = schemaField.props,\n      componentType = schemaField.componentType;\n  var Component = fieldMap[componentType];\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    field: field\n  }, props));\n};\n\nvar SchemaFields = function SchemaFields() {\n  var _useFormApi = useFormApi(),\n      getOptions = _useFormApi.getOptions; // Grap the schema\n\n\n  var _getOptions = getOptions(),\n      schema = _getOptions.schema;\n\n  return /*#__PURE__*/React.createElement(FormFields, {\n    schema: schema\n  });\n};\n\nvar withFormApi = function withFormApi(Component) {\n  return /*#__PURE__*/React.forwardRef(function (props, ref) {\n    return /*#__PURE__*/React.createElement(FormApiContext.Consumer, null, function (formApi) {\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        formApi: formApi,\n        ref: ref\n      }, props));\n    });\n  });\n};\n\nvar withFormState = function withFormState(Component) {\n  return /*#__PURE__*/React.forwardRef(function (props, ref) {\n    return /*#__PURE__*/React.createElement(FormStateContext.Consumer, null, function (formState) {\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        formState: formState,\n        ref: ref\n      }, props));\n    });\n  });\n};\n\n// eslint-disable-next-line no-unused-vars\n\nvar buildFieldApi = function buildFieldApi(formApi, field) {\n  return {\n    // TODO refactor to use field api from updater.. need to make sure this\n    // will be stable\n    getValue: function getValue() {\n      return formApi.getValue(field);\n    },\n    setValue: function setValue(value) {\n      return formApi.setValue(field, value);\n    },\n    getTouched: function getTouched() {\n      return formApi.getTouched(field);\n    },\n    setTouched: function setTouched(value) {\n      return formApi.setTouched(field, value);\n    },\n    getError: function getError() {\n      return formApi.getError(field);\n    },\n    setError: function setError(value) {\n      return formApi.setError(field, value);\n    },\n    reset: function reset() {\n      return formApi.resetField(field);\n    },\n    validate: function validate() {\n      return formApi.validateField(field);\n    },\n    exists: function exists() {\n      return formApi.fieldExists(field);\n    },\n    getDirty: function getDirty() {\n      return formApi.getDirty(field);\n    },\n    getPristine: function getPristine() {\n      return formApi.getPristine(field);\n    },\n    getFieldState: function getFieldState() {\n      return formApi.getField(field).fieldApi.getFieldState();\n    }\n  };\n};\n\nfunction useFieldApi(field) {\n  var formApi = useFormApi();\n  var fieldApi = useMemo(function () {\n    return buildFieldApi(formApi, field);\n  }, [field]);\n  return fieldApi;\n}\n\nfunction useFieldState(name) {\n  var fieldApi = useFieldApi(name);\n  var formApi = useFormApi();\n\n  var _React$useState = React.useState(),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      updateState = _React$useState2[1];\n\n  var forceUpdate = React.useCallback(function () {\n    return updateState({});\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    var listener = function listener(target) {\n      if (target === name) {\n        forceUpdate();\n      }\n    };\n\n    formApi.emitter.on('field', listener);\n    return function () {\n      formApi.emitter.removeListener('field', listener);\n    };\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    forceUpdate();\n  }, []); // useEffect(() => {\n  //   forceUpdate();\n  // }, []);\n\n  return fieldApi.getFieldState() || {};\n}\n\nvar withFieldState = function withFieldState(field) {\n  return function (Component) {\n    return function (props) {\n      var fieldState = useFieldState(field);\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        fieldState: fieldState\n      }, props));\n    };\n  };\n};\n\nvar withFieldApi = function withFieldApi(field) {\n  return function (Component) {\n    return function (props) {\n      var fieldApi = useFieldApi(field);\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        fieldApi: fieldApi\n      }, props));\n    };\n  };\n};\n\nvar Option = function Option(_ref) {\n  var value = _ref.value,\n      forwardedRef = _ref.forwardedRef,\n      children = _ref.children,\n      rest = _objectWithoutProperties(_ref, [\"value\", \"forwardedRef\", \"children\"]);\n\n  return /*#__PURE__*/React.createElement(\"option\", _extends({\n    ref: forwardedRef,\n    value: value,\n    key: value\n  }, rest), children);\n};\n\nvar Input = Text$1;\n\nexport { ArrayField, Checkbox as BasicCheckbox, Radio as BasicRadio, RadioGroup as BasicRadioGroup, Select as BasicSelect, Text as BasicText, TextArea as BasicTextArea, Checkbox$1 as Checkbox, Form, FormComponents, FormField, FormFields, FormProvider, FormState, Input, Multistep, Option, Radio$1 as Radio, RadioGroup$1 as RadioGroup, Relevant, SchemaFields, Scope, Select$1 as Select, Text$1 as Text, TextArea$1 as TextArea, asField, useArrayField, useArrayFieldApi, useArrayFieldItemApi, useCursorPosition, useField, useFieldApi, useFieldState, useForm, useFormApi, useFormState, useMultistepApi, useMultistepState, utils, withFieldApi, withFieldState, withFormApi, withFormState, withRadioGroup };\n"]},"metadata":{},"sourceType":"module"}